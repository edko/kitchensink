/* Ogma - Graph visualization library - Version: 1.6.6 (built on Tue Apr 04 2017 15:22:41 GMT+0200 (CEST)) - Author: Linkurious SAS - License: Commercial */

/* eslint-disable */

"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(){function $isObj(a){return"object"===("undefined"==typeof a?"undefined":_typeof(a))&&null!==a}function $rm(a,b){var c=a.indexOf(b);return c!==-1&&(a.splice(c,1),!0)}function $has(a,b){return a.indexOf(b)!==-1}function $time(){return $global.Ogma.utils.getTime()}function $log(a){console.log($time()+" "+a)}function $info(a){console.info($time()+" "+a)}function $warn(a){console.warn($time()+" "+a)}function $error(a){console.error($time()+" "+a)}function $or(a,b){return void 0===a?b:a}function $iter(a,b){for(var c=Object.keys(a),d=0,e=c.length;d<e;++d){var f=c[d];b(a[f],f)}}function $dual(a){return{nodes:a?new a:Object.create(null),edges:a?new a:Object.create(null),fetch:function(a){return a?this.nodes:this.edges}}}function $opt(a,b,c){return $or(a,c)}function $isDef(a){return void 0!==a}function $source(a){for(var b=a.__source;b.parent;)b=b.parent;return b}function $target(a){for(var b=a.__target;b.parent;)b=b.parent;return b}function $C(a,b){var c=$global.Ogma.constants[a];if(!c)throw new Error('constant type "'+a+'" does not exist');var d=c[b];if(void 0===d)throw new Error('constant "'+a+"."+b+'" does not exist');return d}function $kill(a){$global.Ogma.utils.kill(a)}var $global={};return function(){Math.log2||(Math.log2=function(a){return Math.log(a)/Math.log(2)})}(),function(){function a(a){for(var b=this.length,c=0;c<b;++c)this[c]=a}function b(a,b){if(null===this)throw new TypeError("this is null or not defined");var c=Object(this),d=c.length>>>0,e=a>>0,f=e<0?Math.max(d+e,0):Math.min(e,d),g=b>>0,h=g<0?Math.max(d+g,0):Math.min(g,d),i=arguments[2],j=void 0===i?d:i>>0,k=j<0?Math.max(d+j,0):Math.min(j,d),l=Math.min(k-h,d-f),m=1;for(h<f&&f<h+l&&(m=-1,h+=l-1,f+=l-1);l>0;)h in c?c[f]=c[h]:delete c[f],h+=m,f+=m,l--;return c}function c(a){var b,c,d=Object(this),e=d.length>>>0;if(0===e)return-1;for(b=e-1,arguments.length>1&&(b=Number(arguments[1]),b!==b?b=0:0!==b&&b!==1/0&&b!==-(1/0)&&(b=(b>0||-1)*Math.floor(Math.abs(b)))),c=b>=0?Math.min(b,e-1):e-Math.abs(b);c>=0;c--)if(c in d&&d[c]===a)return c;return-1}for(var d=[Int32Array,Int16Array,Int8Array,Uint32Array,Float32Array,Float64Array,Array],e=["join","slice","reverse","forEach","map","reduce","indexOf","sort","filter","every"],f=0,g=d.length;f<g;++f){var h=d[f].prototype;if(h.fill||(h.fill=a),h.copyWithin||(h.copyWithin=b),h.lastIndexOf||(h.lastIndexOf=c),f<g-1)for(var i=0,j=e.length;i<j;i++){var k=e[i];h[k]||(h[k]=Array.prototype[k])}}}(),function(){String.prototype.endsWith||(String.prototype.endsWith=function(a,b){var c=this.toString();("number"!=typeof b||!isFinite(b)||Math.floor(b)!==b||b>c.length)&&(b=c.length),b-=a.length;var d=c.lastIndexOf(a,b);return d!==-1&&d===b})}(),function(){function a(a){return"number"==typeof a&&isNaN(a)}Number.isNaN||(Number.isNaN=a)}(),function(a){function b(){}function c(a,b){return function(){a.apply(b,arguments)}}function d(a){if("object"!==_typeof(this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],j(a,this)}function e(a,b){for(;3===a._state;)a=a._value;return 0===a._state?void a._deferreds.push(b):(a._handled=!0,void d._immediateFn(function(){var c=1===a._state?b.onFulfilled:b.onRejected;if(null===c)return void(1===a._state?f:g)(b.promise,a._value);var d;try{d=c(a._value)}catch(a){return void g(b.promise,a)}f(b.promise,d)}))}function f(a,b){try{if(b===a)throw new TypeError("A promise cannot be resolved with itself.");if(b&&("object"===("undefined"==typeof b?"undefined":_typeof(b))||"function"==typeof b)){var e=b.then;if(b instanceof d)return a._state=3,a._value=b,void h(a);if("function"==typeof e)return void j(c(e,b),a)}a._state=1,a._value=b,h(a)}catch(b){g(a,b)}}function g(a,b){a._state=2,a._value=b,h(a)}function h(a){2===a._state&&0===a._deferreds.length&&d._immediateFn(function(){a._handled||d._unhandledRejectionFn(a._value)});for(var b=0,c=a._deferreds.length;b<c;b++)e(a,a._deferreds[b]);a._deferreds=null}function i(a,b,c){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.promise=c}function j(a,b){var c=!1;try{a(function(a){c||(c=!0,f(b,a))},function(a){c||(c=!0,g(b,a))})}catch(a){if(c)return;c=!0,g(b,a)}}var k=setTimeout;d.prototype.catch=function(a){return this.then(null,a)},d.prototype.then=function(a,c){var d=new this.constructor(b);return e(this,new i(a,c,d)),d},d.all=function(a){var b=Array.prototype.slice.call(a);return new d(function(a,c){function d(f,g){try{if(g&&("object"===("undefined"==typeof g?"undefined":_typeof(g))||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}b[f]=g,0===--e&&a(b)}catch(a){c(a)}}if(0===b.length)return a([]);for(var e=b.length,f=0;f<b.length;f++)d(f,b[f])})},d.resolve=function(a){return a&&"object"===("undefined"==typeof a?"undefined":_typeof(a))&&a.constructor===d?a:new d(function(b){b(a)})},d.reject=function(a){return new d(function(b,c){c(a)})},d.race=function(a){return new d(function(b,c){for(var d=0,e=a.length;d<e;d++)a[d].then(b,c)})},d._immediateFn="function"==typeof setImmediate&&function(a){setImmediate(a)}||function(a){k(a,0)},d._unhandledRejectionFn=function(a){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",a)},d._setImmediateFn=function(a){d._immediateFn=a},d._setUnhandledRejectionFn=function(a){d._unhandledRejectionFn=a},"object"!==("undefined"==typeof global?"undefined":_typeof(global))||global.Promise||(global.exports=d),"object"!==("undefined"==typeof window?"undefined":_typeof(window))||window.Promise||(window.Promise=d)}(this),function(){function a(a){for(var c=0;c<a.length;++c){var d=a[c],e=Ogma.modules[d];if(!e)throw new Error("module "+d+" does not exist");for(var f=e.dependencies||[],g=0;g<f.length;++g)b(a,f[g])}return a}function b(a,b){a.indexOf(b)===-1&&a.push(b)}function c(a){for(var b=[];0!==a.length;){for(var c=null,d=0;d<a.length;++d){for(var e=a[d],f=Ogma.modules[e].dependencies||[],g=!0,h=0;h<f.length;++h)if(b.indexOf(f[h])===-1){g=!1;break}if(g){c=e,b.push(e),a.splice(d,1);break}}if(!c)throw new Error("Unable to resolve dependencies. Remaining modules: "+JSON.stringify(a))}return b}function d(a){for(var b=0;b<a.length;++b)for(var c=Ogma.modules[a[b]].dependencies||[],d=0;d<c.length;++d)if(!Ogma.modules[c[d]])throw new Error(a[b]+": invalid dependency "+c[d])}function e(a,b){for(var c=0;c<a.length;++c){var d=a[c],e=Ogma.modules[d];if(!e||b!==!Ogma.modules[d].isPlugin)throw new Error((b?"core module":"plugin")+" "+d+" does not exist")}}var Ogma=function Ogma(b){b=b||{};var f=b.core?"string"==typeof b.core?[b.core]:b.core.slice():Object.keys(Ogma.modules).filter(function(a){return!Ogma.modules[a].isPlugin}),g=("all"===b.plugins?Object.keys(Ogma.modules).filter(function(a){return Ogma.modules[a].isPlugin}):(b.plugins||[]).slice()).sort();f=a(f).sort();var h=f.concat(g);e(f,!0),e(g,!1),d(h);var i=c(h);this.modules=i.slice();for(var j=0;j<i.length;++j){var k=i[j];this[k]=new Ogma.modules[k](this,b)}for(b.onStart&&b.onStart(this,b),j=0;j<i.length;++j){var l=i[j];Ogma.modules[l].onStart&&Ogma.modules[l].onStart(this[l],b)}};Ogma.prototype.clear=function(){for(var a=this.modules.length-1;a>=0;--a){var b=this.modules[a];Ogma.modules[b].onClear&&Ogma.modules[b].onClear(this[b])}},Ogma.prototype.kill=function(){for(var a=this.modules.length-1;a>=0;--a){var b=this.modules[a],c=this[b],d=Ogma.modules[b];d.onKill&&d.onKill(c),$kill(c),this[b]=void 0}},Ogma.globals={};var f=!1;"object"===("undefined"==typeof window?"undefined":_typeof(window))&&"function"==typeof window.define&&window.define.amd&&(window.define(function(){return Ogma}),f=!0),"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=Ogma,f=!0),f||"object"!==("undefined"==typeof window?"undefined":_typeof(window))||(window.Ogma=Ogma),Ogma.default=Ogma,$global.Ogma=Ogma}.call(),function(){var Ogma=$global.Ogma,a=function(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=c;return b},b=["hover","zoom","panning","rotation","gesture","drag","selection","showTooltip","hideTooltip","creation","lasso"],c=["floor","hover","active","highlight","pulse","drag"],d=["edgeHalos","nodeHaloStrokes","nodeHalos","edgeShapes","edgeOuterStrokes","edgeOutlines","edgeTextBackground","edgeText","nodeOuterStrokes","nodeInnerStrokes","nodeShapes","nodePieCharts","nodeIcons","nodeImages","nodeBadgeStroke","nodeBadge","nodeBadgeImage","nodeBadgeText","nodeOutlines","nodeTextBackground","nodeText","edgePulses","nodePulses","legendBorders","legendBackground","legendContent"],e=22;Ogma.constants={interaction:a(b),layer:a(c),subLayer:a(d),MAX_POW:e,EPSILON:1/Math.pow(2,e)}}(),function(){var Ogma=$global.Ogma;Ogma.libraries=Object.create(null);var a={},b={},c=function(){return null};"object"===("undefined"==typeof global?"undefined":_typeof(global))&&(a=global),"object"===("undefined"==typeof window?"undefined":_typeof(window))&&(b=window),"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"function"==typeof module.require?c=function(a){try{return module.require(a)}catch(a){return null}}:"function"==typeof a.require&&(c=function(b){try{return a.require(b)}catch(a){return null}}),Ogma.require=function(d,e){e=$or(e,{});var f=e.variable,g=e.fallback,h=$or(e.throwOnError,!0),i=null;if(!i&&d&&(i=Ogma.libraries[d]),!i&&f&&(i=Ogma.libraries[f]),!i&&d&&(i=c(d)),!i&&f&&(i=b[f]),!i&&f&&(i=a[f]),i||"function"!=typeof g||(i=g()),!i&&g&&(i=g),!i&&h){var j='unable to find module "'+d+'"'+(f?"or global variable globalVarName":"")+"; make sure one of these statements is true:\n";throw j+="- require('"+d+"') returns the right library\n",j+="- Ogma.libraries['"+d+"'] is set to the right library\n",f&&(j+="- window['"+f+"'] is set to the right library"),new Error(j)}return i}}(),function(a){var Ogma=$global.Ogma;Ogma.utils={},Ogma.utils.closestValue=function(a,b,c){for(var d=Math.abs(b-a[0]),e=0,f=1;f<a.length;++f){var g=Math.abs(b-a[f]);g<d&&(d=g,e=f)}return c?e:a[e]},Ogma.utils.computeRange=function(a,b,c){if(1===c)return[a];for(var d=(b-a)/(c-1),e=new Array(c),f=0;f<c;++f)e[f]=a+d*f;return e};var b=100;Ogma.utils.findFunctionParameter=function(a,c,d,e,f){for(var g=a(d)<=a(e),h=d,i=e,j=0;j<b;++j){var k=(h+i)/2,l=a(k),m=Math.abs(l-c);if(m<=f)return k;l<c?g?h=k:i=k:g?i=k:h=k}return k},Ogma.utils.upperPowerOf=function(a,b,c){for(var d=b;d<a||d<c;)d*=b;return d},Ogma.utils.createCounter=function(){var a=0;return function(){return++a}},Ogma.utils.convertToString=function(b){var c="undefined"==typeof b?"undefined":_typeof(b);return"string"===c?b:"function"===c||"number"===c||"boolean"===c?b.toString():null===b?"null":b===a?"undefined":JSON.stringify(b)},Ogma.utils.throttle=function(a,b,c){var d,e,f,g;return 0===b?function(){a.apply(c,arguments)}:(g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){var f;return d?e=arguments:(f=a.apply(c,arguments),setTimeout(g,b),d=!0),f})}}.call(),function(a){function b(){this.objects=new Map,this.size=0}function c(){this.objects=Object.create(null),this.size=0}var Ogma=$global.Ogma;if(b.prototype.set=function(a,b){this.objects.set("string"==typeof a?a:JSON.stringify(a),b),this.size=this.objects.size},b.prototype.get=function(a){return this.objects.get("string"==typeof a?a:JSON.stringify(a))},b.prototype.has=function(a){return this.objects.has("string"==typeof a?a:JSON.stringify(a))},b.prototype.clear=function(){this.objects.clear(),this.size=this.objects.size},b.prototype.forEach=function(a){this.objects.forEach(a)},b.prototype.delete=function(a){var b=this.objects.delete(a.toString());return this.size=this.objects.size,b},b.prototype.keyList=function(){if(Array.from)return Array.from(this.objects.keys());var a=[],b=this.objects.keys();if(b.next)for(var c=b.next();!c.done;c=b.next())a.push(c.value);else this.objects.forEach(function(b,c){a.push(c)});return a},b.prototype.values=function(){if(Array.from)return Array.from(this.objects.values());var a=[],b=this.objects.keys();if(b.next)for(var c=b.next();!c.done;c=b.next())a.push(c.value);else this.objects.forEach(function(b,c){a.push(c)});return a},c.prototype.set=function(a,b){"undefined"==typeof this.objects[a]&&(this.size+=1),this.objects[a]=b},c.prototype.has=function(a){return"undefined"!=typeof this.objects[a]},c.prototype.get=function(a){return this.objects[a]},c.prototype.clear=function(){this.objects=Object.create(null),this.size=0},c.prototype.forEach=function(a){for(var b=Object.keys(this.objects),c=0;c<b.length;++c){var d=b[c],e=this.objects[d];"undefined"!=typeof e&&a(e,d)}},c.prototype.delete=function(b){return this.objects[b]!==a&&(this.size-=1,this.objects[b]=a,!0)},c.prototype.keyList=function(){for(var b=this.objects,c=Object.keys(b),d=c.length,e=[],f=0;f<d;++f){var g=c[f],h=b[g];h!==a&&e.push(g)}return e},c.prototype.values=function(){for(var b=this.objects,c=Object.keys(b),d=c.length,e=[],f=0;f<d;++f){var g=c[f],h=b[g];h!==a&&e.push(h)}return e},"undefined"!=typeof Map&&"undefined"!=typeof Map.prototype.keys&&"undefined"!=typeof Map.prototype.values)try{(new Map).keys().next(),(new Map).values().next(),Ogma.utils.Map=b}catch(a){Ogma.utils.Map=c}else Ogma.utils.Map=c;Ogma.utils.OgmaMapES5=c,Ogma.utils.OgmaMapES6=b}.call(),function(a){function b(a){if(this._set=Object.create(null),a)for(var b=0;b<a.length;++b)this._set[a[b]]=!0}function c(a){this._set=new Set(a)}var Ogma=$global.Ogma;b.prototype.add=function(a){var b=this._set[a];return this._set[a]=!0,!b},b.prototype.remove=function(b){var c=this._set[b];return this._set[b]=a,c},b.prototype.delete=b.prototype.remove,b.prototype.has=function(a){return this._set[a]},b.prototype.values=function(){return Object.keys(this._set).filter(function(a){return a})},b.prototype.clear=function(){this._set=Object.create(null)},b.prototype.forEach=function(a){for(var b=Object.keys(this._set),c=0;c<b.length;++c){var d=b[c];this._set[d]&&a(d)}},c.prototype.add=function(a){return this._set.add(a)},c.prototype.remove=function(a){return this._set.delete(a)},c.prototype.delete=c.prototype.remove,c.prototype.has=function(a){return this._set.has(a)},c.prototype.values=function(){return Array.from(this._set)},c.prototype.clear=function(){this._set.clear()},c.prototype.forEach=function(a){this._set.forEach(a)},"undefined"!=typeof Set&&Set.values?Ogma.utils.Set=c:Ogma.utils.Set=b}.call(),function(a){function b(){if(g)return g;throw new Error('unable to use "document"; if you use Node JS install the "xmldom" package')}function c(a,b){this.data=a,this.type=b}var Ogma=$global.Ogma,d=Ogma.require("xmldom",{throwOnError:!1}),e=Ogma.require("canvas",{throwOnError:!1}),f=null,g=null,h=null;"undefined"!=typeof XMLSerializer?f=XMLSerializer:d&&(f=d.XMLSerializer),"undefined"!=typeof document?g=document:d&&(g=(new d.DOMImplementation).createDocument()),Ogma.utils.createXmlDocument=function(){if(g)return g.implementation.createDocument("","",null);throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')},Ogma.utils.serializeXMLDocument=function(a){if(f)return(new f).serializeToString(a);throw new Error('unable to instantiate XMLSerializer; if you use Node JS install the "xmldom" package')},h=e?function(a,b){var c=new e(a,b);return c.style={},c}:"undefined"!=typeof document?function(a,b){var c=document.createElement("canvas");return Ogma.utils.resizeElement(c,a,b),c}:function(){throw new Error('Unable to create a canvas element; if you run on Node make sure the "canvas" package is installed, as well as its dependencies')},Ogma.utils.createCanvas=h,Ogma.utils.pixelRatio=function(){return"undefined"!=typeof window&&window.devicePixelRatio||1},Ogma.utils.dataUrlToBlob=function(a){var b,c,d,e=";base64,";if(a.indexOf(e)==-1)return b=a.split(","),c=b[0].split(":")[1],d=decodeURIComponent(b[1]),Ogma.utils.createBlob(d,c);b=a.split(e),c=b[0].split(":")[1],d=window.atob(b[1]);for(var f=d.length,g=new Uint8Array(f),h=0;h<f;++h)g[h]=d.charCodeAt(h);return Ogma.utils.createBlob([g],c)},Ogma.utils.createBlob=function(a,b){return"undefined"!=typeof Blob?new Blob(a,{type:b}):new c(a,b)},Ogma.utils.isBlob=function(a){return"undefined"!=typeof Blob?a instanceof Blob||a instanceof c:a instanceof c},Ogma.utils.download=function(a,b,c){if("undefined"==typeof window)return a;var d=null,e=null,f=null;if(window.Blob?(d="blob"===c?a:"dataURL"===c?Ogma.utils.dataUrlToBlob(a):Ogma.utils.createBlob([a],"text/xml"),e=window.URL.createObjectURL(d)):f="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(a),navigator.msSaveBlob)navigator.msSaveBlob(d,b);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(d,b);else{var g=document.createElement("a");g.setAttribute("href",window.Blob?e:f),g.setAttribute("download",b),document.body.appendChild(g),g.click(),document.body.removeChild(g)}return e&&setTimeout(function(){window.URL.revokeObjectURL(e)},0),a};var i;Ogma.utils.textWidth=function(a,b,c,d){return i.style.fontFamily=b,i.style.fontSize=c+"px",i.style.fontStyle="italic"===d?"italic":"normal",i.style.fontWeight="bold"===d?"bold":"normal",i.innerHTML=a,i.offsetWidth},Ogma.utils.resizeElement=function(a,b,c){var d=Ogma.utils.pixelRatio();a.width=b*d,a.height=c*d,a.style.width=b+"px",a.style.height=c+"px"},Ogma.utils.createAndAppend=function(c,d,e,f,g){var h=b().createElement(d);if(e&&Ogma.utils.forEach(e,function(b,c){b!==a&&h.setAttribute(c,b)}),"undefined"!=typeof f||g){"[object Object]"===Object.prototype.toString.call(f)&&(f=JSON.stringify(f));var i=document.createTextNode(f);h.appendChild(i)}return c.appendChild(h),h},Ogma.utils.setAttributes=function(b,c){Ogma.utils.forEach(c,function(c,d){c!==a&&b.setAttribute(d,c)})},Ogma.utils.createSvgElement=function(a,c){var d=b().createElementNS("http://www.w3.org/2000/svg",a);return d.style||(d.style={}),c&&Ogma.utils.setAttributes(d,c),d},Ogma.utils.bind=function(a,b,c,d){d=d||0;var e=Ogma.utils.now(),f=0===d?c:function(a){var b=Ogma.utils.now();b-e>d&&(c(a),e=b)};return a.addEventListener(b,f),{listener:f,elt:a,eventName:b}},Ogma.utils.unbind=function(a){a.elt.removeEventListener(a.eventName,a.listener)},Ogma.utils.getImage=function(a,b){if("undefined"==typeof Image)b(null);else{var c=new Image;c.src=a,c.onload=function(){b(c)},c.onerror=function(){b(null)}}}}.call(),function(a){function b(a,b){b=b||2;for(var c=Math.pow(10,b-1),d=a;c>1;)a<c&&(d="0"+d),c/=10;return d}var Ogma=$global.Ogma;"undefined"!=typeof performance&&performance.now?Ogma.utils.now=function(){return 0|performance.now()}:Ogma.utils.now=function(){return Date.now()},Ogma.utils.getDate=function(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();return b<10&&(b="0"+b),c<10&&(c="0"+c),d+"-"+c+"-"+b},Ogma.utils.getTime=function(){var a=new Date;return"["+b((a.getUTCHours()-(a.getTimezoneOffset()/60|0))%24)+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+":"+b(a.getUTCMilliseconds(),3)+"]"},Ogma.utils.createDelayer=function(){var a=null;return{fire:function(b,c){a&&(clearTimeout(a),a=null),a=setTimeout(function(){a=null,b()},c)},stop:function(){a&&(clearTimeout(a),a=null)}}}}.call(),function(a){function b(a,b){a||(a=this.DEFAULT_ERROR_HANDLER),this.errorHandler=a,b||(b=a),this.bugHandler=b}var Ogma=$global.Ogma,c={},d={};Ogma.utils.isInteger=function(a){return a===+a&&a===(0|a)},Ogma.utils.isNumber=function(a){return a===a&&"[object Number]"===Object.prototype.toString.call(a)},Ogma.utils.isPositive=function(a){return"number"==typeof a&&a>0},Ogma.utils.isObject=function(a){return"object"===("undefined"==typeof a?"undefined":_typeof(a))&&null!==a},Ogma.utils.checkNumberArray=function(a,b,c,d){if(!(a instanceof Array)||a.length<b)throw new TypeError("invalid "+c+" array: "+JSON.stringify(a)+": expected array of size at least "+b);for(var e=0;e<a.length;++e)if(!Ogma.utils[d?"isPositive":"isNumber"](a[e]))throw new TypeError("invalid "+c+" "+Ogma.utils.stringify(a[e])+": expected positive number")};var e=new RegExp("^#[a-fA-F0-9]{6}$"),f=new RegExp("^#[a-fA-F0-9]{3}$");b.prototype={DEFAULT_ERROR_HANDLER:function(a){throw new Error(a)},_error:function(a,b){this.errorHandler('"'+a+'" '+b)},_bug:function(a){this.bugHandler(a)},nonEmpty:function(a,b){return this.string(a,b,!0)},string:function(b,c,d,e,f,g){this.exist(b,c),"string"!=typeof c&&this._error(b,"must be a string"),d&&""===c&&this._error(b,"must be a non-empty string"),e&&c.indexOf(" ")>-1&&this._error(b,"must not contain spaces"),f!==a&&c.length<f&&this._error(b,"must have at least "+f+" characters"),g!==a&&c.length>g&&this._error(b,"must have at most "+g+" characters")},stringOrNumber:function(a,b){"number"==typeof b&&isFinite(b)||"string"==typeof b||this._error(a,"must be a string or a number")},startsWith:function(a,b,c,d){this.string(a,b),0!==b.indexOf(c)&&this._error(a,'must start with "'+c+'"'),d!==!1&&b.length<=c.length&&this._error(a,'must be longer than "'+c+'"')},hexColor:function(a,b,c){this.string(a,b,!0),e.test(b)||c!==!1&&f.test(b)||this._error(a," #AAABBCC or #ABC")},exist:function(b,c){c===a&&this._error(b,"must not be undefined"),null===c&&this._error(b,"must not be null")},null:function(a,b){null!==b&&this._error(a,"must be null")},object:function(a,b){this.exist(a,b),"object"!==("undefined"==typeof b?"undefined":_typeof(b))&&this._error(a,"must be an object")},array:function(a,b,c,d){this.exist(a,b),Array.isArray(b)||this._error(a,"must be an array"),this._checkInterval(a,b.length,"length must be",c,d)},_checkInterval:function(b,c,d,e,f){e!==a&&f!==a&&(c<e||c>f)?this._error(b,""+d+" between "+e+" and "+f):e!==a&&c<e&&0===e?this._error(b,""+d+" positive"):e!==a&&c<e?this._error(b,""+d+" greater than "+e):f!==a&&c>f&&this._error(b,""+d+" smaller than "+f)},posInt:function(a,b){this.integer(a,b,0)},intArray:function(a,b,c,d){this.array(a,b,c,d);for(var e=0,f=b.length;e<f;e++)this.integer(a+"["+e+"]",b[e])},stringArray:function(a,b,c,d,e){this.array(a,b,c,d);for(var f=0,g=b.length;f<g;f++)this.string(a+"["+f+"]",b[f],e)},integer:function(a,b,c,d){this.number(a,b,c,d),Number.isInteger(b)||this._error(a,"must be an integer")},number:function(b,c,d,e){this.exist(b,c),"number"==typeof c&&isFinite(c)||this._error(b,"must be a number"),d!==a&&e!==a&&(c<d||c>e)?this._error(b,"must be a number between "+d+" and "+e):d!==a&&c<d&&0===d?this._error(b,"must be a positive number"):d!==a&&c<d?this._error(b,"must be a number greater than "+d):e!==a&&c>e&&this._error(b,"must be a number smaller than "+e)},positive:function(a,b){return this.number(a,b,0)},enums:function(a,b,c){Array.isArray(c)&&0!==c.length||this._bug("enum values must be a non-empty array.");for(var d=0;d<c.length;++d){if(b===c[d])return;if(Number.isNaN(b)&&Number.isNaN(c[d]))return}this._error(a,"["+b+"] must be on of the values ("+this._array2string(c)+")")},_array2string:function(b){return b.map(function(b){return b===a?"undefined":JSON.stringify(b)}).join(", ")},enumKeys:function(a,b,d,e){this.object(a,b);var f=c.keys(b),g=c.difference(f,d);if(g.length>0&&this._error(a,"has unexpected properties (${this._array2string(unauthorized)})"),e){e===!0&&(e=d);var h=c.difference(e,f);h.length>0&&this._error(a,"misses mandatory properties (${this._array2string(missing)})")}},properties:function(b,c,d,e){this.object(b,c);var f=Object.keys(d);if(e===a&&(e="strict"),"strict"===e){for(var g=Object.keys(c),h=[],i=0;i<g.length;++i)f.indexOf(g[i])===-1&&h.push(g[i]);h.length>0&&this._error(b,"has unexpected properties ("+this._array2string(h)+")")}var j=0;f.forEach(function(a){j+=this.property(""+b+"."+a,c[a],d[a])?1:0},this),"strictExist"===e&&0===j&&this._error(b,"At least one of these properties is required ("+this._array2string(f)+").")},property:function(b,c,d){if(!d)return c!==a;if(d.required===!0)this.exist(b,c);else if(c===a)return!1;if(d.check&&d.check(b,c),d.values)return this.enums(b,c,d.values),!0;if(d.properties)return this.type(b,c,"object"),this.properties(b,c,d.properties,d.propertiesPolicy),!0;if(d.anyProperty)return this.type(b,c,"object"),Object.keys(c).forEach(function(a){this.property(""+b+"."+a,c[a],d.anyProperty)}),!0;if(d.arraySize!==a&&this.array(b,c,d.arraySize,d.arraySize),d.arrayItem)return d.arrayItem.required===a&&(d.arrayItem.required=!0),this.type(b,c,"array"),c.forEach(function(a,e){this.property(""+b+"["+e+"]",c[e],d.arrayItem)},this),!0;if(d.type!==a){var e=d.type;if(!this[e])throw new Error("type "+e+" does not exist");this[e](b,c)}return!0},regexp:function(a,b,c){this.string(a,b),c.test(b)||this._error(a,"must match the pattern /${regexp.source}/${regexp.flags}")},type:function(a,b,c){var d=this.getType(b);c=this._itemOrList(c,[]),0===c.length&&this._bug("check.type: type array must have at least one type");for(var e=!1,f=0;f<c.length&&!e;++f)e=c[f]==d;return e||this._error(a,"does not have expected type ("+this._array2string(c)+")"),d},getType:function(a){return null===a?"null":Array.isArray(a)?"array":"undefined"==typeof a?"undefined":_typeof(a)},_itemOrList:function(b,c){return b===a||null===b?c!==a?c:b:Array.isArray(b)?b:[b]},boolean:function(b,c,d,e){d||this.exist(b,c),this.type(b,c,d?["boolean","undefined"]:"boolean"),e!==a&&this.enums(b,c,[e])},exclusive:function(b,d,e,f){var g=c.map(d,function(b,c){return b===a?a:c});g=c.filter(g,function(b){return b!==a});var h=c.intersection(g,e);h.length>1&&this._error(b,"cannot have these properties set a the same time: ${this._array2string(intersection)}"),0===h.length&&f&&this._error(b,"should have one of these properties set: ${this._array2string(exclusiveKeys)}"),1===h.length&&f&&this.exist(b+"."+h[0],d[h[0]])},function:function(a,b){"function"!=typeof b&&this._error(a,"must be a function")},readable:function(a,b){this.string(a,b,!0);try{return d.statSync(b)}catch(b){return this._error(a,"must be readable"),null}},file:function(a,b){var c=this.readable(a,b);c&&(c.isFile()||this._error(a,"must be a file"))}},Ogma.utils.typeCheck=new b}.call(),function(a){function b(a,b){this.nodes=new Ogma.utils.ElementSet(a),this.edges=new Ogma.utils.ElementSet(b)}var Ogma=$global.Ogma;b.prototype.has=function(a){return a.isNode?this.nodes.has(a):this.edges.has(a)},b.prototype.add=function(a){return a.isNode?this.nodes.add(a):this.edges.add(a)},b.prototype.remove=function(a){return a.isNode?this.nodes.remove(a):this.edges.remove(a)},b.prototype.clear=function(){this.nodes.clear(),this.edges.clear()},Ogma.utils.BiSet=b}.call(),function(a){var Ogma=$global.Ogma,b=3;Ogma.utils.gaussianMatrix=function(a){for(var c=[],d=b*a|0,e=-d;e<=d;++e){var f=1/Math.sqrt(2*Math.PI*a*a)*Math.pow(Math.E,-(e*e/(2*a*a)));f=Math.round(1e3*f)/1e3,c.push(f)}return c},Ogma.utils.isPowerOfTwo=function(a){return Ogma.utils.isInteger(Math.log(a)/Math.LN2)}}.call(),function(a){var Ogma=$global.Ogma;Ogma.utils.roundedRect=function(a,b,c,d,e,f,g,h,i){if(0===g)return a.rectangle(b,{x:c+e/2,y:d+f/2},{zx:e/2,zy:f/2},h,i);var j=a.updateComposite(b,7);return j[0]=a.quadrilateral(j[0],{x:c,y:d+g-1},{x:c+e,y:d+g-1},{x:c+e,y:d+f-g+1},{x:c,y:d+f-g+1},h,i),j[1]=a.quadrilateral(j[1],{x:c+g,y:d},{x:c+e-g,y:d},{x:c+e-g,y:d+g},{x:c+g,y:d+g},h,i),j[2]=a.quadrilateral(j[2],{x:c+g,y:d+f-g},{x:c+e-g,y:d+f-g},{x:c+e-g,y:d+f},{x:c+g,y:d+f},h,i),j[3]=a.circle(j[3],{x:c+g,y:d+g},0,g,h,i),j[4]=a.circle(j[4],{x:c+e-g,y:d+g},0,g,h,i),j[5]=a.circle(j[5],{x:c+g,y:d+f-g},0,g,h,i),j[6]=a.circle(j[6],{x:c+e-g,y:d+f-g},0,g,h,i),a.composite(b,j)};var b=50;Ogma.utils.circleStroke=function(a,c,d,e,f,g,h,i){for(var j=a.updateComposite(c,b),k=2*Math.PI/b,l=g/2,m=k,n={x:d,y:e,zx:f,zy:0},o={x:d,y:e,zx:f,zy:0,ox:l,oy:0},p=0;p<b;++p){var q=Math.cos(m),r=Math.sin(m),s={x:d,y:e,zx:q*f,zy:r*f},t={x:d,y:e,zx:q*f,zy:r*f,ox:q*l,oy:r*l};j[p]=a.quadrilateral(j[p],n,s,t,o,h,i),n=s,o=t,m+=k}return a.composite(c,j)},Ogma.utils.circleStroke=function(a,c,d,e,f,g,h,i){for(var j=a.updateComposite(c,b),k=2*Math.PI/b,l=g/2,m=k,n={x:d,y:e,zx:f,zy:0},o={x:d,y:e,zx:f,zy:0,ox:l,oy:0},p=0;p<b;++p){var q=Math.cos(m),r=Math.sin(m),s={x:d,y:e,zx:q*f,zy:r*f},t={x:d,y:e,zx:q*f,zy:r*f,ox:q*l,oy:r*l};j[p]=a.quadrilateral(j[p],n,s,t,o,h,i),n=s,o=t,m+=k}return a.composite(c,j)}}.call(),function(a){function b(a){return"string"==typeof a&&!e.test(""+a)}var Ogma=$global.Ogma;Ogma.utils.forEach=function(a,b,c){if(a instanceof Array)a.forEach(b);else{if("object"!==("undefined"==typeof a?"undefined":_typeof(a))||null===a)throw new Error("iterate: invalid argument "+JSON.stringify(a));var d=Object.keys(a);if(c)for(var e=0;e<d.length;++e){var f=d[e];b.call(c,a[f],f)}else for(e=0;e<d.length;++e)f=d[e],b(a[f],f)}},Ogma.utils.shallowCopy=function(a){var b={};return Ogma.utils.forEach(a,function(a,c){b[c]=a}),b},Ogma.utils.stringify=function(b){return b===a?"undefined":JSON.stringify(b)},Ogma.utils.deepCopy=function(a){if(a instanceof Array){for(b=new Array(a.length),d=0;d<a.length;++d)b[d]=Ogma.utils.deepCopy(a[d]);return b}if("object"===("undefined"==typeof a?"undefined":_typeof(a))&&null!==a){for(var b={},c=Object.keys(a),d=0;d<c.length;++d){var e=c[d];b[e]=Ogma.utils.deepCopy(a[e])}return b}return a},Ogma.utils.updateObject=function(a,b){var c=this;Ogma.utils.forEach(b,function(b,d){"object"===("undefined"==typeof d?"undefined":_typeof(d))&&null!==d?("object"===_typeof(a[b])&&null!==a[b]||(a[b]={}),c.updateObject(a[b],d)):a[b]=d})},Ogma.utils.extendList=function(a,b){b.forEach(function(b){a.indexOf(b)===-1&&a.push(b)})},Ogma.utils.strToObjectRef=function(b,c){for(var d=c.indexOf(".");b&&d!==-1;)b=b[c.substr(0,d)],c=c.substr(d+1),d=c.indexOf(".");return b?b[c]:a},Ogma.utils.hasProperty=function(a,b){for(var c=b.indexOf(".");a&&c!==-1;)a=a[b.substr(0,c)],b=b.substr(c+1),c=b.indexOf(".");return!!a&&a.hasOwnProperty(b)},Ogma.utils.setPathValue=function(a,b,c){for(var d=b.indexOf(".");d!==-1;){var e=b.substr(0,d),f=a[e];f||(f={},a[e]=f),b=b.substr(d+1),d=b.indexOf("."),a=f}a[b]=c};var c=function(){};Ogma.utils.bindProperty=function(a,b,d,e){for(var f=b.indexOf(".");f!==-1;){var g=b.substr(0,f),h=a[g];h||(h={},a[g]=h),b=b.substr(f+1),f=b.indexOf("."),a=h}var i=a[b];Object.defineProperty(a,b,{get:d||function(){return i},set:e||c,configurable:!0})},Ogma.utils.unbindProperty=function(a,b){for(var c=b.indexOf("."),d=b;a&&c!==-1;)a=a[b.substr(0,c)],b=b.substr(c+1),c=b.indexOf(".");if(!a)throw new Error('No property "'+d+'" exist.');var e=a[b];Object.defineProperty(a,b,{value:e,configurable:!0})},Ogma.utils.concat=function(){for(var a=arguments.reduce(function(a,b){return a+(b?b.length:0)},0),b=new Array(a),c=0,d=0;d<arguments;++d)if(arguments[d])for(var e=0;e<arguments[d].length;++e)b[c]=arguments[d][e],++c;return b},Ogma.utils.setReadOnly=function(a,b){Ogma.utils.forEach(b,function(b,c){Object.defineProperty(a,c,{enumerable:!0,get:b})})};var d=function(){},e=/\{\s*\[native code\]\s*\}/;Ogma.utils.kill=function(a){if("object"===("undefined"==typeof a?"undefined":_typeof(a))){var c=a.constructor;if(b(c))for(var e=Object.keys(c.prototype),f=0;f<e.length;++f){var g=e[f];"function"==typeof c.prototype[g]&&(a[g]=d)}}}}.call(),function(a){var Ogma=$global.Ogma,b=null;if("undefined"!=typeof window&&"undefined"!=typeof document){var c={opera:!!window.opr&&!!window.opr.addons||!!window.opera||"undefined"!=typeof navigator&&navigator.userAgent.indexOf(" OPR/")>=0,firefox:"undefined"!=typeof InstallTrigger,safari:Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,ie:!!document.documentMode,edge:!document.documentMode&&!!window.StyleMedia,
chrome:!!window.chrome&&!!window.chrome.webstore};for(var d in c)if(c.hasOwnProperty(d)&&c[d]){b=d;break}}Ogma.utils.browser=b}.call(),function(a){function b(a,b,c,d,e,g,h,i){if(8===arguments.length)this.x=a,this.y=b,this.ax=e,this.ay=g,this.zx=c,this.zy=d,this.ox=h,this.oy=i;else{for(var j=0;j<f.length;++j)this[f[j]]=0;"object"===("undefined"==typeof a?"undefined":_typeof(a))&&null!==a&&Ogma.utils.forEach(a,function(a,b){this[b]=a},this)}}function c(a){Array.call(this),Object.defineProperty(this,"__internalCounter",{value:{},writable:!0});for(var c=0;c<a;++c)this.push(new b);for(c=0;c<f.length;++c)d(this,f[c]);for(c=0;c<h.length;++c)this.__internalCounter[h[c]]=0}function d(a,b){Object.defineProperty(a,b,{get:function(){for(var a=new Array(this.length),c=0;c<this.length;++c)a[c]=this[c][b];return a},set:function(a){for(var c=0;c<this.length;++c)this[c][b]=a},enumerable:!1})}function e(a){c.prototype[a]=function(b,c){return this[this.__internalCounter[a]][a](b,c),this.__internalCounter[a]+=1,this.__internalCounter[a]===this.length&&(this.__internalCounter[a]=0),this}}var Ogma=$global.Ogma,f=["x","y","ax","ay","zx","zy","ox","oy"];b.prototype.reset=function(){for(var a=0;a<f.length;++a)this[f[a]]=0;return this},b.prototype.add=function(a){for(var b=0;b<f.length;++b){var c=f[b];this[c]+=a[c]}return this},b.prototype.mergeCoordinates=function(){return{x:this.x+this.zx+this.ax+this.ox,y:this.y+this.zy+this.ay+this.oy}},b.prototype.set=function(a){if(a instanceof b)for(var c=0;c<f.length;++c){var d=f[c];this[d]=a[d]}else Ogma.utils.forEach(a,function(a,b){this[b]=a},this);return this},b.prototype.setAll=function(a,b,c,d,e,f,g,h){this.x=a,this.y=b,this.ax=e,this.ay=f,this.zx=c,this.zy=d,this.ox=g,this.oy=h},b.prototype.setXY=function(a,b){return this.x=a,this.y=b,this},b.prototype.addXY=function(a,b){return this.x+=a,this.y+=b,this},b.prototype.setZXY=function(a,b){return this.zx=a,this.zy=b,this},b.prototype.setAXY=function(a,b){return this.ax=a,this.ay=b,this},b.prototype.setOXY=function(a,b){return this.ox=a,this.oy=b,this},b.prototype.addZXY=function(a,b){return this.zx+=a,this.zy+=b,this},b.prototype.addOXY=function(a,b){return this.ox+=a,this.oy+=b,this},b.prototype.clone=function(){return new b(this.x,this.y,this.zx,this.zy,this.ax,this.ay,this.ox,this.oy)},Ogma.utils.rectangleFromCenterAndDimensions=function(a,b,c,d,e,f){var g=a,h=b;c.x=g.x-h.x,c.y=g.y-h.y,c.ax=g.ax-h.ax,c.ay=g.ay-h.ay,c.zx=g.zx-h.zx,c.zy=g.zy-h.zy,c.ox=g.ox-h.ox,c.oy=g.oy-h.oy,d.x=g.x+h.x,d.y=g.y-h.y,d.ax=g.ax+h.ax,d.ay=g.ay-h.ay,d.zx=g.zx+h.zx,d.zy=g.zy-h.zy,d.ox=g.ox+h.ox,d.oy=g.oy-h.oy,e.x=g.x+h.x,e.y=g.y+h.y,e.ax=g.ax+h.ax,e.ay=g.ay+h.ay,e.zx=g.zx+h.zx,e.zy=g.zy+h.zy,e.ox=g.ox+h.ox,e.oy=g.oy+h.oy,f.x=g.x-h.x,f.y=g.y+h.y,f.ax=g.ax-h.ax,f.ay=g.ay+h.ay,f.zx=g.zx-h.zx,f.zy=g.zy+h.zy,f.ox=g.ox-h.ox,f.oy=g.oy+h.oy};var g={x:0,y:0};Ogma.utils.lineFromBoundaries=function(a,b,c,d,e,f,h,i){Ogma.geometry.unitVector(a.x,a.y,b.x,b.y,.5,g),e.x=a.x-g.y*c,e.y=a.y+g.x*c,e.ax=a.ax-g.y*d,e.ay=a.ay+g.x*d,e.zx=a.zx,e.zy=a.zy,e.ox=a.ox,e.oy=a.oy,f.x=a.x+g.y*c,f.y=a.y-g.x*c,f.ax=a.ax+g.y*d,f.ay=a.ay-g.x*d,f.zx=a.zx,f.zy=a.zy,f.ox=a.ox,f.oy=a.oy,i.x=b.x-g.y*c,i.y=b.y+g.x*c,i.ax=b.ax-g.y*d,i.ay=b.ay+g.x*d,i.zx=b.zx,i.zy=b.zy,i.ox=b.ox,i.oy=b.oy,h.x=b.x+g.y*c,h.y=b.y-g.x*c,h.ax=b.ax+g.y*d,h.ay=b.ay-g.x*d,h.zx=b.zx,h.zy=b.zy,h.ox=b.ox,h.oy=b.oy},c.prototype=Object.create(Array.prototype),c.prototype.constructor=c;var h=["setXY","setZXY","setAXY","setOXY"];c.prototype.reset=function(){for(var a=0;a<h.length;++a)this.__internalCounter[h[a]]=0;for(a=0;a<this.length;++a)this[a].reset();return this};for(var i=0;i<h.length;++i)e(h[i]);c.prototype.mergeCoordinates=function(){for(var a=[],b=0;b<this.length;++b)a.push(this[b].mergeCoordinates());return a},c.prototype.getXYList=function(){for(var a=new Array(this.length),b=0;b<this.length;++b)a[b]={x:this[b].x,y:this[b].y};return a},Ogma.utils.Position=b,Ogma.utils.PositionList=c}.call(),function(a){function b(a){this.maxNbElementsPerRegion=a,this.rootRegion=null}function c(a,b,c,d,e){this.cx=a,this.cy=b,this.parent=e,this.size=c,this.final=!1,this.leaf=!0,this.maxEltSize=0,this.maxNbElementsPerRegion=d,this.topLeft=null,this.topRight=null,this.botLeft=null,this.botRight=null,this.elements=[]}function d(a,b){a.maxEltSize<b&&(a.maxEltSize=b,a.parent&&d(a.parent,b))}function e(a,b){var c=a.cx-a.size,d=a.cx+a.size,e=a.cy-a.size,f=a.cy+a.size;return Ogma.geometry.isPointInRectangle(b.x1,b.y1,c,e,d,f)||Ogma.geometry.isPointInRectangle(b.x1,b.y2,c,e,d,f)||Ogma.geometry.isPointInRectangle(b.x2,b.y1,c,e,d,f)||Ogma.geometry.isPointInRectangle(b.x2,b.y2,c,e,d,f)}function f(a,b){var c=a.cx-a.size,d=a.cx+a.size,e=a.cy-a.size,f=a.cy+a.size;return b.x1>=c&&b.x2<=d&&b.y1>=e&&b.y2<=f}function g(a){var b=a.size/2;a.topLeft=new c(a.cx-b,a.cy-b,b,a.maxNbElementsPerRegion,a),a.topRight=new c(a.cx+b,a.cy-b,b,a.maxNbElementsPerRegion,a),a.botLeft=new c(a.cx-b,a.cy+b,b,a.maxNbElementsPerRegion,a),a.botRight=new c(a.cx+b,a.cy+b,b,a.maxNbElementsPerRegion,a);for(var d=0;d<a.elements.length;++d)h(a,a.elements[d]);a.elements=null,a.leaf=!1,a.childList=[a.topLeft,a.topRight,a.botLeft,a.botRight]}function h(a,b){a.topLeft.insertElement(b)||a.topRight.insertElement(b)||a.botLeft.insertElement(b)||a.botRight.insertElement(b)}var Ogma=$global.Ogma;Ogma.utils.QuadTree=b,b.prototype.insertElement=function(a){var b,d=a.boundingBox;this.rootRegion||(this.init=!0,this.cx=(d.x1+d.x2)/2,this.cy=(d.y1+d.y2)/2,b=2*Math.max(Math.abs(d.x1-d.x2),Math.abs(d.y1-d.y2)),b<10&&(b=10),this.rootRegion=new c(this.cx,this.cy,b,this.maxNbElementsPerRegion,null));var e=this.rootRegion;for(b=this.rootRegion.size;!f(e,a.boundingBox);)b*=2,e=new c(this.cx,this.cy,b,this.maxNbElementsPerRegion,null);e!=this.rootRegion&&(this.rootRegion.getAllElements().forEach(function(a){e.insertElement(a)}),this.rootRegion=e),this.rootRegion.insertElement(a)},b.prototype.removeElement=function(a){this.rootRegion.removeElement(a);var b=this.rootRegion.nbChildrenEmpty();if(3===b)for(var c=this.rootRegion.children(),d=0;d<c.length;++d)if(!c[d].isEmpty())return this.rootRegion=c[d],void(c[d].parent=null)};var i=[];b.prototype.getElements=function(a,b){return this.rootRegion?this.rootRegion.getElementList(a,b):i},c.prototype.children=function(){return this.leaf?null:this.childList},c.prototype.insertElement=function(a){var b;if(e(this,a.boundingBox)){if(this.leaf&&!this.final&&this.elements.length===this.maxNbElementsPerRegion){for(var c=0;c<this.elements.length;++c)b=this.elements[c].boundingBox,(Math.abs(b.x2-b.x1)>=this.size||Math.abs(b.y2-b.y1)>=this.size)&&(this.final=!0);this.final||g(this)}return this.leaf?(this.elements.push(a),b=a.boundingBox,d(this,Math.max(Math.abs(b.x1-b.x2),Math.abs(b.y1-b.y2)))):h(this,a),!0}return!1},c.prototype.totalNbElements=function(){return this.leaf?this.elements.length:this.topLeft.totalNbElements()+this.topRight.totalNbElements()+this.botLeft.totalNbElements()+this.botRight.totalNbElements()},c.prototype.getAllElements=function(){return this.leaf?this.elements:this.topLeft.getAllElements().concat(this.topRight.getAllElements()).concat(this.botLeft.getAllElements()).concat(this.botRight.getAllElements())},c.prototype.getElementList=function(a,b){if(this.leaf)return this.elements;var c=this.maxEltSize;if(a<this.cx&&b<this.cy)return this.topLeft.getElementList(a,b);if(a>this.cx&&b<this.cy){var d=this.topRight.getElementList(a,b);return a-c>this.cx?d:d.concat(this.topLeft.getElementList(a,b))}if(a<this.cx&&b>this.cy){var e=this.botLeft.getElementList(a,b);return b-c>this.cy?e:e.concat(this.topLeft.getElementList(a,b))}var f=this.botRight.getElementList(a,b);return a-c<=this.cx&&(f=f.concat(this.botLeft.getElementList(a,b))),b-c<=this.cy&&(f=f.concat(this.topRight.getElementList(a,b))),a-c<=this.cx&&b-c<=this.cy&&(f=f.concat(this.topLeft.getElementList(a,b))),f},c.prototype.isEmpty=function(){return this.leaf?0===this.elements.length:this.topLeft.isEmpty()&&this.topRight.isEmpty()&&this.botLeft.isEmpty()&&this.botRight.isEmpty()},c.prototype.nbChildrenEmpty=function(){return this.leaf?0:this.topLeft.isEmpty()+this.topRight.isEmpty()+this.botLeft.isEmpty()+this.botRight.isEmpty()},c.prototype.removeElement=function(a){if(e(this,a.boundingBox)){if(this.leaf){var b=this.elements.indexOf(a);b!==-1&&this.elements.splice(b,1)}else this.topLeft.removeElement(a)||this.topRight.removeElement(a)||this.botLeft.removeElement(a)||this.botRight.removeElement(a),this.isEmpty()&&(this.leaf=!0,this.elements=[],this.childList=null);return!0}return!1}}.call(),function(){$global.Ogma}(),function(a){var Ogma=$global.Ogma,b={};Ogma.utils.benchmark=function(a,c){var d=Ogma.utils.now(),e=c(),f=Ogma.utils.now()-d,g=b[a];return g?(g.sum+=f,g.nb+=1,g.mean=g.sum/g.nb):(g={sum:0,nb:0,mean:0},b[a]=g),e},Ogma.utils.displayBench=function(a){var c=b[a]||{sum:0,nb:0,mean:0};c.mean>=10?console.log(Math.round(c.mean)):console.log(Math.round(1e3*c.mean)/1e3)},Ogma.utils.resetBench=function(a){b[a]={sum:0,nb:0,mean:0}};var c=$global.performance||Date,d={};Ogma.utils.perf=function(a){d[a]=d[a]||{id:a,time:0,runs:0},d[a].st=c.now()},Ogma.utils.perfEnd=function(a){d[a]&&(d[a].time+=c.now()-d[a].st,d[a].runs++,delete d[a].st)},Ogma.utils.getPerf=function(a){function b(a){return a.mean=a.time/a.runs,a}return a?b(d[a]):Object.keys(d).map(function(a){return b(d[a])})},Ogma.utils.resetPerf=function(){d={}}}.call(),function(a){function b(){this.list=Ogma.memory.allocate(Int32Array),this.size=0,this.capacity=this.list.length}var Ogma=$global.Ogma;Ogma.utils.IndexList=b,b.prototype.add=function(a){this.size===this.capacity&&(this.list=Ogma.memory.expand(this.list),this.capacity=this.list.length),this.list[this.size]=a,this.size+=1},b.prototype.addIfMissing=function(a){return!this.has(a)&&(this.add(a),!0)},b.prototype.remove=function(a){if(0===this.size)return!1;var b=this.list.lastIndexOf(a,this.size-1);return b!==-1&&(this.size-=1,this.list[b]=this.list[this.size],!0)},b.prototype.has=function(a){return 0!==this.size&&this.list.lastIndexOf(a,this.size-1)!==-1},b.prototype.clear=function(){this.size=0},b.prototype.pop=function(){return this.size-=1,this.list[this.size]}}.call(),function(){var Ogma=$global.Ogma,a=0,b=$global.requestAnimationFrame||function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=setTimeout(function(){b(c+d)},d);return a=c+d,e},c=$global.cancelAnimationFrame||function(a){clearTimeout(a)};Ogma.utils.requestAnimFrame=function(a,c){return b.call($global,function(){a.call(c)})},Ogma.utils.cancelAnimFrame=function(a){a&&c.call($global,a)}}(),function(a){function b(a){var b=new Blob([a],{type:"application/javascript"}),c=URL.createObjectURL(b),d=new Worker(c);return d}function c(a){return new e(a)}function d(a){return new k(new Function(a))}function e(a){this._f=new Function("self",a),this._main=!0,this._listeners=[],this._terminated=!1,this._otherSide=new f(this),this._f(this._otherSide)}function f(a){this._main=!1,this._listeners=[],this._terminated=!1,this._otherSide=a}function g(a,b){this._listeners.push(b)}function h(a){setTimeout(i,0,this._otherSide,{data:a})}function i(a,b){if(!a._terminated)for(var c=0;c<a._listeners.length;++c)a._listeners[c](b)}var Ogma=$global.Ogma,j=Ogma.require("webworker-threads",{throwOnError:!1}),k=null;j&&(k=j.Worker),Ogma.utils.createWorker=function(a){return k?d(a):"undefined"==typeof URL||navigator.appVersion.indexOf("MSIE 10")!==-1?c(a):b(a)},e.prototype.terminate=function(){this._terminated=!1,this._otherSide._terminated=!0},e.prototype.addEventListener=g,e.prototype.postMessage=h,f.prototype.addEventListener=g,f.prototype.postMessage=h}.call(),function(a){var Ogma=$global.Ogma,b=function(){function a(b){_classCallCheck(this,a),this.size=0,this.totalSize=0,this.exists=[],this.attributes={exists:this.exists},this._attributesList=[this.exists],this._availableIndexes=[],this._nbAvailableIndexes=0,b&&this.addAttributes(b)}return _createClass(a,[{key:"addAttribute",value:function(a,b){if(this.attributes[a])throw new Error('Attribute "'+a+'" already exists.');this.attributes[a]=[],this._attributesList.push(this.attributes[a])}},{key:"addAttributes",value:function(a){var b=this;Ogma.utils.forEach(a,function(a,c){b.addAttribute(c,a)})}},{key:"reserve",value:function(a){}},{key:"addElement",value:function(){var a;if(0===this._nbAvailableIndexes){a=this.size,this.totalSize+=1;for(var b=0;b<this._attributesList.length;++b)this._attributesList[b].push(0)}else for(this._nbAvailableIndexes-=1,a=this._availableIndexes[this._nbAvailableIndexes],b=0;b<this._attributesList.length;++b)this._attributesList[b][a]=0;return this.exists[a]=1,this.size+=1,a}},{key:"removeElement",value:function(a){return!!(this.size>0&&this.exists[a])&&(this.exists[a]=0,this.size-=1,this._availableIndexes[this._nbAvailableIndexes]=a,this._nbAvailableIndexes+=1,!0)}},{key:"clear",value:function(){this.size=0,this._nbAvailableIndexes=0;for(var a=0;a<this._attributesList.length;++a)this._attributesList[a].fill(0)}},{key:"filter",value:function(a){var b=this.attributes.exists,c=this.attributes[a];if(!c)throw new Error("attribute "+a+" does not exist");for(var d=new Array(this.size),e=0,f=0,g=this.totalSize;f<g;++f)b[e]&&(d[e]=c[f],e+=1);return d}},{key:"getIndexList",value:function(){for(var a=this.attributes.exists,b=new Array(this.size),c=0,d=0,e=this.totalSize;d<e;++d)a[d]&&(b[c]=d,c+=1);return b}}]),a}();b.prototype.remove=b.prototype.removeElement,b.prototype.add=b.prototype.addElement,Ogma.utils.StaticList=b}.call(),function(a){function b(){this.array=new Int32Array(e),this.capacity=e,this.size=0}function c(a,b,d,e){if(d===e)return d;var f=d+((e-d)/2|0),g=a[f],h=b-g;return 0===h?f:h<0?c(a,b,d,f):c(a,b,f+1,e)}function d(a){this._indexSet=new b,this._elementAttributes=a}var Ogma=$global.Ogma,e=8;b.prototype.reserve=function(a){if(this.capacity<a){a=Ogma.utils.upperPowerOf(a,2,e);var b=new Int32Array(a);b.set(this.array),this.capacity=a,this.array=b}},b.prototype.has=function(a){var b=c(this.array,a,0,this.size);return b<this.size&&this.array[b]===a},b.prototype.add=function(a){var b=c(this.array,a,0,this.size),d=b<this.size&&this.array[b]===a;return d||(this.size===this.capacity&&this.reserve(this.size+1),this.array.copyWithin(b+1,b,this.size),this.array[b]=a,this.size+=1),!d},b.prototype.remove=function(a){var b=c(this.array,a,0,this.size),d=b<this.size&&this.array[b]===a;return d&&(this.array.copyWithin(b,b+1,this.size),this.size-=1),d},b.prototype.removeByIndex=function(a){return!(a>=this.size)&&(this.array.copyWithin(a,a+1,this.size),this.size-=1,!0)},b.prototype.clear=function(){this.size=0},b.prototype.slice=function(){return this.array.slice(0,this.size)},d.prototype.add=function(a){return this._indexSet.add(a.__index)},d.prototype.has=function(a){return this._indexSet.has(a.__index)},d.prototype.remove=function(a){return!!a&&this._indexSet.remove(a.__index)},d.prototype.removeByIndex=function(a){return this._indexSet.removeByIndex(a)},d.prototype.clear=function(){this._indexSet.clear()},d.prototype.slice=function(){for(var a=new Array(this._indexSet.size),b=this._elementAttributes.ref,c=this._indexSet.size,d=this._indexSet.array,e=0;e<c;++e)a[e]=b[d[e]];return a},d.prototype.sliceOrNull=function(){return 0===this._indexSet.size?null:this.slice()},d.prototype.$get=function(a){return this._elementAttributes.ref[this._indexSet.array[a]]},d.prototype.$length=function(){return this._indexSet.size},d.prototype.mergeSet=function(a){for(var b=a._indexSet.size,c=0;c<b;++c)this.add(a._elementAttributes.ref[a._indexSet.array[c]])},d.prototype.mergeArray=function(a){for(var b=a.length,c=0;c<b;++c)this.add(a[c])},d.prototype.forEach=function(a){for(var b=this._indexSet.size,c=this._elementAttributes.ref,d=this._indexSet.array,e=0;e<b;++e)a(c[d[e]])},d.prototype.map=function(a){for(var b=this._indexSet.size,c=this._elementAttributes.ref,d=this._indexSet.array,e=new Array(b),f=0;f<b;++f)e[f]=a(c[d[f]]);return e},Object.defineProperty(d.prototype,"length",{get:function(){throw new Error('invalid use of property "length": use "_indexSet.size" instead.')}}),Ogma.utils.IntSet=b,Ogma.utils.ElementSet=d}.call(),function(){var Ogma=$global.Ogma,a=function(){},b=Array.isArray;a.prototype.on=function(a,b){if("string"!=typeof a)throw new TypeError("Event name must be string");if("function"!=typeof b)throw new TypeError("Event handler must be function");var c=this._events=this._events||{},d=c[a]=c[a]||[];return d.push(b),this},a.prototype.addEventListener=a.prototype.on,a.prototype.off=function(a,c){if("string"!=typeof a)throw new TypeError("Event name must be string");var d=this._event=this._events||{},e=d[a];if(b(e))if("function"!=typeof c)d[a]=null;else{var f=e.indexOf(c);f!==-1&&e.splice(f,1),0===e.length&&(d[a]=null)}return this},a.prototype.removeEventListener=a.prototype.off,a.prototype.fire=function(a){if("string"!=typeof a)throw new TypeError("Event name must be string");var c=this._event=this._events||{},d=c[a];if(b(d))for(var e=Array.prototype.slice.call(arguments,1),f=0,g=d.length;f<g;f++)d[f].apply(this,e);return this},a.prototype.trigger=a.prototype.distpatch=a.prototype.fire,a.prototype.once=function(a,b){var c=this,d=function d(){b.apply(c,Array.prototype.slice.call(arguments,0)),c.off(a,d)};return d.handler=b,this.on(a,d)},a.prototype.addOneTimeEventListener=a.prototype.once,a.prototype.hasListener=function(a,c){if(!a||!c)return!1;var d=this._events=this._events||{},e=d[a];if(b(e))for(var f,g=0,h=e.length;g<h;g++)if(f=e[g],f===c||f.handler===c)return!0;return!1},a.prototype.getListeners=function(a){var b=this._events=this._events||{};return b[a]},a.mixin=function(b){for(var c="function"==typeof b?b.prototype:b,d=["addEventListener","removeEventListener","addOneTimeEventListener","dispatch","on","off","once","fire","trigger"],e=0,f=d.length;e<f;e++){var g=d[e];c[g]=a.prototype[g]}return b},Ogma.utils.EventTarget=a}(),function(){var Ogma=$global.Ogma;Ogma.algorithms=Object.create(null)}(),function(){var Ogma=$global.Ogma;Ogma.algorithms.removeRadialOverlap=function(a){var b=a.X,c=a.Y,d=a.sizes,e=a.indexes,f=a.R,g=a.center,h=a.gap,i=void 0===h?0:h,j=a.epsilon,k=void 0===j?.001:j,l=a.maxLoops,m=void 0===l?5:l,n=a.inPlace,o=void 0===n||n,p=e.length,q=p,r=g[0],s=g[1];o||(b=b.slice(),c=c.slice());for(var t=Ogma.geometry.circleCircleIntersection,u=Ogma.geometry.circleSortCompare,v=Ogma.geometry.distance,w=e.slice().sort(function(a,d){return u(b[a],c[a],b[d],c[d],r,s)}),x=w[p-1],y=b[x],z=c[x],A=0,B=!1;A<q-1;A++){var C=A%p,D=(A+1)%p;A===-1&&(C=p-1,D=0),C=w[C],D=w[D];var E=b[C],F=c[C],G=b[D],H=c[D],I=d[C],J=d[D],K=I+J+i,L=u(E,F,G,H,r,s);if(L===-1&&B&&(L=1),!(K>f)){if(1===L||K-v(E,F,G,H)>k){var M=t(r,s,f,E,F,K);M&&(M=M[0],B=G>r&&M[0]<r,G=b[D]=M[0],H=c[D]=M[1])}else B=!1;if(A%p===p-2){var N=w[p-1],O=w[0];if(c[N]>s&&c[O]>s&&b[N]-d[N]<b[O]+d[N]){var P=0;for(q=Math.min(p*m,q+p);c[w[N]]>s&&c[w[0]]>s&&b[w[N]]<b[w[0]]&&++P<p;)w.unshift(w.pop())}}}}var E=y-r,F=z-s,G=b[x]-r,H=c[x]-s,Q=E===G?0:Math.abs(Math.acos((E*G+F*H)/(Math.sqrt(E*E+F*F)*Math.sqrt(G*G+H*H))));if(0!==Q)for(var P,R,S,T=Math.sin(-Q),U=Math.cos(-Q),A=0;A<p;A++)S=w[A],P=b[S]-r,R=c[S]-s,b[S]=P*U-R*T+r,c[S]=P*T+R*U+s;return{X:b,Y:c}}}(),function(){var Ogma=$global.Ogma;Ogma.algorithms.johnson=function(a){var b,c,d,e,f,g,h=a.sources,i=a.targets,j=a.weights,k=a.indexes,l=a.adjacency,m=a.undirected,n=a.ignoreWeights,o=Number.POSITIVE_INFINITY,p=k?k.length:l.length;if(!k)for(b=0,k=new Uint32Array(p);b<p;b++)k[b]=b;var q=new Array(p),r={};for(b=0;b<p;b++){for(q[b]=new Float32Array(p),d=0;d<p;d++)q[b][d]=b===d?0:o;r[k[b]]=b}var s=p,t=j.length;for(h=h.slice(),i=i.slice(),j=j.slice(),b=0;b<p;b++)h[t+b]=s,i[t+b]=k[b],j[t+b]=0,n&&(j[b]=1);var u=Ogma.algorithms.bellmanFord({sources:h,targets:i,weights:j,undirected:m,N:p+1,source:s});if(null===u)throw new Error("Graph has negative weight loops");for(e=u.distances,b=0,c=j.length;b<c;b++)f=r[h[b]],g=r[i[b]],void 0!==f&&void 0!==g&&(j[b]=j[b]+e[f]-e[g]);for(h=h.slice(0,t),i=i.slice(0,t),j=j.slice(0,t),b=0;b<p;b++){var v=k[b];for(f=r[v],e=Ogma.algorithms.dijkstra(l,v,void 0,k,r,n).distances,d=0;d<p;d++)q[b][d]=b===d?0:e[d]}return q}}(),function(){var Ogma=$global.Ogma;Ogma.algorithms.minDisk=function(a,b,c,d){function e(a){for(var b=a.length-1;b>=0;b--){var c=Math.floor(Math.random()*(b+1));c=Math.max(Math.min(c,b),0);var d=a[b];a[b]=a[c],a[c]=d}return a}function f(a,b,c,d,e,f,g){var h,i,j,k=null,l=b.length;return 1===l?(h=b[0],k=[c[h],d[h],e[h]||0]):2===l?(h=b[0],i=b[1],k=f(c[h],d[h],c[i],d[i],e[h],e[i])):3===l&&(h=b[0],i=b[1],j=b[2],k=g(c[h],d[h],c[i],d[i],c[j],d[j],e[h],e[i],e[j])),k}function g(a,b,c,d,e,h,i,j,k){var l=null;if(0===c||3===b.length)l=f(a,b,d,e,h,j,k);else{var m=a[c-1];l=g(a,b,c-1,d,e,h,i,j,k),null!==l&&i(l,d[m],e[m],h[m])||(b.push(m),l=g(a,b,c-1,d,e,h,i,j,k),b.pop())}return l}function h(a,b,c,d){var e=a-c,f=b-d;return[(a+c)/2,(b+d)/2,Math.sqrt(e*e+f*f)/2]}function i(a,b,c,d,e,f){var g=c-a,h=d-b,i=f-e,j=Math.sqrt(g*g+h*h);return[(a+c+g/j*i)/2,(b+d+h/j*i)/2,(j+e+f)/2]}function j(a,b,c,d,e,f,g,h,i){var j=2*(a-c),k=2*(b-d),l=2*(h-g),m=a*a+b*b-g*g-c*c-d*d+h*h,n=2*(a-e),o=2*(b-f),p=2*(i-g),q=a*a+b*b-g*g-e*e-f*f+i*i,r=n*k-j*o,s=(k*q-o*m)/r-a,t=(o*l-k*p)/r,u=(n*m-j*q)/r-b,v=(j*p-n*l)/r,w=t*t+v*v-1,x=2*(s*t+u*v+g),y=s*s+u*u-g*g,z=(-x-Math.sqrt(x*x-4*w*y))/(2*w);return[s+t*z+a,u+v*z+b,z]}function k(a,b,c,d,e,f){var g=2*(a*(d-f)+c*(f-b)+e*(b-d));if(0===g)return null;var h=((a*a+b*b)*(d-f)+(c*c+d*d)*(f-b)+(e*e+f*f)*(b-d))/g,i=((a*a+b*b)*(e-c)+(c*c+d*d)*(a-e)+(e*e+f*f)*(c-a))/g,j=h-a,k=i-b;return[h,i,Math.sqrt(j*j+k*k)]}if(!d){d=new Uint32Array(a.length);for(var l=0,m=a.length;l<m;l++)d[l]=l}d=e(d);var n=c?i:h,o=c?j:k,p=c?Ogma.utils.circleContainsCircle:Ogma.utils.circleContainsPoint;return c=c||[],g(d,[],d.length,a,b,c,p,n,o)}}(),function(){var Ogma=$global.Ogma;Ogma.algorithms.minHeap=function(){function a(a){for(;;){var g=2*a+1,h=g+1,i=a;if(g<f&&b(c[g],c[i])<0&&(i=g),h<f&&b(c[h],c[i])<0&&(i=h),i===a)return a;var j=c[i];c[i]=c[a],c[a]=j,d[e(c[i])]=i,d[e(j)]=a,a=i}}var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(a,b){return a-b},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(a){return a},f=c.length,g={heapify:a,pop:function(){if(!(f<=0)){if(1===f)return f--,c[0];var b=c[0];return c[0]=c[f-1],f--,a(0),b}},decreaseKey:function(a,f){for(void 0!==f&&(c[a]=f,d[e(f)]=a);a>0;){var g=a-1>>1;if(!(b(c[g],c[a])>0))break;var h=c[a];c[a]=c[g],c[g]=h,d[e(c[a])]=a,d[e(h)]=g,a=g}return a},min:function(){return c[0]},remove:function(a){return this.decreaseKey(a,Number.NEGATIVE_INFINITY),this.pop()},push:function(a){f++;var g=f-1;for(c[g]=a;g>0;){var h=g-1>>1;if(!(b(c[h],c[g])>0))break;var i=c[g];c[g]=c[h],c[h]=i,d[e(c[g])]=g,d[e(i)]=h,g=h}return g},empty:function(){return f<=0},toArray:function(){return c.slice(0,f)}};return Object.defineProperty(g,"keys",{get:function(){return d},enumerable:!0}),Object.defineProperty(g,"size",{get:function(){return f},enumerable:!0}),g}}(),function(){var Ogma=$global.Ogma;Ogma.algorithms.dijkstra=function(a,b,c,d,e,f,g){var h,i,j=d?d.length:a.length,k=new Float32Array(j),l=new Int32Array(j),m=new Uint32Array(j),n=Number.POSITIVE_INFINITY,o=new Uint32Array(j);if(0===j)return{distances:k,path:null,pathLength:null};if(!d)for(h=0,d=new Uint32Array(j);h<j;h++)d[h]=h;if(!e)for(h=0,e={};h<j;h++)e[d[h]]=h;for(h=0;h<j;h++)k[h]=n,l[h]=-1,m[h]=o[h]=h;var p=Ogma.algorithms.minHeap(function(a,b){return k[a]-k[b]},m,o);for(k[e[b]]=0,p.decreaseKey(o[e[b]]);0!==p.size;){var q=p.pop(),r=k[q],s=a[d[q]];if(r===n)break;for(h=0,i=s.nodes.length;h<i;h++){var t=s.nodes[h],u=f?1:g?g(q,t):s.weights[h],v=e[t];if(void 0!==v){var w=r+u;w<k[v]&&(k[v]=w,l[v]=q,p.decreaseKey(o[v]))}}}var x=null,y=null;if(void 0!==c){var z=e[c];if(k[z]!==n){for(h=z,x=[];h!==-1;h=l[h])x.push(d[h]);x=x.reverse(),y=k[c]}}return{distances:k,path:x,pathLength:y}}}(),function(){var Ogma=$global.Ogma;Ogma.algorithms.circlePack=function(a){function b(a,b){var g,h,i,k,l,m,p=0;for(g=0;g<t-1;g++)for(h=g+1;h<t;h++)if(g!==h){i=u[g],k=u[h];var q=c[i],r=d[i],v=e[i],w=c[k],x=d[k],y=e[k],z=w-q,C=x-r,D=v+y+j,E=z*z+C*C;if(E<D*D-a){var F=(D-Math.sqrt(E))*b,G=1/E,H=z*G*F,I=C*G*F;m=H*H+I*I,k!==o&&(l=v/B,p+=m*l,c[k]+=H*l,d[k]+=I*l),i!==o&&(l=y/B,p+=m*l,c[i]-=H*l,d[i]-=I*l)}}var J,K,L=a*n*(1-b),M=f[0],N=f[1];for(g=0;g<t;g++)if(i=u[g],i!==o){J=c[i],K=d[i],D=e[i],l=D/A;var O=s?L*l:L;H=(J-M)*O,I=(K-N)*O,m=H*H+I*I,p+=m,c[i]-=H,d[i]-=I}return p}var c=a.X,d=a.Y,e=a.R,f=a.center,g=a.maxSteps,h=void 0===g?1e3:g,i=a.padding,j=void 0===i?5:i,k=a.epsilon,l=void 0===k?1e-5:k,m=a.damping,n=void 0===m?2:m,o=a.pinned,p=a.indexes,q=a.onUpdate,r=a.pushSmallerOut,s=void 0===r||r,t=p?p.length:c.length,u=p,v=void 0;if(isFinite(o)||(o=-1),void 0===u)for(u=new Uint32Array(t),v=0;v<t;v++)u[v]=v;else u=p.slice();if(o!==-1)f=[c[o],d[o]];else if(!f){var w=0,x=0;for(v=0;v<t;v++)w+=c[u[v]],x+=d[u[v]];f=[w/t,x/t]}var y=function(a){return--a*a*a+1},z=function(a,b){var c=a-f[0],d=b-f[1];return c*c+d*d},A=-(1/0),B=1/0;u.sort(function(a,b){var f=e[a],g=e[b];return A=Math.max(A,f,g),B=Math.min(B,f,g),g*z(c[b],d[b])-f*z(c[a],d[a])});var C=0,D=0,E=y(1/t);for(v=0;v<h&&(C=b(E,y((v+1)/h)),q&&setTimeout(function(){return q(c,d)}),!(Math.abs(C-D)<l));v++)D=C;return{X:c,Y:d}}}(),function(){var Ogma=$global.Ogma;Ogma.algorithms.bellmanFord=function(a){var b=a.sources,c=a.targets,d=a.weights,e=a.source,f=a.target,g=a.undirected,h=void 0!==g&&g,i=a.indexes,j=a.N;if(j=i?i.length:j,!isFinite(j)||0===j)throw new Error("Invalid number of nodes "+j);var k,l,m,n,o,p,q,r,s,t,u,v=new Float32Array(j),w=new Int32Array(j),x={},y=Number.POSITIVE_INFINITY;if(!d)for(d=new Uint8Array(j),k=0;k<j;k++)d[k]=1;if(!i)for(k=0,i=new Uint32Array(j);k<j;k++)i[k]=k;for(k=0;k<j;k++)v[k]=y,w[k]=-1,x[i[k]]=k;for(v[x[e]]=0,k=1,l=j;k<=l;k++){for(u=!1,m=0,n=d.length;m<n;m++)r=b[m],s=c[m],p=x[r],q=x[s],void 0!==p&&void 0!==q&&(t=d[m],o=v[p]+t,v[p]!==y&&o<v[q]&&(v[q]=o,w[q]=r,u=!0),h&&(o=v[q]+t,v[q]!==y&&o<v[p]&&(v[p]=o,w[p]=s,u=!0)));if(!u)break}if(u)for(k=0,l=d.length;k<l;k++)if(r=b[k],s=c[k],p=x[r],q=x[s],void 0!==p&&void 0!==q&&(t=d[k],v[p]+t<v[q]))return null;var z=null,A=null;if(void 0!==f){var B=x[f];if(void 0!==B&&v[B]!==y){for(k=f,z=[];k!==-1;k=w[x[k]])z.push(k);z=z.reverse(),A=v[B]}}return{distances:v,path:z,pathLength:A}}}(),function(){var Ogma=$global.Ogma;Ogma.algorithms.weightedStress=function(a,b,c,d,e,f){var g,h,i,j,k,l,m=0;for(i=0;i<d;i++)for(j=0;j<d;j++){var n=f[i],o=f[j];n!==o&&(h=a[n][o],h*=e,g=1/(h*h),g&&(k=b[n]-b[o],l=c[n]-c[o],m+=g*Math.pow(h-Math.sqrt(k*k+l*l),2)))}return m},Ogma.algorithms.distanceStress=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=0;if(e===-1)return 0;for(h=0;h<d;h++)for(i=0;i<d;i++){var o=g[h],p=g[i];o===p||o!==e&&p!==e||(j=a[o][p],j*=f,k=1/(j*j),k&&(l=b[o]-b[p],m=c[o]-c[p],n+=k*Math.pow(j-Math.sqrt(l*l+m*m),2)))}return n},Ogma.algorithms.constrainedStress=function(a,b,c,d,e,f,g,h){g=g||0;var i,j,k,l,m,n,o,p=0,q=0;for(i=0;i<d;i++)for(j=0;j<d;j++){var r=h[i],s=h[j];r!==s&&(k=a[r][s],k*=f,l=1/(k*k),l&&(m=b[r]-b[s],n=c[r]-c[s],o=l*Math.pow(k-Math.sqrt(m*m+n*n),2),p+=o,r!==e&&s!==e||(q+=o)))}return(1-g)*p+g*q},Ogma.algorithms.stressMinimizationStep=function(a,b,c,d,e,f,g,h,i){var j=b,k=c,l=1e-6;g=g||0,e="undefined"==typeof e?-1:e,e===-1&&(g=0);for(var m,n,o,p,q,r=b[e],s=c[e],t=0;t<d;t++){var u=h[t],v=i(a[e][t]),w=g/(v*v);if(0!==v){var x,y=0,z=0,A=0,B=b[u],C=c[u];for(x=0;x<d;x++){var D,E,F,G,H,I=h[x];I!==u&&(D=a[u][I]*f,E=1/(D*D),F=b[I],G=c[I],0!==E&&(n=B-F,o=C-G,p=n*n+o*o,H=p<l?0:1/Math.sqrt(p),z+=(1-g)*E*(F+D*(B-F)*H),A+=(1-g)*E*(G+D*(C-G)*H)),y+=E)}m=(1-g)*y+w,0!==m&&(n=B-r,o=C-s,p=n*n+o*o,p=p<l?0:1/Math.sqrt(p),q=0===v?0:w*(v*p),j[u]=(z+q*b[u])/m,k[u]=(A+q*c[u])/m)}}return{X:j,Y:k}},Ogma.algorithms.stressMinimizationStepGeneral=function(a,b,c,d,e,f,g,h){var i=b,j=c,k=1e-6;g=g||0,e="undefined"==typeof e?-1:e,e===-1&&(g=0);for(var l,m=0;m<d;m++){var n,o,p,q,r,s=h[m],t=0,u=0,v=0,w=b[s],x=c[s];for(n=0;n<d;n++){var o,y,z,A,B,C,D=h[n],E=0;D!==s&&(o=a[s][D]*f,y=1/(o*o),s!==e&&D!==e||(E=y),C=(1-g)*y+g*E,t+=C,0!==y&&(z=b[D],A=c[D],p=w-z,q=x-A,r=p*p+q*q,r>k&&(B=1/Math.sqrt(r)),u+=C*(z+o*(w-z)*B),v+=C*(A+o*(x-A)*B)))}l=t,0!==l&&(i[s]=u/l,j[s]=v/l)}return{X:i,Y:j}}}(),function(a){var Ogma=$global.Ogma;Ogma.exports={},Ogma.exports.utils={},Ogma.exports.utils.fitZoomAndExport=function(a,b,c,d){d=d||{};var e,f,g,h=a.render,i=a.images,j=a.texts,k=h.screen.width,l=h.screen.height,m=b.margin||10,n=!1,o=!1;b.texts===!1&&(j.isNodeTextDrawingEnabled()&&(n=!0,j.setNodeTextDrawing(!1)),j.isEdgeTextDrawingEnabled()&&(o=!0,j.setEdgeTextDrawing(!1))),d.hideImages&&i.enableImages(!1),b.width&&b.height?(e=b.width,f=b.height):b.size?(e=b.size,f=b.size):b.zoomRatio?(e=k*b.zoomRatio,f=l*b.zoomRatio):(e=k,f=l);var p,q=a.camera,r=a.locate,s=q.saveConfig(),t=r.nodesBoundingBox();p=b.clip?Math.min(e/(e+m),f/(f+m))*q.zoom:Math.min(e/(t.width+m),f/(t.height+m)),q.setZoom(p),b.clip||q.setCenter(t.cx,t.cy),q.move((k-e)/(2*p),(l-f)/(2*p));var u=q.saveConfig();return g=h.export(Ogma.renderers[c],e,f,b.background),q.loadConfig(s),n&&j.setNodeTextDrawing(!0),o&&j.setEdgeTextDrawing(!0),d.hideImages&&i.enableImages(!0),{renderer:g,camera:u}}}.call(),function(a){var Ogma=$global.Ogma;Ogma.exports.csv=function(b,c,d){function e(a){return a=Ogma.utils.convertToString(a),d.textSeparator?d.textSeparator+a.replace(f,"\\"+d.textSeparator)+d.textSeparator:a}d.separator=d.separator||",",d.textSeparator=d.textSeparator===a?'"':d.textSeparator;var f=new RegExp(d.textSeparator,"g");if(d.textSeparator&&'"'!==d.textSeparator&&"'"!==d.textSeparator)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+d.textSeparator);var g,h,i,j,k,l,m=b.graph,n=[],o={},p=[],q=0,r=d.categoriesName||"categories";if(!d.what)throw new TypeError('Missing argument: "what".');if("nodes"===d.what)k=d.which?function(a){d.which.forEach(function(b){a(m.getNode(b))})}:function(a){m.nodes.forEach(a)};else{if("edges"!==d.what)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+d.what);k=d.which?function(a){d.which.forEach(function(b){a(m.getEdge(b))})}:function(a){m.edges.forEach(a)}}o.id=q++,p.push(e("id")),"edges"===d.what&&(o.source=q++,p.push(e("source")),o.target=q++,p.push(e("target"))),l=d.categories&&d.categories.length,l&&(o.categories=q++,p.push(e(r))),k(function(a){i=a,g=Ogma.utils.strToObjectRef(i,d.attributes||"data")||{},Object.keys(g).forEach(function(a){a in o||(o[a]=q++,p.push(e(a)))})}),n.push(p),k(function(a){i=a,j=[],j.length=q,j[0]=e(i.id),"edges"===d.what&&(j[1]=e(i.source),j[2]=e(i.target)),l&&(h=Ogma.utils.strToObjectRef(i,d.categories),Array.isArray(h)&&(h=h.join(d.separator)),j[o.categories]=e(h)),g=Ogma.utils.strToObjectRef(i,d.attributes||"data")||{},Object.keys(g).forEach(function(a){j[o[a]]=e(g[a])}),n.push(j)});var s=n.map(function(a){return a.join(d.separator)}).join("\n");c(s)}}.call(),function(a){function b(a,b,h,i){var j=Ogma.exports.utils.fitZoomAndExport(a,h,"canvas",{}),k=j.renderer,l=j.camera,m=a.geo.isEnabled()&&$or(h.map,!0),n=null,o=function(){try{n=k.canvas.toDataURL("image/"+i)}catch(b){k=Ogma.exports.utils.fitZoomAndExport(a,h,"canvas",{hideImages:!0}).renderer,g(k.canvas,h.textWatermark,c,d),n=k.canvas.toDataURL("image/"+i),console.warn(b.message)}if(m){var e=k.canvas,f=e.width,j=e.height,o=Ogma.utils.pixelRatio(),p=Ogma.utils.createCanvas(f/o,j/o),q=p.getContext("2d");try{a.geo.exportBackground(p,function(){q.drawImage(e,0,0,f,j),b(p.toDataURL("image/"+i),"dataURL")},l)}catch(a){q.clearRect(0,0,f,j),q.drawImage(e,0,0),b(p.toDataURL("image/"+i),"dataURL")}}else b(n,"dataURL")};g(k.canvas,h.textWatermark,c,d),h.imageWatermark?Ogma.utils.getImage(h.imageWatermark.content,function(a){a&&(h.imageWatermark.content=a,g(k.canvas,h.imageWatermark,f,e)),o()}):o()}function c(a,b,c,d){a.textAlign="center",a.textBaseline="middle",a.fillText(b,c,d)}function d(a,b,c){return{width:a.measureText(b).width,
height:c}}function e(b,c,d,e,f){return{width:e===a?c.width:e,height:f===a?c.height:f}}function f(a,b,c,d,e,f){a.drawImage(b,c-e/2,d-f/2,e,f)}function g(b,c,d,e){if(c){if("object"!==("undefined"==typeof c?"undefined":_typeof(c)))c={content:c};else if(!c.content)return;var f=b.getContext("2d"),g=b.width,h=b.height,i=c.fontFamily||"Arial",j=c.fontSize||48,k=c.fontStyle,l=c.fontColor||"red",m=c.repeat!==a&&c.repeat,n=c.angle===a?0:c.angle,o=c.alpha===a?.65:c.alpha,p=c.space===a?50:c.space,q=c.x===a?g/2:c.x,r=c.y===a?h/2:c.y,s=c.height,t=c.width,u=c.content;n=n/180*Math.PI,k?f.font=k+" "+j+"px "+i:f.font=j+"px "+i,f.fillStyle=l,f.globalAlpha=o;var v=e(f,u,j,t,s);if(m){var w=v.width+p,x=v.height+p,y=Math.sqrt(g*g+h*h);f.save(),f.translate(0,0),f.rotate(n);for(var z=0;z<y;z+=w)for(var A=0;A<y;A+=x)d(f,u,z,A,v.width,v.height),0!==A&&d(f,u,z,-A,v.width,v.height);f.restore()}else f.save(),f.translate(q,r),f.rotate(n),d(f,u,0,0,v.width,v.height),f.restore()}}var Ogma=$global.Ogma;Ogma.exports.png=function(a,c,d){return b(a,c,d,"png")},Ogma.exports.jpg=function(a,c,d){return b(a,c,d,"jpeg")},Ogma.exports.tiff=function(a,c,d){return b(a,c,d,"tiff")},Ogma.exports.gif=function(a,c,d){return b(a,c,d,"gif")}}.call(),function(a){var Ogma=$global.Ogma;Ogma.exports.svg=function(a,b,c){var d=Ogma.exports.utils.fitZoomAndExport(a,c,"svg",{}).renderer.svg;d.setAttribute("version","1.1"),d.setAttribute("xmlns","http://www.w3.org/2000/svg"),d.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),b('<?xml version="1.0" encoding="utf-8"?>'+Ogma.utils.serializeXMLDocument(d))}}.call(),function(a){function b(a,b){return"integer"===b&&"number"==typeof a?Ogma.utils.isInteger(a)||(b="float"):"number"!=typeof a&&(b="string","boolean"==typeof a&&(b="boolean")),b}var Ogma=$global.Ogma;Ogma.exports.gexf=function(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=Ogma.utils.createXmlDocument(),z="",A=a.graph,B={},C=0,D={},E=0;u=y.createElement("gexf"),u.setAttribute("xmlns","http://www.gexf.net/1.2draft"),u.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),u.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),u.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),u.setAttribute("version","1.2"),r=y.createElement("meta"),r.setAttribute("lastmodifieddate",Ogma.utils.getDate()),d.creator&&(m=y.createElement("creator"),x=y.createTextNode(""+d.creator),m.appendChild(x),r.appendChild(m)),d.description&&(n=y.createElement("description"),x=y.createTextNode(""+d.description),n.appendChild(x),r.appendChild(n)),q=y.createElement("graph"),q.setAttribute("mode","static"),s=y.createElement("nodes"),A.forEachNode(function(a){if(e=a,t=y.createElement("node"),t.setAttribute("id",e.id),e.text&&t.setAttribute("label",e.text),f=Ogma.utils.strToObjectRef(e,d.nodeAttributes||"data"),f&&(h=y.createElement("attvalues"),Object.keys(f).forEach(function(a){a in B||(B[a]={id:C,type:"integer"},C++);var c=f[a];B[a].type=b(c,B[a].type),i=y.createElement("attvalue"),i.setAttribute("for",B[a].id),i.setAttribute("value",c),h.appendChild(i)}),t.appendChild(h)),e.color){var c=Ogma.colors.toRgb(e.color);c.length>2&&(l=y.createElement("viz:color"),l.setAttribute("r",c[0]),l.setAttribute("g",c[1]),l.setAttribute("b",c[2]),c.length>3&&(5===c.length?l.setAttribute("a",c[3]+"."+c[4]):l.setAttribute("a",c[3])),t.appendChild(l))}v=y.createElement("viz:position"),v.setAttribute("x",e.x),v.setAttribute("y",-parseInt(e.y,10)),t.appendChild(v),e.size&&(w=y.createElement("viz:size"),w.setAttribute("value",e.size),t.appendChild(w)),s.appendChild(t)}),j=y.createElement("attributes"),j.setAttribute("class","node"),Object.keys(B).forEach(function(a){g=y.createElement("attribute"),g.setAttribute("id",B[a].id),g.setAttribute("title",a),g.setAttribute("type",B[a].type),j.appendChild(g)}),o=y.createElement("edges"),A.forEachEdge(function(a){if(e=a,p=y.createElement("edge"),p.setAttribute("id",e.id),p.setAttribute("source",e.source),p.setAttribute("target",e.target),e.size&&p.setAttribute("weight",e.size),e.text&&p.setAttribute("label",e.text),f=Ogma.utils.strToObjectRef(e,d.edgeAttributes||"data"),f&&(h=y.createElement("attvalues"),Object.keys(f).forEach(function(a){a in D||(D[a]={id:E,type:"integer"},E++);var c=f[a];D[a].type=b(c,D[a].type),i=y.createElement("attvalue"),i.setAttribute("for",D[a].id),i.setAttribute("value",c),h.appendChild(i)}),p.appendChild(h)),e.color){var c=Ogma.colors.toRgb(e.color);c.length>2&&c.length<=5&&(l=y.createElement("viz:color"),l.setAttribute("r",c[0]),l.setAttribute("g",c[1]),l.setAttribute("b",c[2]),p.appendChild(l))}e.size&&(w=y.createElement("viz:size"),w.setAttribute("value",e.size),p.appendChild(w)),o.appendChild(p)}),k=y.createElement("attributes"),k.setAttribute("class","edge"),Object.keys(D).forEach(function(a){g=y.createElement("attribute"),g.setAttribute("id",D[a].id),g.setAttribute("title",a),g.setAttribute("type",D[a].type),k.appendChild(g)}),q.appendChild(j),q.appendChild(k),q.appendChild(s),q.appendChild(o),u.appendChild(r),u.appendChild(q),y.appendChild(u),z=Ogma.utils.serializeXMLDocument(y),g&&g.parentNode.removeChild(g),h&&h.parentNode.removeChild(h),i&&i.parentNode.removeChild(i),l&&l.parentNode.removeChild(l),m&&m.parentNode.removeChild(m),n&&n.parentNode.removeChild(n),x&&x.parentNode.removeChild(x),v&&v.parentNode.removeChild(v),w&&w.parentNode.removeChild(w),t&&t.parentNode.removeChild(t),p&&p.parentNode.removeChild(p),j&&j.parentNode.removeChild(j),k&&k.parentNode.removeChild(k),s&&s.parentNode.removeChild(s),o&&o.parentNode.removeChild(o),q&&q.parentNode.removeChild(q),r&&r.parentNode.removeChild(r),u&&u.parentNode.removeChild(u),y=null,c(z)}}.call(),function(a){var Ogma=$global.Ogma;Ogma.exports.json=function(a,b,c){var d=a.graph,e={nodes:[],edges:[]};d.forEachNode(function(b){var d;if(c.nodeFields){d={id:b.id};for(var f=0;f<c.nodeFields.length;++f){var g=c.nodeFields[f];d[g]=b[g]}}else d=a.graph.cloneNode(b);e.nodes.push(d)}),d.forEachEdge(function(b){var d;if(c.edgeFields){d={id:b.id,source:b.source,target:b.target};for(var f=0;f<c.edgeFields.length;++f){var g=c.edgeFields[f];d[g]=b[g]}}else d=a.graph.cloneEdge(b);e.edges.push(d)}),b(c.pretty?JSON.stringify(e,null," "):JSON.stringify(e))}}.call(),function(a){function b(a,b){for(var c={},d={s:{c:1e7,r:1e7},e:{c:0,r:0}},f=0;f!=b.length;++f)for(var g=0;g!=b[f].length;++g){d.s.r>f&&(d.s.r=f),d.s.c>g&&(d.s.c=g),d.e.r<f&&(d.e.r=f),d.e.c<g&&(d.e.c=g);var h={v:b[f][g]};if(null!=h.v){var i=a.utils.encode_cell({c:g,r:f});"number"==typeof h.v?h.t="n":"boolean"==typeof h.v?h.t="b":h.v instanceof Date?(h.t="n",h.z=a.SSF._table[14],h.v=e(h.v)):h.t="s",c[i]=h}}return d.s.c<1e7&&(c["!ref"]=a.utils.encode_range(d)),c}function c(a,b){var c,d,e,h=0,i={},j=[],k=b.nodesAttributes,l=b.nodesCategories,m=b.nodesCategoriesName||"categories",n=0,o=[];return"edges"===b.what&&(k=b.edgesAttributes,l=b.edgesCategories,m=b.edgesCategoriesName||"categories"),n=l&&l.length?1:0,i.id=h++,j.push("id"),"edges"===b.what&&(i.source=h++,j.push("source"),i.target=h++,j.push("target")),n&&(h++,j.push(m)),a(function(a){d=a,c=Ogma.utils.strToObjectRef(d,k||"data")||{},Object.keys(c).forEach(function(a){a in i||(i[a]=h++,j.push(f(a)))})}),o.push(j),a(function(a){d=a,e=[],e.length=h,e[0]=f(d.id),"edges"===b.what?(e[1]=f(d.source),e[2]=f(d.target),n&&(e[3]=g(Ogma.utils.strToObjectRef(d,l)))):n&&(e[1]=g(Ogma.utils.strToObjectRef(d,l))),c=Ogma.utils.strToObjectRef(d,k||"data")||{},Object.keys(c).forEach(function(a){e[i[a]]=f(c[a])}),o.push(e)}),o}function d(){return this instanceof d?(this.SheetNames=[],void(this.Sheets={})):new d}function e(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5}function f(b){return null===b||b===a?"":"string"==typeof b||"number"==typeof b?b:"function"==typeof b?b.toString():JSON.stringify(b)}function g(b){return null===b||b===a?"":"string"==typeof b||"number"==typeof b?b:Array.isArray(b)?b.join(","):"function"==typeof b?b.toString():JSON.stringify(b)}function h(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b}var Ogma=$global.Ogma;Ogma.exports.xlsx=function(a,e,f){var g,i,j=Ogma.require("xlsx",{variable:"XLSX"}),k=a.graph,l=new d,m=f.which?function(a){f.which.forEach(function(b){return a(k.getNode(b))})}:function(a){k.nodes.forEach(a)},n=f.which?function(a){f.which.forEach(function(b){return a(k.getEdge(b))})}:function(a){k.edges.forEach(a)};if(f.what)if("nodes"===f.what)g=b(j,c(m,f));else{if("edges"!==f.what)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+f.what);i=b(j,c(n,f))}else g=b(j,c(m,f)),i=b(j,c(n,f));g&&(l.SheetNames.push("Nodes"),l.Sheets.Nodes=g),i&&(l.SheetNames.push("Edges"),l.Sheets.Edges=i);var o=j.write(l,{bookType:"xlsx",bookSST:!1,type:"binary"}),p=Ogma.utils.createBlob([h(o)]);e(p,"blob")}}.call(),function(a){var Ogma=$global.Ogma;Ogma.exports.graphml=function(b,c,d){function e(a,b){var c=4*Ogma.colors.getIndex(b),d=Ogma.colors.rgba;a.r=Math.round(255*d[c]),a.g=Math.round(255*d[c+1]),a.b=Math.round(255*d[c+2])}function f(b,c,d,e,f){d=d||{};var g=j.createElement(c);for(var h in d)if(d.hasOwnProperty(h)){var i=d[h];i!==a&&g.setAttribute(h,i)}if(e!==a||f){"[object Object]"===Object.prototype.toString.call(e)&&(e=JSON.stringify(e));var k=j.createTextNode(e);g.appendChild(k)}return b.appendChild(g),g}function g(b,c,d){var f=Ogma.utils.strToObjectRef(b,d)||{},g={id:b.id};m.forEach(function(d){var f=b[d];"y"===d&&f&&(f=-parseFloat(f)),f!==a&&(g[("edge"===c?"edge_":"")+d]=f,"color"===d&&e(g,f))}),Ogma.utils.forEach(f,function(a,b){m.indexOf(b)===-1&&l.indexOf(b)===-1&&(n[b]?n[b].for!==c&&(n[b].for="all"):n[b]={for:c,type:"string"},g[b]=a)}),"edge"===c?(g.source=b.source,g.target=b.target,p.push(g)):o.push(g)}function h(a,b){var c=f(a,"data",{key:"nodegraphics"}),d=f(c,"y:ShapeNode");f(d,"y:Geometry",{x:b.x,y:b.y,width:b.size,height:b.size}),f(d,"y:Fill",{color:Ogma.colors.colorToHexa(b.color),transparent:!1}),f(d,"y:NodeLabel",null,b.label?b.label:""),f(d,"y:Shape",{type:b.type?b.type:"circle"})}function i(a,b){var c=f(a,"data",{key:"edgegraphics"}),d=f(c,"y:PolyLineEdge");f(d,"y:LineStyle",{type:b.edge_type?b.edge_type:"line",color:b.color?Ogma.utils.colorToHexa(b.color):"#0000ff",width:b.edge_size?b.edge_size:1}),f(d,"y:EdgeLabel",null,b.edge_label?b.edge_label:"")}var j=Ogma.utils.createXmlDocument(),k=b.graph;d=Ogma.utils.deepCopy(d),d.nodeFields=d.nodeFields||[],d.edgeFields=d.edgeFields||[];var l=["id","source","target"],m=["size","x","y","shape","color","label","fixed","hidden","active"],n={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"},pinned:{for:"node",type:"boolean"},hidden:{for:"all",type:"boolean"},active:{for:"all",type:"boolean"}},o=[],p=[];k.forEachNode(function(a){g(a,"node",d.nodeFields)}),k.forEachEdge(function(a){g(a,"edge",d.edgeFields)});var q=f(j,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});Ogma.utils.forEach(n,function(a,b){"node"!==a.for&&"all"!==a.for||f(q,"key",{"attr.name":b,"attr.type":a.type,for:"node",id:b}),"edge"!==a.for&&"all"!==a.for||f(q,"key",{"attr.name":b,"attr.type":a.type,for:"edge",id:"edge_"+b})}),f(q,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),f(q,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var r=f(q,"graph",{edgedefault:(d.directedEdges||d.directedEdges)===a?"directed":"undirected",id:d.graphId?d.graphId:"G","parse.nodes":k.nodes.size,"parse.edges":k.edges.size,"parse.order":"nodesfirst"});o.forEach(function(a){var b=f(r,"node",{id:a.id});h(b,a),Ogma.utils.forEach(a,function(a,c){l.indexOf(c)===-1&&f(b,"data",{key:c},a,!0)})}),p.forEach(function(a){var b=f(r,"edge",{id:a.id,source:a.source,target:a.target});i(b,a),Ogma.utils.forEach(a,function(a,c){l.indexOf(c)===-1&&f(b,"data",{key:c},a,!0)})}),c('<?xml version="1.0" encoding="UTF-8"?>'+Ogma.utils.serializeXMLDocument(j))}}.call(),function(a){var Ogma=$global.Ogma;Ogma.generators=Object.create(null)}.call(),function(a){var Ogma=$global.Ogma;Ogma.generators.grid={configure:function(a){if(!Ogma.utils.isInteger(a.n)||a.n<1)throw new TypeError('Invalid parameter: "n" is not a positive integer, was '+a.n);if(!Ogma.utils.isInteger(a.m)||a.m<1)throw new TypeError('Invalid parameter: "m" is not a positive integer, was '+a.m)},generate:function(a){for(var b=a.n,c=a.m,d=a.hsep||10,e=a.vsep||10,f={nodes:[],edges:[]},g=0,h=0;h<b;++h)for(var i=0;i<c;++i){var j=h*c+i;f.nodes.push({id:j,x:i*d,y:h*e,text:"Node "+j}),i!==c-1&&(f.edges.push({id:g,source:j,target:h*c+i+1,text:"Edge "+g}),g+=1),h!==b-1&&(f.edges.push({id:g,source:j,target:(h+1)*c+i,text:"Edge "+g}),g+=1)}return f}}}.call(),function(a){var Ogma=$global.Ogma;Ogma.generators.path={configure:function(a){if(!a.length||a.length<0)throw new TypeError('Invalid argument: "length" is not a positive number, was '+a.length)},generate:function(a){for(var b=a.length,c={nodes:[{id:"n0",text:"Node 0",x:100*Math.random(),y:100*Math.random()}],edges:[]},d=1;d<b;++d)c.nodes.push({id:"n"+d,text:"Node "+d,x:100*Math.random(),y:100*Math.random()}),c.edges.push({id:"e"+d,text:"Edge "+d,source:"n"+(d-1),target:"n"+d});return c}}}.call(),function(a){var Ogma=$global.Ogma;Ogma.generators.random={configure:function(a){if(!a)throw new Error("Missing argument: options");if(!Ogma.utils.isObject(a))throw new TypeError("Invalid argument: options is not an object, was "+a);if(!Ogma.utils.isNumber(a.nbNodes)||a.nbNodes<1)throw new TypeError("Invalid argument: options.nbNodes is not a positive number, was "+a.nbNodes);if(!Ogma.utils.isNumber(a.nbEdges)||a.nbEdges<1)throw new TypeError("Invalid argument: options.nbEdges is not a number, was "+a.nbEdges)},generate:function(a){var b,c=a.nbNodes,d=a.nbEdges,e=!0,f={nodes:[],edges:[]};for("undefined"!=typeof a.texts&&(e=!!a.texts),b=0;b<c;b++)f.nodes.push({id:"n"+b,text:e?"Node "+b:"",x:200*Math.random(),y:200*Math.random()});for(b=0;b<d;b++)f.edges.push({id:"e"+b,text:e?"Edge "+b:"",source:"n"+(Math.random()*c|0),target:"n"+(Math.random()*c|0)});return f}}}.call(),function(a){var Ogma=$global.Ogma;Ogma.generators.erdosRenyi={configure:function(a){if(!a)throw new Error("Missing argument: options");if(!Ogma.utils.isObject(a))throw new TypeError("Invalid argument: options is not an object, was "+a);if(!Ogma.utils.isNumber(a.nbNodes)||a.nbNodes<1)throw new TypeError("Invalid argument: options.nbNodes is not a positive number, was "+a.nbNodes);if(a.nbNodes<3)throw new TypeError("Invalid argument: options.nbNodes is smaller than 3, was "+a.nbNodes);if("nbEdges"in a&&"p"in a)throw new TypeError("Invalid argument: choose between options.nbEdges and options.p");if(a.p>=0){if(!Ogma.utils.isNumber(a.p)||a.p<0)throw new TypeError("Invalid argument: options.p is not a positive number, was "+a.p)}else if(!Ogma.utils.isNumber(a.nbEdges)||a.nbEdges<1)throw new TypeError("Invalid argument: options.nbEdges is not a positive number, was "+a.nbEdges)},generate:function(a){var b,c,d,e={nodes:[],edges:[]},f=0,g=a.nbNodes,h=a.p;if(a.p>=0)for(c=0;c<g;c++)for(e.nodes.push({id:"n"+c,text:"Node "+c,x:100*Math.random(),y:100*Math.random()}),d=0;d<c;d++)Math.random()<h&&e.edges.push({id:"e"+f++,text:"Edge "+f,source:"n"+c,target:"n"+d});else{var i=[],j=a.nbEdges;for(c=0;c<g;c++)for(e.nodes.push({id:"n"+c,text:"Node "+c,x:100*Math.random(),y:100*Math.random(),size:1}),d=c+1;d<g;d++)i.push({source:"n"+c,target:"n"+d});for(f=i.length-1,c=0;c<j;c++)b=i.splice(Math.floor(Math.random()*f),1)[0],b.id="e"+c,b.text="Edge "+c,e.edges.push(b),f--}return e}}}.call(),function(a){var Ogma=$global.Ogma;Ogma.generators.balancedTree={configure:function(a){if(!a)throw new Error("Missing argument: options");if(!Ogma.utils.isObject(a))throw new TypeError("Invalid argument: options is not an object, was "+a);if(!Ogma.utils.isNumber(a.nbChildren)||a.nbChildren<1)throw new TypeError("Invalid argument: options.nbChildren is not a positive number, was "+a.nbChildren);if(!Ogma.utils.isNumber(a.height)||a.height<1)throw new TypeError("Invalid argument: options.height is not a positive number, was "+a.height)},generate:function(a){for(var b=a.nbChildren,c=Math.pow(a.nbChildren,a.height),d=[],e=[],f=1,g=0,h=0,i=0;i<a.height;++i){for(var j=c/(f+1)/1.5,k=0;k<f;++k){var l=g++;if(d.push({id:l,text:"Node #"+l,x:(k+1)*j*10,y:20*i}),i!==a.height-1)for(var m=0;m<b;++m)e.push({id:h,text:"Edge #"+h,source:l,target:l*b+m+1}),h+=1}f*=b}return{nodes:d,edges:e}}}}.call(),function(a){var Ogma=$global.Ogma;Ogma.generators.barabasiAlbert={configure:function(a){if(!a)throw new Error("Missing argument: options");if(!Ogma.utils.isObject(a))throw new TypeError("Invalid argument: options is not an object, was "+a);if(!Ogma.utils.isNumber(a.nbNodes)||a.nbNodes<1)throw new TypeError("Invalid argument: options.nbNodes is not a positive number, was "+a.nbNodes);if(a.nbNodes<3)throw new TypeError("Invalid argument: options.nbNodes is smaller than 3, was "+a.nbNodes);if(!Ogma.utils.isNumber(a.m0)||a.m0<=0)throw new TypeError("Invalid argument: options.m0 is not a positive number, was "+a.m0);if(!Ogma.utils.isNumber(a.m)||a.m<=0)throw new TypeError("Invalid argument: options.m is not a positive number, was "+a.m);if(a.m0>=a.nbNode)throw new TypeError("Invalid argument: options.m0 is greater than options.nbNodes, was "+a.m0);if(a.m>a.m0)throw new TypeError("Invalid argument: options.m is strictly greater than options.m0, was "+a.m)},generate:function(a){var b,c,d,e,f,g,h,i,j={nodes:[],edges:[]},k={},l=[],m=0,n=a.nbNodes,o=a.m0,p=a.m;for(b=0;b<o;b++)j.nodes.push({id:"n"+b,text:"node "+b,x:Math.random(),y:Math.random()}),l[b]=0;for(b=0;b<o;b++)for(c=b+1;c<o;c++)d={id:"e"+m++,text:"Edge "+m,source:"n"+b,target:"n"+c},k[d.source+"-"+d.target]=d,j.edges.push(d),l[b]++,l[c]++;for(b=o;b<n;b++){for(j.nodes.push({id:"n"+b,text:"node "+b,x:100*Math.random(),y:100*Math.random()}),l[b]=0,e=0,c=0;c<b;c++)e+=l[c];for(f=0,g=0;g<p;g++)for(h=Math.random(),i=0,c=0;c<b;c++)if(!k[b+"-"+c]&&!k[c+"-"+b]&&(1==b?i=1:i+=l[c]/e+f/(b-g),h<=i)){f+=l[c]/e,d={id:"e"+m++,text:"Edge "+m,source:"n"+b,target:"n"+c},k[d.source+"-"+d.target]=d,j.edges.push(d),l[b]++,l[c]++;break}}return j}}}.call(),function(a){var Ogma=$global.Ogma;Ogma.geometry=Object.create(null)}.call(),function(a){function b(a,b){return a.x===b.x&&a.y===b.y}var Ogma=$global.Ogma;Ogma.geometry.lineFromPoint=function(a,b,c,d,e,f){f=f||{};var g=Ogma.geometry.distance(a,b,c,d),h=(c-a)/g,i=(d-b)/g,j=.5*e*-i,k=.5*e*h;return f.x1=a-j,f.y1=b-k,f.x2=a+j,f.y2=b+k,f},Ogma.geometry.isPointInLine=function(a,b,c,d,e,f,g){var h=Ogma.geometry.distance(c,d,e,f),i=(e-c)/h*(g/2),j=(f-d)/h*(g/2),k=c+j,l=d-i,m=c-j,n=d+i,o=e+j,p=f-i,q=a-k,r=b-l,s=m-k,t=n-l,u=o-k,v=p-l,w=q*s+r*t,x=s*s+t*t,y=q*u+r*v,z=u*u+v*v;return 0<w&&w<x&&0<y&&y<z},Ogma.geometry.distanceFromLine=function(a,b,c,d,e,f){var g=e-c,h=f-d;return Math.abs(h*a-g*b+e*d+e*f)/Math.sqrt(g*g+h*h)},Ogma.geometry.vectorToLine=function(a,b,c,d,e,f){var g,h,i=e-c,j=f-d,k=j/i,l=d-k*c;return 0===i?(g=c,h=b):(g=(i*a+j*b-l*j)/(i+k*j),h=k*g+l),{x:g-a,y:h-b}},Ogma.geometry.twoSegmentsIntersect=function(a,c,d,e,f){if(f&&(b(a,d)||b(a,e)||b(c,d)||b(c,e)))return!1;var g=(a.y-d.y)*(e.x-d.x)-(a.x-d.x)*(e.y-d.y),h=(c.x-a.x)*(e.y-d.y)-(c.y-a.y)*(e.x-d.x);if(0===h)return!1;var i=g/h;g=(a.y-d.y)*(c.x-a.x)-(a.x-d.x)*(c.y-a.y);var j=g/h;return!(i<=0||i>=1||j<=0||j>=1)},Ogma.geometry.lineAngle=function(a,b,c,d){return Math.atan2(d-b,c-a)},Ogma.geometry.orthogonal=function(a,b,c,d,e,f){f=f||{};var g=Ogma.geometry.distance(a,b,c,d),h=(c-a)/g,i=(d-b)/g;return f.x=e*-i,f.y=e*h,f},Ogma.geometry.normalize=function(a,b,c,d,e,f){f=f||{};var g=Ogma.geometry.distance(a,b,c,d);return f.x=(c-a)/g*e,f.y=(d-b)/g*e,f},Ogma.geometry.lineIntersectRectangle=function(a,b,c,d,e,f,g,h){var i=(b-d)/(a-c);if(isNaN(i))return e<a&&a<g&&f<b&&b<h;if(isFinite(i)){var j=i,k=b-a*j,l=(f-k)/j,m=(h-k)/j,n=j*e+k,o=j*g+k;return e<l&&l<g||e<m&&m<g&&f<n&&n<h||f<o&&o<h}return e<a&&a<g&&(b>f&&b<h||d>f&&d<h)}}.call(),function(a){var Ogma=$global.Ogma;Ogma.geometry.rotate=function(a,b,c,d,e,f){f=f||{};var g=Math.cos(e),h=Math.sin(e);return f.x=g*(a-c)-h*(b-d)+c,f.y=h*(a-c)+g*(b-d)+d,f},Ogma.geometry.distance=function(a,b,c,d){return Math.sqrt((a-c)*(a-c)+(b-d)*(b-d))},Ogma.geometry.squaredDistance=function(a,b,c,d){var e=a-c,f=b-d;return e*e+f*f},Ogma.geometry.squareContainsSquare=function(a,b,c,d,e,f){return a-c>=d-f&&a+c>=d+f&&b-c>=e-f&&b+c>=e+f},Ogma.geometry.slope=function(a,b){return(a.y-b.y)/(a.x-b.x)},Ogma.geometry.angle=function(a,b,c){var d=Ogma.geometry.lineAngle(a.x,a.y,b.x,b.y)-Ogma.geometry.lineAngle(c.x,c.y,b.x,b.y);return d<0&&(d+=2*Math.PI),d}}.call(),function(){var Ogma=$global.Ogma;Ogma.geometry.circleCircleIntersection=function(a,b,c,d,e,f){var g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0;return h=d-a,i=e-b,j=Math.sqrt(h*h+i*i),j>c+f?null:j<Math.abs(c-f)?null:(g=(c*c-f*f+j*j)/(2*j),n=a+h*g/j,o=b+i*g/j,k=Math.sqrt(c*c-g*g),l=-i*(k/j),m=h*(k/j),[[n+l,o+m],[n-l,o-m]])},Ogma.geometry.circleSortCompare=function(a,b,c,d,e,f){if(a-e>=0&&c-e<0)return 1;if(a-e<0&&c-e>=0)return-1;if(a-e===0&&c-e===0)return b-d>=0||d-f>=0?b-d:d-b;var g=(a-e)*(d-f)-(c-e)*(b-f);if(g<0)return 1;if(g>0)return-1;var h=(a-e)*(a-e)+(b-f)*(b-f),i=(c-e)*(c-e)+(d-f)*(d-f);return h-i},Ogma.utils.circleContainsPoint=function(a,b,c){var d=a[0]-b,e=a[1]-c;return Math.sqrt(d*d+e*e)<a[2]+1e-12},Ogma.utils.circleContainsCircle=function(a,b,c,d){var e=a[0]-b,f=a[1]-c,g=a[2]-d;return e*e+f*f<g*g+1e-6}}(),function(a){var Ogma=$global.Ogma,b=Ogma.geometry.distance;Ogma.geometry.getQuadraticControlPoints=function(a,b,c,d,e,f,g){return g=g||{},g.x=(a+c)/e+(d-b)/f,g.y=(b+d)/e+(a-c)/f,g},Ogma.geometry.getPointOnQuadraticCurve=function(a,b,c,d,e,f,g,h){return h=h||{},h.x=(1-a)*(1-a)*b+2*(1-a)*a*f+a*a*d,h.y=(1-a)*(1-a)*c+2*(1-a)*a*g+a*a*e,h},Ogma.geometry.isPointOnQuadraticCurve=function(a,c,e,f,g,h,i,j,k){var l=b(e,f,g,h);if(Math.abs(a-e)>l||Math.abs(c-f)>l)return!1;var m=b(a,c,e,f),n=b(a,c,g,h),o=.5,p=m<n?-.01:.01,q=.001,r=100;Ogma.geometry.getPointOnQuadraticCurve(o,e,f,g,h,i,j,d);for(var s,t=b(a,c,d.x,d.y);r-- >0&&o>=0&&o<=1&&t>k&&(p>q||p<-q);)s=t,Ogma.geometry.getPointOnQuadraticCurve(o,e,f,g,h,i,j,d),t=b(a,c,d.x,d.y),t>s?(p=-p/2,o+=p):o+p<0||o+p>1?(p/=2,t=s):o+=p;return t<k};var c=7;Ogma.geometry.SELF_LOOP_SIZE_MULTIPLIER=c,Ogma.geometry.getSelfLoopControlPoints=function(a,b,d,e){return e=e||{},e.x1=a-d*c,e.y1=b,e.x2=a,e.y2=b+d*c,e},Ogma.geometry.getPointOnBezierCurve=function(a,b,c,d,e,f,g,h,i,j){j=j||{};var k=(1-a)*(1-a)*(1-a),l=3*a*(1-a)*(1-a),m=3*a*a*(1-a),n=a*a*a;return j.x=k*b+l*f+m*h+n*d,j.y=k*c+l*g+m*i+n*e,j};var d={};Ogma.geometry.isPointOnBezierCurve=function(a,b,c,d,e,f,g,h,i,j,k){var l=Ogma.geometry.distance(c,d,g,h);if(Math.abs(a-c)>l||Math.abs(b-d)>l)return!1;for(var m,n=Ogma.geometry.distance(a,b,c,d),o=Ogma.geometry.distance(a,b,e,f),p=.5,q=n<o?-.01:.01,r=.001,s=100,t=Ogma.geometry.getPointOnBezierCurve(p,c,d,e,f,g,h,i,j),u=Ogma.geometry.distance(a,b,t.x,t.y);s-- >0&&p>=0&&p<=1&&u>k&&(q>r||q<-r);)m=u,Ogma.geometry.getPointOnBezierCurve(p,c,d,e,f,g,h,i,j,t),u=Ogma.geometry.distance(a,b,t.x,t.y),u>m?(q=-q/2,p+=q):p+q<0||p+q>1?(q/=2,u=m):p+=q;return u<k},Ogma.geometry.quadraticCurveLength=function(a,b,c,d,e,f){var g=Math.sqrt,h=Math.log,i=a-2*c+e,j=b-2*d+f,k=2*c-2*a,l=2*d-2*b,m=4*(i*i+j*j),n=4*(i*k+j*l),o=k*k+l*l,p=2*g(m+n+o),q=g(m),r=2*m*q,s=2*g(o),t=n/q;return(r*p+q*n*(p-s)+(4*o*m-n*n)*h((2*q+t+p)/(t+s)))/(4*r)};var e=100,f=1/e,g={};Ogma.geometry.cubicCurveLength=function(a,b,c,d,e,h,i,j){for(var k=0,l=a,m=b,n=f;n<=1;n+=f)Ogma.geometry.getPointOnBezierCurve(n,a,b,i,j,c,d,e,h,g),k+=Ogma.geometry.distance(l,m,g.x,g.y),l=g.x,m=g.y;return k}}.call(),function(a){var Ogma=$global.Ogma;Ogma.geometry.unitVector=function(a,b,c,d,e,f){f=f||{};var g=Ogma.geometry.distance(a,b,c,d);if(0===g)f.x=e,f.y=0;else{var h=e/Ogma.geometry.distance(a,b,c,d);f.x=(c-a)*h,f.y=(d-b)*h}return f},Ogma.geometry.dotProduct=function(a,b,c,d){return a*c+b*d},Ogma.geometry.crossProduct=function(a,b,c,d){return a*d-c*b}}.call(),function(a){function b(a,b,c,d,e,f){return.5*(-d*e+b*(-c+e)+a*(d-f)+c*f)}function c(a,b){return a<0?a+=b:a>=b&&(a-=b),a}function d(a){for(var b=0;b<a.length;++b)if(e(a,b))return b;return 0}function e(a,b){var d=c(b-1,a.length),e=c(b+1,a.length),f=Ogma.geometry.angle(a[d],a[b],a[e]);if(f>Math.PI)return!1;for(var g=0;g<a.length;++g)if(g!==b&&g!==d&&g!==e&&Ogma.geometry.isPointInTriangle(a[g].x,a[g].y,a[d].x,a[d].y,a[e].x,a[e].y,a[b].x,a[b].y))return!1;return!0}function f(a){if(3===a.length)return[[a[0].index,a[1].index,a[2].index]];var b=d(a),e=[a[c(b-1,a.length)].index,a[b].index,a[c(b+1,a.length)].index];a.splice(b,1);var g=f(a);return g.push(e),g}var Ogma=$global.Ogma,g=Ogma.geometry.distance;Ogma.geometry.isPointInTriangle=function(a,c,d,e,f,g,h,i){var j=b(d,e,f,g,h,i),k=1/(2*j)*(e*h-d*i+(i-e)*a+(d-h)*c),l=1/(2*j)*(d*g-e*f+(e-g)*a+(f-d)*c);return k>0&&l>0&&1-k-l>0},Ogma.geometry.incenter=function(a,b,c,d,e,f){var h=g(c,d,e,f),i=g(a,b,e,f),j=g(a,b,c,d),k=h+i+j;return 0===k?{x:a,y:b}:{x:(h*a+i*c+j*e)/k,y:(h*b+i*d+j*f)/k}},Ogma.geometry.centroid=function(a,b,c,d,e,f){return{x:(a+c+e)/3,y:(b+d+f)/3}},Ogma.geometry.isPointInRectangle=function(a,b,c,d,e,f){return a>=c&&a<=e&&b>=d&&b<=f},Ogma.geometry.isPointInPolygon=function(b,c,d,e){e===a&&(e=d.length);for(var f=e-1,g=!1,h=0;h<e;++h)(d[h].y<c&&d[f].y>=c||d[f].y<c&&d[h].y>=c)&&(d[h].x<=b||d[f].x<=b)&&(g^=d[h].x+(c-d[h].y)/(d[f].y-d[h].y)*(d[f].x-d[h].x)<b),f=h;return g},Ogma.geometry.triangulatePolygon=function(a){for(var b=a.length,d=(b-2)*Math.PI,e=0,g=0;g<b;++g){var h=Ogma.geometry.angle(a[c(g-1,b)],a[g],a[c(g+1,b)]);e+=h}var i=a.slice();for(g=0;g<i.length;++g)i[g].index=g;return e-1e-4>d&&i.reverse(),f(i)}}.call(),function(a){var Ogma=$global.Ogma;Ogma.imports={}}.call(),function(){function a(a){for(var b=new Int32Array(a.length),c=0,d=a.length;c<d;++c)b[c]=a.charCodeAt(c);return b}function b(a,b,c,d){var e=d.length;if(c-b!==e)return!1;for(var f=0;f<e;++f)if(a[b+f]!==d[f])return!1;return!0}function c(a,b,c,d){return e(a.tags,b,c,d)}function d(a,b,c,d){return e(a.attributes,b,c,d)}function e(a,c,d,e){for(var f=a.length,g=0;g<f;++g)if(b(c,d,e,a[g]))return g;return a.push(c.slice(d,e)),f}function f(a){return a.charCodeAt(0)}function g(a,b,c){var e,f,g;if(c=j(b,c),e=b[c],e===q||e===u)return c;for(f=c,c=l(b,c),g=d(a,b,f,c);b[c]!==r;)++c;for(++c,f=c;(e=b[c])!==r;)e===v&&++c,++c;return a.tokens.push(F,g,f,c),c+1}function h(a,b){var d,e,f,h,k=a.length,m={tags:[],attributes:[],tokens:[]},n=m.tokens;for(b=j(a,b);b<k;){if(h=a[b],h===p){if(b=j(a,++b),a[b]===u)for(n.push(E);a[++b]!==q;);else{for(d=b,b=l(a,d),f=c(m,a,d,b),n.push(D,f),h=a[b];h!==q&&h!==u;)b=g(m,a,b),h=a[b];if(h===u)for(n.push(E);a[++b]!==q;);}b+=1}else{for(d=b;a[++b]!==p;);for(e=b-1;i(a[e]);)--e;n.push(G,d,e+1)}b=j(a,b)}return m}function i(a){return a===o||a===s||a===t}function j(a,b){for(;i(a[b]);)++b;return b}function k(a){return a>=w&&a<=x||a>=y&&a<=z||a===C||a>=A&&a<=B}function l(a,b){for(;k(a[b]);)++b;return b}function m(a,b){var c=["this.id = undefined;","this.text = undefined;","this.color = undefined;","this.size = undefined;"];a?c.push("this.x = undefined;","this.y = undefined;"):c.push("this.source = undefined;","this.target = undefined;");var d=Object.keys(b);d.length&&c.push("  this.data = {");for(var e=0;e<d.length;++e){var f=d[e],g=b[f],h=g.title;c.push('  "'+h+'": '+(void 0!==g.default?JSON.stringify(g.default):void 0)+(e===d.length-1?"":","))}return d.length&&c.push("};"),new Function(c.join("\n"))}function n(a){return a.indexOf("\\")===-1?a:a=a.replace(/\\"/g,'"')}var Ogma=$global.Ogma,o=f(" "),p=f("<"),q=f(">"),r=f('"'),s=f("\n"),t=f("\r"),u=f("/"),v=(f("="),f("\\")),w=f("a"),x=f("z"),y=f("A"),z=f("Z"),A=f("0"),B=f("9"),C=f(":"),D=-1,E=-2,F=-3,G=-4;Ogma.imports.gexf=function(b){var c=a(b),d=h(c,b.indexOf("<gexf ")),e={},f=[],g={},i=[];d.tags.forEach(function(a,b){var c=String.fromCharCode.apply(null,a);e[c]=b,f.push(c)}),d.attributes.forEach(function(a,b){var c=String.fromCharCode.apply(null,a);g[c]=b,i.push(c)});for(var j,k=e.attributes,l=e.attribute,o=e.node,p=e.edge,q=e.default,r=e["viz:position"],s=e["viz:size"],t=e["viz:color"],u=e.attvalue,v=g.class,w=g.id,x=g.type,y=g.title,z=g.label,A=g.source,B=g.target,C=g.x,H=g.y,I=g.r,J=g.g,K=g.b,L=g.a,M=g.value,N=g.for,O=g.weight,P=4,Q=5,R=6,S=1,T=2,U=3,V=4,W=5,X={float:S,double:S,integer:T,boolean:U,string:V,"list-string":W},Y=0,Z=d.tokens,$=Z.length,_=new Array(16),aa=0,ba=0,ca=0,da=!0,ea={},fa={},ga=null,ha=null,ia=null,ja=void 0,ka=null,la=0,ma=0,na=0,oa=1,pa=null,qa=void 0,ra=!1,sa=!0,ta=null,ua=null,va=[],wa=[],xa=0;Y<$;){var ya=Z[Y];if(ya===D)ba=aa,aa=Z[Y+1],_[ca]=aa,ca+=1,aa===o?(ta||(ta=m(!0,ea)),ka=new ta,sa=!0,j=ea):aa===p&&(ua||(ua=m(!1,fa)),ka=new ua,sa=!1,j=fa),Y+=2;else if(ya===E){if(ga&&aa===l){j=da?ea:fa;var za=X[ha],Aa=ja;Aa&&(za===S?Aa=+Aa:za===T?Aa=0|+Aa:za===U?Aa="true"===Aa:za===W&&(Aa=Aa.split(" ").filter(function(a){return a}))),j[ga]={title:ia||ga,type:za,default:Aa},ga=null,ia=null,ha=null,ja=void 0}else if(aa===o&&ca===P)ra&&(ka.color="rgba("+la+", "+ma+", "+na+", "+oa+")",la=0,ma=0,na=0,oa=1,ra=!1),ka.id||(ka.id=++xa),va.push(ka);else if(aa===p&&ca===P)ka.id||(ka.id=++xa),wa.push(ka);else if(aa===u&&ca===R&&pa){var Ba=(sa?ea:fa)[pa];Ba&&(void 0===qa?qa=Ba.default:(za=Ba.type,za&&(qa=za===S?+qa:za===T?0|+qa:za===U?"true"===qa:za===W?qa.split(" ").filter(function(a){return a}).map(function(a){return n(a)}):n(qa))),ka.data[j[pa].title]=qa),pa=null,qa=null}ca-=1,aa=ba,ba=_[ca-2],Y+=1}else if(ya===F){var Ca=Z[Y+1];Aa=b.substring(Z[Y+2],Z[Y+3]),aa===k?Ca===v&&(da="edge"!==Aa&&"edges"!==Aa):aa===l?Ca===w?ga=Aa:Ca===x?ha=Aa:Ca===y&&(ia=Aa):aa!==o&&aa!==p||ca!==P?aa===r&&ca===Q?Ca===C?ka.x=+Aa:Ca===H&&(ka.y=-Aa):aa===t&&ca===Q?(ra=!0,Ca===I?la=Aa:Ca===J?ma=Aa:Ca===K?na=Aa:Ca===L&&(oa=Aa)):aa===s&&ca===Q?Ca===M&&(ka.size=+Aa):aa===u&&ca===R&&(Ca===N||Ca===w?pa=Aa:Ca===M&&(qa=Aa)):Ca===w?ka.id=Aa:Ca===z?ka.text=Aa:Ca===A?ka.source=Aa:Ca===B?ka.target=Aa:Ca===O&&(ka.size=+Aa),Y+=4}else{if(ya!==G)throw new Error("at index "+Y+": token "+ya);Aa=b.substring(Z[Y+1],Z[Y+2]),aa===q&&(ja=Aa),Y+=3}}return{nodes:va,edges:wa}}}(),function(a){var Ogma=$global.Ogma;Ogma.imports.json=function(a){var b;try{b=JSON.parse(a)}catch(a){b=null}for(var c=b.nodes||[],d=b.edges||[],e=0,f=c.length;e<f;++e){var g=c[e];"string"==typeof g.size&&(g.size=+g.size),"string"==typeof g.x&&(g.x=+g.x),"string"==typeof g.y&&(g.y=+g.y)}for(var h=0,i=d.length;h<i;++h){var j=d[h];"string"==typeof j.size&&(j.size=+j.size)}return b},Ogma.imports.json.webWorkerCompatible=!1}.call(),function(a){var Ogma=$global.Ogma;Ogma.layouts=Object.create(null)}.call(),function(){function a(a){return void 0===a||"number"==typeof a&&isFinite(a)&&a>0}var Ogma=$global.Ogma;Ogma.layouts.grid={configure:function(b,c){var d,e,f=c.graph.nodes,g=b.sortBy;if(!a(b.nbRows))throw new TypeError('"nbRows" should be a positive integer');if(!a(b.nbCols))throw new TypeError('"nbCols" should be a positive integer');b.nodes&&(f=c.graph.getNodeList(b.nodes));var h=f.length;b.nbRows?(d=b.nbRows,e=Math.ceil(h/d)):b.nbCols?(e=b.nbCols,d=Math.ceil(h/e)):(e=Math.ceil(Math.sqrt(h)),d=Math.ceil(h/e));for(var i=[],j=0;j<h;++j){var k=f[j],l=j;k.pinned||k.parent||("random"===g?l=Math.random():g&&(l=Ogma.utils.strToObjectRef(k,g)),
i.push({id:k.id,attr:l}))}var m=c.locate.nodesBoundingBox(f),n=1.1*m.maxSize,o=m.minX+n,p=m.maxX-n,q=m.minY+n,r=m.maxY-n;m.width<n*e*2&&(o=m.cx-n*e+n,p=m.cx+n*e-n),m.height<n*d*2&&(q=m.cy-n*d+n,r=m.cy+n*d-n);var s={sort:!!g,nbRows:d,nbCols:e,nodes:i,reverse:!!b.reverse,minX:o,maxX:p,minY:q,maxY:r};return s},update:function(a){a.sort&&a.nodes.sort(function(a,b){var c=a.attr,d=b.attr;return c<d?-1:c>d?1:0}),a.reverse&&a.nodes.reverse();var b=(a.maxX-a.minX)/(a.nbCols-1),c=(a.maxY-a.minY)/(a.nbRows-1),d=0,e=0,f=a.minX,g=a.minY;isFinite(b)||(b=0),isFinite(c)||(c=0);for(var h=0;h<a.nodes.length;++h){var i=a.nodes[h];i.x=f+d*b,i.y=g+e*c,d+=1,d===a.nbCols&&(e+=1,d=0)}return a.nodes},onSync:function(a,b,c){for(var d=0;d<a.length;++d){var e=a[d],f=c.graph.getNode(e.id);f.x=e.x,f.y=e.y}}}}(),function(){function a(a,b){for(var c=0,d=a.length-1,e=void 0,f=void 0;c<=d;)if(e=(c+d)/2|0,f=a[e],f<b)c=e+1;else{if(!(f>b))return e;d=e-1}return-1}function b(b,d,e){for(var f=b.slice().sort(c),g=[],h=0,i=d.length;h<i;h++){for(var j=[],k=d[h],l=!1,m=0,n=k.length;m<n;m++){var o=k[m],p=a(f,o);p!==-1&&(o===e&&(l=!0),j.push(o))}0!==j.length&&g[l?"unshift":"push"](j.sort(c))}return g}var Ogma=$global.Ogma,c=function(a,b){return a-b};Ogma.layouts.radial={dependencies:["Ogma.algorithms.minHeap","Ogma.algorithms.bellmanFord","Ogma.algorithms.dijkstra","Ogma.algorithms.johnson","Ogma.geometry.distance","Ogma.geometry.circleCircleIntersection","Ogma.geometry.circleSortCompare","Ogma.algorithms.weightedStress","Ogma.algorithms.distanceStress","Ogma.algorithms.constrainedStress","Ogma.algorithms.stressMinimizationStep","Ogma.algorithms.removeRadialOverlap","Ogma.modules.animations.easings.quadraticInOut"],configure:function(a,d){var e=null,f=void 0,g=void 0,h=-1,i=d.graph.edgeAttributes,j=d.graph.nodeAttributes,k=null;if(void 0===a.centralNode||null===a.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');e=d.graph.getNode(a.centralNode,!0),f=isFinite(a.centerX)?parseFloat(a.centerX):e.x,g=isFinite(a.centerY)?parseFloat(a.centerY):e.y,h=e.__index;var l=(a.nodes?d.graph.getNodeList(a.nodes):d.graph.nodes).reduce(function(a,b){return(b.pinned||b.parent)&&b.__index!==h||a.push(b.__index),a},[]);l.indexOf(h)===-1&&l.push(h),l.sort(c);var m=l.length,n=d.topology.getConnectedComponents(!0,!0),o=b(l,n,h);n=o;for(var p=new Float32Array(m),q=new Float32Array(m),r=new Float32Array(m),s=new Float32Array(m),t=new Uint8Array(m),u=0,v=0;v<m;v++){var w=l[v];p[v]=j.x[w],q[v]=j.y[w],r[v]=j.size[w],s[v]=1,u=Math.max(u,r[v]),t[v]=j.adjacentEdges[w]._indexSet.size}var x=d.topology.getAdjacencyTable(!0,!0,1),y=isFinite(a.radiusRatio)?parseFloat(a.radiusRatio):Math.SQRT2,z=isFinite(a.radiusDelta)?parseFloat(a.radiusDelta):0,A=isFinite(a.nodeGap)?parseInt(a.nodeGap):10,B=m*(isFinite(a.repulsion)?parseFloat(a.repulsion):1),C=isFinite(a.maxIterations)?parseInt(a.maxIterations):100;if(C<1)throw new RangeError("maxIterations must be a positive integer");var D=isFinite(a.iterationsPerRender)?parseInt(a.iterationsPerRender):20;if(D<1)throw new RangeError("iterationsPerRender must be a positive integer");var E=isFinite(a.epsilon)?parseFloat(a.epsilon):.001;if(E<=0)throw new RangeError("epsilon has to be a positive number");return{centerIndex:h,centerX:f,centerY:g,list:l,components:o,X:p,Y:q,degree:t,size:m,currStress:Number.POSITIVE_INFINITY,epsilon:E,maxSteps:C,iterationsPerRender:D,attributes:{size:r,adjacency:x,sources:i.source,targets:i.target,weights:i.size.map(function(a){return 1})},sortAttr:k,allowOverlap:!!a.allowOverlap,nodeGap:A,radiusRatio:y,radiusDelta:z,repulsion:B,randomize:!("randomize"in a)||!!a.randomize,renderSteps:!!a.renderSteps}},context:function(){return{getHighestNodeSize:function(a,b){for(var c=0,d=0,e=b.length;d<e;d++){var f=a[b[d]];f>c&&(c=f)}return c},grid:function(a){var b,c,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,e=a.size,f=new Float32Array(e),g=new Float32Array(e),h=this.getHighestNodeSize(a.attributes.size,a.list,e),i=h*d,j=Math.ceil(Math.sqrt(e)),k=Math.ceil(e/j),l=-Math.floor((k-1)*i/2),m=-Math.floor((j-1)*i/2);for(b=0;b<j;b++)for(c=0;c<k;c++)f[b*k+c]=l+c*i,g[b*k+c]=m+b*i;return{x:f,y:g}},connectSubgraphs:function(a,b,c,d,e){function f(a,b){var c=new Uint32Array(a.length+1);return c.set(a),c[a.length]=b,c}for(var g=void 0,h=void 0,i=function(i){g=a[i];var j=0,l=0;g.forEach(function(a,b){e[a]>j&&(l=b,j=e[a])}),h=g[l],k=b[h],k.nodes=f(k.nodes,c),k.weights.push(d),k=b[c],k.nodes=f(k.nodes,h),k.weights.push(d)},j=1;j<a.length;j++){var k;i(j)}},correctSubgraphsDistances:function(a,b,c,d,e){for(var f=a[c].reduce(function(a,b,e){return e!==c&&b<d&&b>a&&(a=b),a},0),g=d-f-1,h=1;h<b.length;h++)for(var i=b[h],j=0,k=i.length;j<k;j++){var l=e[i[j]];a[c][l]-=g,a[l][c]-=g}},establishRadii:function(a,b,c,d,e,f,g,h){var i=Object.create(null),j=1,k=e[b],l=k,m=0,n=k;for(var o in d){for(var p=d[o],q=0,r=0,s=void 0,t=0,u=p.length;t<u;t++)s=e[p[t]],r=Math.max(r,s),q+=2*s+f;var v=q/(2*Math.PI)+r,w=r+l,x=h?m+Math.max(h,w):m*g;m=Math.max(m,v,n,x),i[o]=m,l=r,j++}return i[0]=0,i[Number.POSITIVE_INFINITY]=m,i},initData:function(a,b){a.step=0,a.data=b,a.totalSteps=b.totalSteps,a.currStress=Number.POSITIVE_INFINITY,a.prevStress=0,a.epsilon=a.data.epsilon;var c={},d={};a.normIndexes=b.list.reduce(function(e,f,g){return e[g]=c[f]=g,d[f]=b.degree[g],f===b.centerIndex&&(a.centerIndexPos=g),e},new Uint32Array(b.list.length));var e=a.centerIndexPos,f=b.components[0].length;this.connectSubgraphs(b.components,b.attributes.adjacency,b.centerIndex,f,d);var g=Ogma.algorithms.johnson({sources:b.attributes.sources,targets:b.attributes.targets,weights:b.attributes.weights,indexes:b.list,adjacency:b.attributes.adjacency,undirected:!0});this.correctSubgraphsDistances(g,b.components,e,f,c),a.D=g,a.rings=this.groupRings(g,e,a.normIndexes),a.radii=this.establishRadii(g,e,a.normIndexes,a.rings,b.attributes.size,b.nodeGap,b.radiusRatio,b.radiusDelta)},groupRings:function(a,b,c){for(var d=a[b],e=Object.create(null),f=0,g=c.length;f<g;f++)if(f!==b){var h=d[f];e[h]=e[h]||[],e[h].push(c[f])}return e},removeOverlaps:function(a,b){var c=a.centerIndexPos,d=b.attributes.size,e=a.rings,f=b.X[c],g=b.Y[c];for(var h in e){var i=e[h],j=Ogma.geometry.distance(f,g,b.X[i[0]],b.Y[i[0]]);Ogma.algorithms.removeRadialOverlap({X:b.X,Y:b.Y,sizes:d,indexes:i,center:[f,g],R:j,gap:b.nodeGap,inPlace:!0})}}}},update:function(a,b){a=a||b.data;var c=a.list,d=a.centerIndex,e=a.X||new Float32Array(a.size),f=a.Y||new Float32Array(a.size),g=null,h=void 0;void 0===b.step?b.initData(b,a):b.step++;var i=a.repulsion,j=function(a){return b.radii[a]||1};if(0===b.step)a.randomize&&(h=b.grid(a),a.X=h.x,a.Y=h.y),a.spent=0;else if(!b.converged)for(var k=a.maxSteps,l=a.iterationsPerRender,m=b.step,n=Math.min(m+l,k+1);m<=n||!b.converged;){var o=Ogma.modules.animations.easings.quadraticInOut(Math.min(m,k)/k);b.step=m++,h=Ogma.algorithms.stressMinimizationStep(b.D,e,f,a.size,b.centerIndexPos,i,o,b.normIndexes,j),a.X=h.X,a.Y=h.Y,b.prevStress=b.currStress,b.currStress=Ogma.algorithms.constrainedStress(b.D,a.X,a.Y,a.size,b.centerIndexPos,i,o,b.normIndexes,c,d),b.converged=b.converged||Math.abs(b.currStress-b.prevStress)<=b.epsilon}return b.converged&&(b.overlapRemoved||b.data.allowOverlap?(b.done=!0,g=Object.keys(b.rings).reduce(function(a,d){return a[d]=b.rings[d].map(function(a){return c[a]}),a},{})):(b.removeOverlaps(b,a,d),b.overlapRemoved=!0)),{x:a.X,y:a.Y,indexes:a.list,components:b.overlapRemoved?a.components:void 0,rings:g,centerIndex:b.centerIndexPos,cx:a.centerX,cy:a.centerY,step:b.step,renderSteps:a.renderSteps,converged:b.converged,overlapRemoved:b.overlapRemoved,stress:b.currStress,done:b.done}},isRunning:function(a){return!a.converged||!a.data.allowOverlap&&!a.done},onSync:function(a,b,c){(a.renderSteps||a.done)&&Ogma.layouts.radial.updateGraph(a,c)},onEnd:function(a,b,c){Ogma.layouts.radial.updateGraph(a,c)},updateGraph:function(a,b){var c,d,e,f,g=b.graph.nodeAttributes.x,h=b.graph.nodeAttributes.y,i=a.indexes,j=a.x,k=a.y,l=i.length;for(d=a.centerIndex,e=j[d]-a.cx,f=k[d]-a.cy,c=0;c<l;c++)d=i[c],g[d]=j[c]-e,h[d]=k[c]-f}}}(),function(a){var Ogma=$global.Ogma;Ogma.layouts.forceLink={context:function(){return{}},update:function(a,b){function c(){var a,b,c={},d=arguments.length;for(a=d-1;a>=0;a--)for(b in arguments[a])c[b]=arguments[a][b];return c}function d(a,b,c,d){var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)}function e(a,b,c,d,e){return(e-d)*(a-b)/(c-b)+d}function f(a){return Math.acos(a.x/Math.sqrt(a.x*a.x+a.y*a.y))}function g(a,b,c,d){return{xi:-(d-b),yi:c-a,xi_prime:d-b,yi_prime:-(c-a)}}function h(a,b){return{x:(a.xi_prime-a.xi)/b,y:(a.yi_prime-a.yi)/b}}function i(a,b,c,d,e){return{x:a+(c-a)*e,y:b+(d-b)*e}}function j(a,b){if(a%q.ppn!==0)throw new Error('Invalid argument in np: "i" is not correct ('+a+").");if(a!==parseInt(a))throw new TypeError('Invalid argument in np: "i" is not an integer.');if(b in u)return a+u[b];throw new Error("ForceLink.Worker - Inexistant node property given ("+b+").")}function k(a,b){switch(b.randomize){case"globally":return Math.random()*(b.randomizeFactor||1);case"locally":return a+Math.random()*(b.randomizeFactor||1);default:return a}}function l(a,b){var c,d,e,f=a.nodes,g=a.edges,h=Object.keys(a.nodes),i=Object.keys(a.edges),j=h.length*q.ppn,l=i.length*q.ppe,m={},n=new Float32Array(j),o=new Float32Array(l);for(c=d=0,e=h.length;c<e;c++){var p=h[c],r=f[p];m[p]=d,n[d]=k(r.x,b),n[d+1]=k(r.y,b),n[d+2]=0,n[d+3]=0,n[d+4]=0,n[d+5]=0,n[d+6]=1+r.degree,n[d+7]=1,n[d+8]=r.size,n[d+9]=r.pinned||0,d+=q.ppn}for(c=d=0,e=i.length;c<e;c++){p=i[c];var s=g[p];o[d]=m[s.source],o[d+1]=m[s.target],o[d+2]=s.weight||0,d+=q.ppe}return{nodes:n,edges:o}}function m(a,c){var d=l(a,c);b.NodeMatrix=d.nodes,b.EdgeMatrix=d.edges,q.nodesLength=b.NodeMatrix.length,q.edgesLength=b.EdgeMatrix.length}function n(){var a,b,c,k,l,m,n,o,p,u,v,w,x,y,z,A,B;for(c=0;c<q.nodesLength;c+=q.ppn)s[c+4]=s[c+2],s[c+5]=s[c+3],s[c+2]=0,s[c+3]=0;if(q.settings.outboundAttractionDistribution){for(p=0,c=0;c<q.nodesLength;c+=q.ppn)p+=s[c+6];p/=q.nodesLength}if(q.settings.barnesHutOptimize){var C,D,E=1/0,F=-(1/0),G=1/0,H=-(1/0);for(r=[],c=0;c<q.nodesLength;c+=q.ppn)E=Math.min(E,s[c]),F=Math.max(F,s[c]),G=Math.min(G,s[c+1]),H=Math.max(H,s[c+1]);for(r[0]=-1,r[1]=(E+F)/2,r[2]=(G+H)/2,r[3]=Math.max(F-E,H-G),r[4]=-1,r[5]=-1,r[6]=0,r[7]=0,r[8]=0,a=1,c=0;c<q.nodesLength;c+=q.ppn)for(b=0;;)if(r[b+5]>=0)C=s[c]<r[b+1]?s[c+1]<r[b+2]?r[b+5]:r[b+5]+q.ppr:s[c+1]<r[b+2]?r[b+5]+2*q.ppr:r[b+5]+3*q.ppr,r[b+7]=(r[b+7]*r[b+6]+s[c]*s[c+6])/(r[b+6]+s[c+6]),r[b+8]=(r[b+8]*r[b+6]+s[c+1]*s[c+6])/(r[b+6]+s[c+6]),r[b+6]+=s[c+6],b=C;else{if(r[b]<0){r[b]=c;break}if(r[b+5]=a*q.ppr,n=r[b+3]/2,o=r[b+5],r[o]=-1,r[o+1]=r[b+1]-n,r[o+2]=r[b+2]-n,r[o+3]=n,r[o+4]=o+q.ppr,r[o+5]=-1,r[o+6]=0,r[o+7]=0,r[o+8]=0,o+=q.ppr,r[o]=-1,r[o+1]=r[b+1]-n,r[o+2]=r[b+2]+n,r[o+3]=n,r[o+4]=o+q.ppr,r[o+5]=-1,r[o+6]=0,r[o+7]=0,r[o+8]=0,o+=q.ppr,r[o]=-1,r[o+1]=r[b+1]+n,r[o+2]=r[b+2]-n,r[o+3]=n,r[o+4]=o+q.ppr,r[o+5]=-1,r[o+6]=0,r[o+7]=0,r[o+8]=0,o+=q.ppr,r[o]=-1,r[o+1]=r[b+1]+n,r[o+2]=r[b+2]+n,r[o+3]=n,r[o+4]=r[b+4],r[o+5]=-1,r[o+6]=0,r[o+7]=0,r[o+8]=0,a+=4,C=s[r[b]]<r[b+1]?s[r[b]+1]<r[b+2]?r[b+5]:r[b+5]+q.ppr:s[r[b]+1]<r[b+2]?r[b+5]+2*q.ppr:r[b+5]+3*q.ppr,r[b+6]=s[r[b]+6],r[b+7]=s[r[b]],r[b+8]=s[r[b]+1],r[C]=r[b],r[b]=-1,D=s[c]<r[b+1]?s[c+1]<r[b+2]?r[b+5]:r[b+5]+q.ppr:s[c+1]<r[b+2]?r[b+5]+2*q.ppr:r[b+5]+3*q.ppr,C!==D){r[D]=c;break}b=C}}if(q.settings.barnesHutOptimize)for(u=q.settings.scalingRatio,c=0;c<q.nodesLength;c+=q.ppn)for(b=0;;)if(r[b+5]>=0){if(A=Math.sqrt((s[c]-r[b+7])*(s[c]-r[b+7])+(s[c+1]-r[b+8])*(s[c+1]-r[b+8])),2*r[b+3]/A<q.settings.barnesHutTheta){if(v=s[c]-r[b+7],w=s[c+1]-r[b+8],q.settings.adjustSizes?A>0?(B=u*s[c+6]*r[b+6]/A/A,s[c+2]+=v*B,s[c+3]+=w*B):A<0&&(B=-u*s[c+6]*r[b+6]/A,s[c+2]+=v*B,s[c+3]+=w*B):A>0&&(B=u*s[c+6]*r[b+6]/A/A,s[c+2]+=v*B,s[c+3]+=w*B),r[b+4]<0)break;b=r[b+4];continue}b=r[b+5]}else{if(r[b]>=0&&r[b]!==c&&(v=s[c]-s[r[b]],w=s[c+1]-s[r[b]+1],A=Math.sqrt(v*v+w*w),q.settings.adjustSizes?A>0?(B=u*s[c+6]*s[r[b]+6]/A/A,s[c+2]+=v*B,s[c+3]+=w*B):A<0&&(B=-u*s[c+6]*s[r[b]+6]/A,s[c+2]+=v*B,s[c+3]+=w*B):A>0&&(B=u*s[c+6]*s[r[b]+6]/A/A,s[c+2]+=v*B,s[c+3]+=w*B)),r[b+4]<0)break;b=r[b+4]}else for(u=q.settings.scalingRatio,k=0;k<q.nodesLength;k+=q.ppn)for(l=0;l<k;l+=q.ppn)v=s[k]-s[l],w=s[k+1]-s[l+1],q.settings.adjustSizes?(A=Math.sqrt(v*v+w*w)-s[k+8]-s[l+8],A>0?(B=u*s[k+6]*s[l+6]/A/A,s[k+2]+=v*B,s[k+3]+=w*B,s[l+2]+=v*B,s[l+3]+=w*B):A<0&&(B=100*u*s[k+6]*s[l+6],s[k+2]+=v*B,s[k+3]+=w*B,s[l+2]-=v*B,s[l+3]-=w*B)):(A=Math.sqrt(v*v+w*w),A>0&&(B=u*s[k+6]*s[l+6]/A/A,s[k+2]+=v*B,s[k+3]+=w*B,s[l+2]-=v*B,s[l+3]-=w*B));for(o=q.settings.gravity/q.settings.scalingRatio,u=q.settings.scalingRatio,c=0;c<q.nodesLength;c+=q.ppn)B=0,v=s[c],w=s[c+1],A=Math.sqrt(v*v+w*w),q.settings.strongGravityMode?A>0&&(B=u*s[c+6]*o):A>0&&(B=u*s[c+6]*o/A),s[c+2]-=v*B,s[c+3]-=w*B;for(u=1*(q.settings.outboundAttractionDistribution?p:1),m=0;m<q.edgesLength;m+=q.ppe)k=t[m],l=t[m+1],n=t[m+2],z=Math.pow(n,q.settings.edgeWeightInfluence),v=s[k]-s[l],w=s[k+1]-s[l+1],q.settings.adjustSizes?(A=Math.sqrt(v*v+w*w)-s[k+8]-s[l+8],q.settings.linLogMode?q.settings.outboundAttractionDistribution?A>0&&(B=-u*z*Math.log(1+A)/A/s[k+6]):A>0&&(B=-u*z*Math.log(1+A)/A):q.settings.outboundAttractionDistribution?A>0&&(B=-u*z/s[k+6]):A>0&&(B=-u*z)):(A=Math.sqrt(v*v+w*w),q.settings.linLogMode?q.settings.outboundAttractionDistribution?A>0&&(B=-u*z*Math.log(1+A)/A/s[k+6]):A>0&&(B=-u*z*Math.log(1+A)/A):q.settings.outboundAttractionDistribution?(A=1,B=-u*z/s[k+6]):(A=1,B=-u*z)),A>0&&(s[k+2]+=v*B,s[k+3]+=w*B,s[l+2]-=v*B,s[l+3]-=w*B);var I,J,K,L,M=0;if(q.settings.adjustSizes)for(c=0;c<q.nodesLength;c+=q.ppn)s[j(c,"pinned")]||(I=Math.sqrt(s[c+2]*s[c+2]+s[c+3]*s[c+3]),I>q.maxForce&&(s[c+2]=s[c+2]*q.maxForce/I,s[c+3]=s[c+3]*q.maxForce/I),J=s[c+6]*Math.sqrt((s[c+4]-s[c+2])*(s[c+4]-s[c+2])+(s[c+5]-s[c+3])*(s[c+5]-s[c+3])),K=Math.sqrt((s[c+4]+s[c+2])*(s[c+4]+s[c+2])+(s[c+5]+s[c+3])*(s[c+5]+s[c+3]))/2,L=.1*Math.log(1+K)/(1+Math.sqrt(J)),x=s[c],y=s[c+1],s[c]=s[c]+s[c+2]*(L/q.settings.slowDown),s[c+1]=s[c+1]+s[c+3]*(L/q.settings.slowDown),v=s[c],w=s[c+1],A=Math.sqrt((v-x)*(v-x)+(w-y)*(w-y)),M+=A);else for(c=0;c<q.nodesLength;c+=q.ppn)s[j(c,"pinned")]||(J=s[c+6]*Math.sqrt((s[c+4]-s[c+2])*(s[c+4]-s[c+2])+(s[c+5]-s[c+3])*(s[c+5]-s[c+3])),K=Math.sqrt((s[c+4]+s[c+2])*(s[c+4]+s[c+2])+(s[c+5]+s[c+3])*(s[c+5]+s[c+3]))/2,L=s[c+7]*Math.log(1+K)/(1+Math.sqrt(J)),s[c+7]=Math.min(1,Math.sqrt(L*(s[c+2]*s[c+2]+s[c+3]*s[c+3])/(1+Math.sqrt(J)))),x=s[c],y=s[c+1],s[c]=s[c]+s[c+2]*(L/q.settings.slowDown),s[c+1]=s[c+1]+s[c+3]*(L/q.settings.slowDown),v=s[c],w=s[c+1],A=Math.sqrt((v-x)*(v-x)+(w-y)*(w-y)),M+=A);if(q.iterations++,q.settings.autoStop&&(q.converged=q.iterations>q.settings.maxIterations||M/q.nodesLength<q.settings.avgDistanceThreshold,q.converged&&q.settings.alignNodeSiblings)){var N,O,P={},Q={};for(m=0;m<q.edgesLength;m+=q.ppe)k=t[m],l=t[m+1],k!==l&&(P[k]=P[k]||{},P[l]=P[l]||{},P[k][l]=!0,P[l][k]=!0);Object.keys(P).forEach(function(a){a=~~a,O=Object.keys(P[a]),2==O.length&&(N=O[0]+";"+O[1],N in Q?Q[N].push(a):(N=O[1]+";"+O[0],Q[N]||(Q[N]=[~~O[1],~~O[0]]),Q[N].push(a)))});var R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea=q.settings.nodeSiblingsAngleMin;Object.keys(Q).forEach(function(a){if(S=Q[a].shift(),T=Q[a].shift(),R=Q[a].filter(function(a){return!s[j(a,"pinned")]}),1!=R.length){if(W=s[S],X=s[S+1],Y=s[T],Z=s[T+1],U=Object.keys(P[S]).length,V=Object.keys(P[T]).length,$=e(U/(U+V),0,1,.25,.75),aa=i(W,X,Y,Z,$),ba=g(W,X,Y,Z),_=d(W,X,Y,Z),ca=h(ba,_),da=f(ca),2*ea>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");ea>0&&(da<ea||da>Math.PI-ea&&da<=Math.PI?ca={x:2*Math.cos(Math.PI-ea),y:2*Math.sin(Math.PI-ea)}:(da>2*Math.PI-ea||da>=Math.PI&&da<Math.PI+ea)&&(ca={x:2*Math.cos(ea),y:2*Math.sin(ea)}));var b=0,c=1,k=1;R.length%2==1&&(k=0,b=1);for(var l=0;l<R.length;l++)s[R[l]]=aa.x+c*ca.x*k*(b||l>=2?q.settings.nodeSiblingsScale:2*q.settings.nodeSiblingsScale/3),s[R[l]+1]=aa.y+c*ca.y*k*(b||l>=2?q.settings.nodeSiblingsScale:2*q.settings.nodeSiblingsScale/3),c=-c,k+=(l+b)%2}})}}function o(){if(q.settings.autoStop)for(;!q.converged;)n();else for(var a=0===q.iterations?q.settings.startingIterations:q.iterations+q.settings.iterationsPerRender;q.iterations!==a;)n();return p(b.nodes)}function p(a){for(var b=Object.keys(a),c={},d=0;d<s.length;d+=q.ppn){var e=b[d/q.ppn];c[e]={id:e,x:s[d],y:s[d+1]}}return c}var q;b.W?q=b.W:(q={ppn:10,ppe:3,ppr:9,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},b.W=q,m(a,a.config),q.settings=c(a.config,q.settings),b.nodes=a.nodes,b.edges=a.edges);var r,s=b.NodeMatrix,t=b.EdgeMatrix,u={x:0,y:1,dx:2,dy:3,old_dx:4,old_dy:5,mass:6,convergence:7,size:8,pinned:9};return o()},isRunning:function(a){return!a.W.settings.autoStop},configure:function(a,b,c){var d=b.settings.get("shapes"),e=d.nodeInnerStrokeWidth+d.nodeOuterStrokeWidth,f=b.graph.nodes,g=[],h={},i={};a.nodes&&(f=b.graph.getNodeList(a.nodes),a=Ogma.utils.deepCopy(a),delete a.nodes),f=f.filter(function(a){return!a.parent});for(var j=0,k=0,l=0,m=f.length;l<m;l++){var n=f[l];h[n.id]={x:n.x,y:n.y,degree:n.degree,size:n.size+e,pinned:n.pinned},j+=n.x,k+=n.y}if(f.length>1){f[0].x,f[0].y;for(l=0;l<f.length;++l){var o=h[f[l].id];if(!o.pinned&&!o.parent){var p=1e-10*Math.random(),q=1e-10*Math.random();o.x+=p,o.y+=q,j+=p,k+=q}}}j/=f.length,k/=f.length,c.barycentre={x:j,y:k};for(var r=new Ogma.utils.Set,l=0;l<f.length;++l)for(var s=f[l].edges,t=0;t<s.length;++t)u=s[t],h[u.source]&&h[u.target]&&r.add(b.topology.edgeBiDirection(u))&&g.push(u);for(l=0;l<g.length;++l){var u=g[l];i[u.id]={source:u.source,target:u.target}}var v={nodes:h,edges:i,config:a};return v},onSync:function(a,b,c){var d=c.graph,e=Object.keys(a),f=0,g=0;for(j=0;j<e.length;++j)k=e[j],l=a[k],f+=l.x,g+=l.y;for(var h=f/e.length-b.barycentre.x,i=g/e.length-b.barycentre.y,j=0;j<e.length;++j){var k=e[j],l=a[k],m=d.getNode(k);m&&(m.x=l.x-h,m.y=l.y-i)}}}}.call(),function(){var Ogma=$global.Ogma;Ogma.layouts.concentric={context:function(){return{dijkstra:function(a,b,c,d,e){var f,g,h,i=Math.pow(2,31)-1,j=new Int32Array(d),k=new Int32Array(d),l=new Int8Array(d);for(h=0;h<d;++h)j[h]=i,k[h]=-1;for(h=0;h<d;++h)f=b[h],void 0!==f&&(j[f]=i,k[f]=-1);for(j[e]=0;;){var m=i,n=-1;for(h=0;h<c;++h)f=b[h],g=j[f],!l[f]&&g<m&&(m=g,n=f,l[f]=!0);if(n===-1)break;var o=a[n],p=o.length,q=m+1;for(h=0;h<p;++h)f=o[h],g=j[f],q<g&&(j[f]=q,k[f]=n)}return j},determinePropertyType:function(a,b,c){for(var d=0;d<c;++d)if("number"!=typeof a[b[d]])return"string";return"number"}}},configure:function(a,b){if(void 0===a.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');var c,d,e,f=b.graph.getNode(a.centralNode,!0),g=b.graph._elts.nodes,h=null;if(a.sortBy)if("random"===a.sortBy)h="random";else for(h=new Array(g.totalSize),c=0,d=g.totalSize;c<d;++c){var i=g.attributes.ref[c];i&&(h[c]=Ogma.utils.strToObjectRef(i,a.sortBy))}var j=b.nodes;a.nodes&&(j=b.graph.getNodeList(a.nodes));var k=[];for(c=0,d=j.length;c<d;c++)e=j[c],(e.pinned||e.parent)&&e.__index!==f.__index||k.push(e.__index);var l=k.length;if(k.indexOf(f.__index)===-1)throw new RangeError("concentric layout: central node does not belong to the provided list of nodes");return{sourceNodeIndex:f.__index,centerX:"number"===a.centerX?a.centerX:f.x,centerY:"number"===a.centerY?a.centerY:f.y,list:k,size:l,totalSize:g.totalSize,attributes:{adjacentNodes:g.attributes.adjacentNodes.map(function(a){return a?a.map(function(a){return a.__index}):[]}),size:g.attributes.size},sortAttr:h,clockWise:void 0===a.clockWise||a.clockWise,circleHopRatio:a.circleHopRatio||5,allowOverlap:!!a.allowOverlap}},update:function(a,b){var c,d=a.attributes.adjacentNodes,e=a.attributes.size,f=a.list,g=a.size,h=a.sourceNodeIndex,i=a.centerX,j=a.centerY,k=a.sortAttr,l=new Float32Array(a.totalSize),m=new Float32Array(a.totalSize),n=b.dijkstra(d,f,a.size,a.totalSize,h),o=0,p={};for(c=0;c<g;++c){var q=e[f[c]];q>o&&(o=q)}var r=o*a.circleHopRatio,s=0,t=0,u=Math.PI/9;for(c=0;c<g;++c){var v=f[c],w=n[v],x=p[w];x||(x=[],p[w]=x),x.push(v)}var y=null,z=!0;if("random"===k)y=function(){return Math.random()-.5};else if(k){var A=b.determinePropertyType(k,f,q);y="number"===A?function(a,b){return k[a]-k[b]}:function(a,b){return k[a]<k[b]?-1:1}}else z=!1;var B=Object.keys(p).sort(function(a,b){return parseInt(a)-parseInt(b)});for(c=0;c<B.length;++c){var C=p[B[c]],D=C.length,E=t,F=2*Math.PI/D;if(0!==c&&!a.allowOverlap){var G=2*Math.PI*s,H=0,I=0;for(J=0;J<D;++J)H+=e[C[J]];I=2*H*Math.SQRT2,I>G&&(s+=I/(2*Math.PI)-s)}z&&(C.sort(y),a.clockWise||C.reverse());for(var J=0;J<D;++J){v=C[J],l[v]=Math.cos(E)*s+i,m[v]=Math.sin(E)*s+j,q=e[v];var K=a.allowOverlap?1:q/H*D;E+=F*K}s+=r,t+=u}var L={x:l,y:m,indexes:f};return L},isRunning:function(){return!1},onSync:function(a,b,c){for(var d=c.graph.nodeAttributes.x,e=c.graph.nodeAttributes.y,f=a.indexes,g=a.x,h=a.y,i=f.length,j=0;j<i;++j){var k=f[j];d[k]=g[k],e[k]=h[k]}}}}.call(),function(a){function b(a,b){for(var c=a.BYTES_PER_ELEMENT*b,d=0;d<f.length;++d){var e=f[d];if(e.byteLength>=c)return f.splice(d,1),new a(e)}return new a(b)}function c(a){for(var b=0;b<g.length;++b){var c=g[b];if(c.length>=a)return g.splice(b,1),c}return new Array(a)}function d(a){for(var b=a.buffer,c=0;c<f.length;++c)if(f[c].byteLentgh>b.byteLength)return void f.splice(c,0,b);f.push(b)}function e(a){for(var b=0;b<g.length;++b)if(g[b].length>a.length)return void g.splice(b,0,a);f.push(a)}var Ogma=$global.Ogma;Ogma.memory={};var f=[],g=[];Ogma.memory.allocate=function(a,d){return d=Ogma.utils.upperPowerOf(d,2,8),a===Array?c(d):b(a,d)},Ogma.memory.release=function(a){return a.constructor===Array?e(a):d(a)},Ogma.memory.expand=function(b,c,d){if(c=c?Ogma.utils.upperPowerOf(c,2):2*b.length,d===a&&(d=!0),b.length>=c)return b;var e=Ogma.memory.allocate(b.constructor,c);if(d)if(b.constructor===Array)for(var f=b.length,g=0;g<f;++g)e[g]=b[g];else e.set(b);return Ogma.memory.release(b),e}}.call(),function(a){var Ogma=$global.Ogma;Ogma.pathfinding=Object.create(null)}.call(),function(undefined){function toString(a){return"function"==typeof a?a.toString():"undefined"}var Ogma=$global.Ogma;Ogma.pathfinding.astar={configure:function(a,b,c){if(!a.source)throw new Error("source node is not defined");if(!a.target)throw new Error("target node is not defined");if(["undefined","function"].indexOf(_typeof(a.pathLengthFunction))===-1)throw new TypeError('"pathLengthFunction" is not a function');if(["undefined","function"].indexOf(_typeof(a.heuristicLengthFunction))===-1)throw new TypeError('"heuristicLengthFunction" is not a function');var d=a.directed===undefined||a.directed?"adjacentOutNodes":"adjacentNodes",e=c.graph.getNode(a.source,!0),f=c.graph.getNode(a.target,!0),g=c.graph.nodeAttributes[d].map(function(a){return a._indexSet.array.slice(0,a._indexSet.size)});return{source:e.__index__,target:f.__index__,adjacentNodesList:g,pathLengthFunction:toString(a.pathLengthFunction),heuristicLengthFunction:toString(a.heuristicLengthFunction)}},compute:function compute(data){var source=data.source,target=data.target;if(source===target)return[source];var adjacentNodesList=data.adjacentNodesList,pathLengthFunction=data.pathLengthFunction||DEFAULT_PATH_LENGTH_FUNCTION,heuristicLengthFunction=data.heuristicLengthFunction||pathLengthFunction,totalNbNodes=adjacentNodesList.length;eval("var pathLengthFunction = "+data.pathLengthFunction);for(var closedSet=[],openSet=[],cameFrom=new Int32Array(totalNbNodes),gScore=new Float32Array(totalNbNodes),fScore=new Float32Array(totalNbNodes),i=0;i<totalNbNodes;++i)cameFrom[i]=-1,gScore[i]=1/0,fScore[i]=1/0;for(openSet.push(source),gScore[sourceIndex]=0,fScore[sourceIndex]=heuristicLengthFunction(source,target);0!==openSet._indexSet.size;){var len=openSet._indexSet.size,currentNode=openSet._elementAttributes.ref[openSet._indexSet.array[0]],currentNodeIndex=0,minScore=fScore[currentNode.__index__];for(i=1;i<len;++i){var node=openSet._elementAttributes.ref[openSet._indexSet.array[i]],score=fScore[node.__index__];score<minScore&&(minScore=score,currentNode=node,currentNodeIndex=i)}if(currentNode===target)return constructPath(cameFrom,sourceIndex,targetIndex,refs);openSet.removeByIndex(currentNodeIndex),closedSet.add(currentNode);var neighbors=this._topology.getAdjacentNodes(currentNode,adjacencyOptions);for(i=0;i<neighbors.length;++i){var n=neighbors[i],nIndex=n.__index__;if(!closedSet.has(n)){var gScoreTentative=gScore[currentNode.__index__]+pathLengthFunction(currentNode,n);!openSet.add(n)&&gScoreTentative>=gScore[nIndex]||(cameFrom[nIndex]=currentNode.__index__,gScore[nIndex]=gScoreTentative,fScore[nIndex]=gScoreTentative+heuristicLengthFunction(n,target))}}}return null}}}.call(),function(a){function b(a,b,c,d){this.width=a,this.height=b,this.animationsEnabled=!0,this.animationMode=!1,this.animationDuration=0,this.animationEndDate=0,this.defaultFont=d.defaultFont,this._visibilityConditionTolerance=0,this.shadowsEnabled=!1,this.shadowOffsetY=0,this.shadowBlur=0,this.subLayers=c,this.options=d,this.noRefresh=d.noRefresh,this.now=Ogma.utils.now();var e=this,f=function(a){d.onRender&&d.onRender(a),e.currentTime=Ogma.utils.now(),e.render(a),e.currentTime<=e.animationEndDate&&e.refresh()};this.frameManager=new $global.FrameManager(f,d.debug),this.imageManager=new $global.ImageManager(d.imgCrossOrigin),this.DEFAULT_LAYER={camera:{x:0,y:0,zoom:1,angle:0}}}var Ogma=$global.Ogma;Ogma.renderers={},b.prototype.kill=function(){},b.prototype.setOffset=function(a){this._offset=a},b.prototype.animate=function(a,b){this.currentTime=Ogma.utils.now(),this.animationMode=!0,this.animationDuration=a,this.currentTime+a>this.animationEndDate&&(this.animationEndDate=this.currentTime+a),b(),this.animationMode=!1},b.prototype.setAnimationsEnabled=function(a){this.animationsEnabled=!!a},b.prototype.setVisibilityConditionTolerance=function(a){this._visibilityConditionTolerance=a},b.prototype.getSubLayer=function(b){if(b===a)return this.DEFAULT_LAYER;var c=this.subLayers[b];if(!c)throw new Error('sub-layer "'+b+'" does not exist');return c},b.prototype.refresh=function(){this.noRefresh||this.frameManager.requestNewFrame()},b.prototype.atNextFrame=function(a){this.frameManager.atNextFrame(a),this.refresh()},b.prototype.wrappedUpdate=function(a,b,c){for(var d=this.updateComposite(a,b),e=0;e<d.length;++e)d[e]=c(d[e],e);return this.composite(a,d)},b.prototype.hide=function(a){return this.setDepth(a,-1)},b.prototype.clear=function(){},b.prototype.domElement=function(){},b.prototype.resize=function(a,b){},b.prototype.delete=function(a){},b.prototype.updateComposite=function(a,b){return[]},b.prototype.composite=function(a,b){},b.prototype.setDepth=function(a,b){},b.prototype.setSymbolicSize=function(a,b){},b.prototype.setColor=function(a,b){},b.prototype.setVisibilityCondition1=function(a,b,c,d){},b.prototype.setVisibilityCondition2=function(a,b,c,d){},b.prototype.setBackgroundColor=function(a){},b.prototype.circle=function(a,b,c,d,e,f,g,h){},b.prototype.triangle=function(a,b,c,d,e,f,g,h){},b.prototype.rectangle=function(a,b,c,d,e,f,g,h){},b.prototype.quadrilateral=function(a,b,c,d,e,f,g,h,i,j){},b.prototype.polygon=function(a,b,c,d,e,f){},b.prototype.line=function(a,b,c,d,e,f,g,h,i){},b.prototype.quadraticCurve=function(a,b,c,d,e,f,g,h,i,j){},b.prototype.cubicCurve=function(a,b,c,d,e,f,g,h,i,j,k){},b.prototype.image=function(a,b,c,d,e,f,g,h,i){},b.prototype.text=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){},b.prototype.textWidth=function(a,b,c,d){},b.prototype.render=function(a){},Ogma.renderers.dummy=b}.call(),function(){function a(a,b,c,d){m.call(this,a,b,c,d||{}),this.svg=Ogma.utils.createSvgElement("svg"),this.svg.style.userSelect="none",this.svg.style.webkitUserSelect="none",this.svg.style.MozUserSelect="none",this.defs=Ogma.utils.createSvgElement("defs"),this.svg.appendChild(this.defs),this.resize(a,b),this.shapes=new Ogma.utils.StaticList({dom:Array,components:Array,type:Int8Array,subLayer:Array,depth:Float32Array,symbolicSize:Float32Array,info:Array,prevInfo:Array,animationDuration:Float32Array,creationDate:Int32Array,visibilityCondition1:Array,visibilityCondition2:Array}),this._refresh=this.refresh.bind(this)}function b(a,b,c,d,e){a.setAttribute("viewBox",b+" "+c+" "+d+" "+e)}function c(a){return"number"==typeof a&&a%1===0&&a>=0}function d(a,b,d,f,h,i,j){void 0===j&&(j=-1),void 0===i&&(i=1);var k,m=a.getSubLayer(h),n=a.shapes.attributes,p=!0;return c(b)?n.type[b]!==d?a.delete(b,!0):p=!1:b=a.shapes.add(),m.transparency&&(i-=l),n.prevInfo[b]=p||!a.animationMode?void 0:n.info[b],n.info[b]=f,n.creationDate[b]=a.currentTime,n.animationDuration[b]=a.animationMode?a.animationDuration:0,n.type[b]=d,n.subLayer[b]=m,n.depth[b]=i,n.symbolicSize[b]=j,n.visibilityCondition1[b]=null,n.visibilityCondition2[b]=null,p?(k=Ogma.utils.createSvgElement(o[d]),k.__index__=b,n.dom[b]=k,e(a,b)):g(a,b),b}function e(a,b){var c=a.shapes.attributes,d=a.svg.childNodes,e=c.dom[b],f=c.depth[b],g=c.subLayer[b].level;if(0!==f){for(var h=1;h<d.length;++h){var i=d[h],j=i.__index__,k=c.depth[j],l=c.subLayer[j].level;if(f<k||f===k&&g<l)break}h===d.length?a.svg.appendChild(e):a.svg.insertBefore(e,d[h]),a.refresh()}}function f(a,b){var c=a.shapes.attributes.dom[b];c.parentNode===a.svg&&a.svg.removeChild(c)}function g(a,b){f(a,b),e(a,b)}function h(a,b,d,e,f){var g=a.shapes.attributes;if(c(b))if(g.type[b]===n.COMPOSITE)for(var i=g.components[b],j=0;j<i.length;++j)h(a,i[j],d,e,f);else g.subLayer[b].transparency&&(e-=l),g[d][b]=e,f&&f(a,b),a.refresh()}function i(a){if(a){for(var b={},c=0;c<p.length;++c){var d=p[c];b[d]=a[d]}return b}}function j(a,b){var c=a._offset,d=Ogma.utils.deepCopy(b);return c&&(d.x+=c.x,d.y+=c.y,d.zx+=c.zx,d.zy+=c.zy,d.ax+=c.ax,d.ay+=c.ay,d.ox+=c.ox,d.oy+=c.oy),d}function k(a){for(var b=0;b<a.length;++b)if(F.indexOf(a.charAt(b))===-1)return!1;return!0}var Ogma=$global.Ogma,l=Ogma.constants.EPSILON;Ogma.renderers.svg=a;var m=Ogma.renderers.dummy;a.prototype=Object.create(m.prototype),a.prototype.constructor=a,a.prototype.clear=function(){for(this.shapes.clear(),this.shapes.attributes.type.fill(n.DELETED);this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild)};var n={DELETED:-1,COMPOSITE:0,POLYGON:1,CIRCLE:2,IMAGE:3,TEXT:4,LINE:5,QUADRATIC:6,CUBIC:7,DUPLICATE_IMG:8},o=["g","polygon","circle","image","text","line","path","path","rect"];a.available=function(){return!0},a.prototype.domElement=function(){return this.svg},a.prototype.resize=function(a,c){this.width=a,this.height=c,b(this.svg,0,0,a,c),this.svg.setAttribute("width",a),this.svg.setAttribute("height",c)},a.prototype.delete=function(a,b){var d=this.shapes.attributes;if(!c(a)||d.type[a]===n.DELETED)return-1;if(d.type[a]===n.COMPOSITE)for(var e=d.components[a],g=0;g<e.length;++g)this.delete(e[g]);else f(this,a);return b||(this.shapes.remove(a),d.type[a]=n.DELETED),-1},a.prototype.updateComposite=function(a,b){var d=this.shapes.attributes,e=d.type[a];if(!c(a))return[];var g=d.components[a];if(e!==n.COMPOSITE)return f(this,d.dom[a]),d.type[a]=n.COMPOSITE,[];if(g.length!==b){for(var h=0;h<g.length;++h)this.delete(g[h]);return[]}return g},a.prototype.composite=function(a,b){var d=this.shapes.attributes;if(c(a)&&d.type[a]===n.COMPOSITE){var e=d.components[a];return e!==b&&(d.components[a]=b),a}var f=this.shapes.add();return d.type[f]=n.COMPOSITE,d.components[f]=b,f},a.prototype.setDepth=function(a,b){h(this,a,"depth",b,g)},a.prototype.setSymbolicSize=function(a,b){h(this,a,"symbolicSize",b)},a.prototype.setColor=function(a,b){h(this,a,"color",b)},a.prototype.setVisibilityCondition1=function(a,b,c,d,e){h(this,a,"visibilityCondition1",b?[c,d,e]:null)},a.prototype.setVisibilityCondition2=function(a,b,c,d,e){h(this,a,"visibilityCondition2",b?[c,d,e]:null);
};var p=["textWidth","textHeight","angle","length","size","strokeSize","ratio"];a.prototype.triangle=function(a,b,c,e,f,g,h,i){return d(this,a,n.POLYGON,[f,void 0,j(this,b),j(this,c),j(this,e)],g,h,i)},a.prototype.circle=function(a,b,c,e,f,g,h,i){return d(this,a,n.CIRCLE,[f,j(this,b),c,e],g,h,i)};var q=new Ogma.utils.Position,r=new Ogma.utils.Position,s=new Ogma.utils.Position,t=new Ogma.utils.Position;a.prototype.rectangle=function(a,b,c,d,e,f,g,h){return Ogma.utils.rectangleFromCenterAndDimensions(b,c,q,r,s,t),this.quadrilateral(a,q,r,s,t,d,e,f,g,h)},a.prototype.quadrilateral=function(a,b,c,e,f,g,h,k,l,m){return d(this,a,n.POLYGON,[g,i(m),j(this,b),j(this,c),j(this,e),j(this,f)],h,k,l)},a.prototype.polygon=function(a,b,c,e,f,g){var h=new Array(b.length+2);h[0]=c;for(var i=0;i<b.length;++i)h[i+2]=b[i].clone();return d(this,a,n.POLYGON,h,e,f,g)},a.prototype.line=function(a,b,c,e,f,g,h,i,k){return d(this,a,n.LINE,[g,e,f,j(this,b),j(this,c)],h,i,k)},a.prototype.quadraticCurve=function(a,b,c,e,f,g,h,i,k,l){return d(this,a,n.QUADRATIC,[h,f,g,j(this,b),j(this,c),j(this,e)],i,k,l)},a.prototype.cubicCurve=function(a,b,c,e,f,g,h,i,k,l,m){return d(this,a,n.CUBIC,[i,g,h,j(this,b),j(this,c),j(this,e),j(this,f)],k,l,m)},a.prototype.image=function(a,b,c,e,f,g,h,i,k){this.imageManager.use(e,this._refresh,!0);var l=!f&&g?n.DUPLICATE_IMG:n.IMAGE;return d(this,a,l,[e,j(this,b),j(this,c),f,g],h,i,k)},a.prototype.text=function(a,b,c,e,f,g,h,k,l,m,o,p,q,r){return d(this,a,n.TEXT,[h,c,j(this,b),f,g,e,k,l,m,i(r)],o,p,q)};var u=null,v=null,w=null,x=null,y=null;"undefined"!=typeof document&&(u=document.createElement("canvas"),v=u.getContext("2d")),a.prototype.textWidth=function(a,b,c,d){return b===x&&c===w&&d===y||(v.font=("italic"===d||"bold"===d?d+" ":"")+c+"px "+b,w=c,x=b,y=d),v.measureText(a).width};var z=(2*Math.PI,Math.PI/2),A=Math.PI,B=180/A,C=new Array(128),D={left:"start",right:"end",center:"middle"},E={top:"hanging",bottom:"baseline",middle:"central"},F="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ";a.prototype.stopAnimations=function(){this.shapes.attributes.animationDuration.fill(0),this._refresh()},a.prototype.setBackgroundColor=function(a){this.options.backgroundColor=a},a.prototype.render=function(a){function b(a,b,c){var d,e,f,g,h=fa[a],i=I!==-1?ga[a]:void 0,j=void 0!==b?fa[b]:void 0;if(j){F=0;var k,l,m=j.size*W;if(j.ratio===-1?(k=j.textWidth,l=j.textHeight):(k=j.textWidth*W,l=j.textHeight*W),j.length>-99999&&j.length*W<k)y=0;else{y=V-j.angle;var n=-1;y<-z?(y+=A,y<-z&&(y+=A)):y>z?(y-=A,y>z&&(y-=A)):n=1,j.length<-99999&&(n=-1),F=n*((l+m)/2+j.strokeSize)}d=(h.x-T)*W,e=(h.y-U)*W;var o=X*d+Y*e,r=-Y*d+X*e;if(c)if(F+=h.oy,i){d=(i.x-T)*W,e=(i.y-U)*W;var s=X*d+Y*e,t=-Y*d+X*e;p=s+(o-s)*I,q=t+(r-t)*I}else p=o,q=r;else{var u=Math.cos(y),v=Math.sin(y),w=h.ox+h.zx*W,x=h.oy+h.zy*W+F;p=u*w+v*x+o,q=-v*w+u*x+r,i&&(d=(i.x-T)*W,e=(i.y-U)*W,s=X*d+Y*e,t=-Y*d+X*e,f=u*w+v*x+s,g=-v*w+u*x+t,p=f+(p-f)*I,q=g+(q-g)*I)}}else d=(h.x-T)*W+h.ax,e=(h.y-U)*W+h.ay,p=X*d+Y*e+h.zx*W+h.ox,q=-Y*d+X*e+h.zy*W+h.oy,i&&(d=(i.x-T)*W+i.ax,e=(i.y-U)*W+i.ay,f=X*d+Y*e+i.zx*W+i.ox,g=-Y*d+X*e+i.zy*W+i.oy,p=f+(p-f)*I,q=g+(q-g)*I);p|=0,q|=0}function c(){r=ga&&I!==-1?(ga[2]+(fa[2]-ga[2])*I)*W+(ga[3]+(fa[3]-ga[3])*I):fa[2]*W+fa[3],r|=0}function d(){r=ga&&I!==-1?(ga[1]+(fa[1]-ga[1])*I)*W+(ga[2]+(fa[2]-ga[2])*I):fa[1]*W+fa[2],r|=0}function e(){if(ga&&0===I){var a=4*Ogma.colors.getIndex(ga[0]),b=4*Ogma.colors.getIndex(fa[0]);if(a===b)G=fa[0];else{var c=H[a]+H[b-H[a]]*I,d=H[a+1]+(H[b+1]-H[a+1])*I,e=H[a+2]+(H[b+2]-H[a+2])*I,f=H[a+3]+(H[b+3]-H[a+3])*I;G="rgb("+(255*c|0)+", "+(255*d|0)+", "+(255*e|0)+", "+f+")"}}else G=fa[0]}function f(){var a=K-i.creationDate[O];I=ga&&J&&a<i.animationDuration[O]?a/i.animationDuration[O]:-1}function g(a){if(!a)return!0;var b=(a[0]-T)*W,c=(a[1]-U)*W;return p=X*b+Y*c,q=-Y*b+X*c,r=a[2]*W,p+r>-L&&q+r>-L&&p-r<m+L&&q-r<o+L}var h,i=this.shapes.attributes,j=this.svg.childNodes,l=j.length,m=this.width,o=this.height,p=0,q=0,r=0,s="",t=-1,u=C,v=0,w=!1,x=null,y=0,F=0,G="black",H=Ogma.colors.rgba,I=-1,J=this.animationsEnabled,K=this.currentTime,L=this._visibilityConditionTolerance;for(this.svg.style.background=this.options.backgroundColor;this.defs.firstChild;)this.defs.removeChild(this.defs.firstChild);for(var M=1;M<l;++M){var N=j[M],O=N.__index__,P=i.subLayer[O],Q=i.symbolicSize[O],R=P.symbolicSizeThreshold,S=P.camera,T=S.x,U=S.y,V=S.angle,W=S.zoom,X=Math.cos(V),Y=Math.sin(V);if(P.disabled||Q!==-1&&Q*P.camera.zoom<R)N.setAttribute("visibility","hidden");else{N.setAttribute("visibility","visible");var Z=i.visibilityCondition1[O],$=i.visibilityCondition2[O];if(g(Z)||g($)){if(N.setAttribute("visibility","visible"),P.defineClipSpace)s=i.depth[O],t!==s||x!==P?(t=s,v=1,x=P,u[0]=O):(u[v]=O,v+=1);else if(P.useClipSpace&&i.depth[O]===t)for(W=i.subLayer[O].camera.zoom,w=!0,h=Ogma.utils.createSvgElement("clipPath"),h.setAttribute("id",O),this.defs.appendChild(h),ia=0;ia<v;++ia){var _=u[ia];if(ea=i.type[_],fa=i.info[_],ga=i.prevInfo[_],f(),ea===n.POLYGON){for(var aa=Ogma.utils.createSvgElement("polygon"),ba="",ca=2;ca<fa.length;++ca)b(ca,1),ba+=p+","+q+" ";aa.setAttribute("points",ba),h.appendChild(aa)}else if(ea===n.CIRCLE){var da=Ogma.utils.createSvgElement("circle");b(1),c(),da.setAttribute("cx",p),da.setAttribute("cy",q),da.setAttribute("r",r),h.appendChild(da)}}var ea=i.type[O],fa=i.info[O],ga=i.prevInfo[O];if(f(),ea!==n.IMAGE&&e(),ea===n.POLYGON){for(var ha="",ia=2;ia<fa.length;++ia)b(ia,1),ha+=p+","+q+" ";N.setAttribute("points",ha),N.setAttribute("fill",G)}else if(ea===n.CIRCLE)b(1),c(),N.setAttribute("cx",p),N.setAttribute("cy",q),N.setAttribute("r",r),N.setAttribute("fill",G);else if(ea===n.LINE)d(),b(3),N.setAttribute("x1",p),N.setAttribute("y1",q),b(4),N.setAttribute("x2",p),N.setAttribute("y2",q),N.setAttribute("stroke",G),N.setAttribute("stroke-width",r);else if(ea===n.QUADRATIC)d(),s="",b(3),s+="M "+p+" "+q,b(4),s+=" Q "+p+" "+q,b(5),s+=" "+p+" "+q,N.setAttribute("d",s),N.setAttribute("stroke",G),N.setAttribute("stroke-width",r),N.setAttribute("fill","none");else if(ea===n.CUBIC)d(),s="",b(3),s+="M "+p+" "+q,b(4),s+=" C "+p+" "+q,b(5),s+=" "+p+" "+q,b(6),s+=" "+p+" "+q,N.setAttribute("d",s),N.setAttribute("stroke",G),N.setAttribute("stroke-width",r),N.setAttribute("fill","none");else if(ea===n.TEXT){var ja=fa[3],ka=fa[4],la=fa[5],ma=fa[6],na=fa[7],oa=fa[8],pa=ja*W+ka,qa=fa[1];"FontAwesome"===la&&k(qa)&&(la=this.defaultFont),b(2,9,!0),N.setAttribute("x",p),N.setAttribute("y",q),N.setAttribute("text-anchor",D[na]),N.setAttribute("fill",G),N.setAttribute("font-size",pa),N.setAttribute("font-family",la),N.setAttribute("alignment-baseline",E[oa]),N.setAttribute("font-weight","bold"===ma?"bold":"normal"),N.setAttribute("font-style","italic"===ma?"italic":"normal"),N.firstChild?N.firstChild.nodeValue=qa:N.appendChild(document.createTextNode(qa)),fa[9]&&N.setAttribute("transform","rotate("+(-B*y|0)+" "+p+" "+q+") translate(0 "+F+")")}else if(ea===n.IMAGE){var ra=this.imageManager.getImage(fa[0]),sa=fa[3],ta=fa[2],ua=(ta.zx+ta.x)*W+ta.ox,va=(ta.zy+ta.y)*W+ta.oy;if(!ra)continue;b(1),sa?(N.setAttribute("x",p-ua),N.setAttribute("y",q-va),N.setAttribute("width",2*ua),N.setAttribute("height",2*va),N.setAttribute("preserveAspectRatio",""),N.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",fa[0])):(N.setAttribute("x",p-ra.width/2),N.setAttribute("y",q-ra.height/2),N.setAttribute("width",ra.width),N.setAttribute("height",ra.height),N.setAttribute("preserveAspectRatio","none"),N.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",fa[0]))}else if(ea===n.DUPLICATE_IMG){if(ra=this.imageManager.getImage(fa[0]),ta=fa[2],ua=ta.zx*W+ta.ox,va=ta.zy*W+ta.oy,!ra)continue;b(1);var wa=Ogma.utils.createSvgElement("pattern"),xa=Ogma.utils.createSvgElement("image"),ya="img_"+O;wa.setAttribute("id",ya),wa.setAttribute("patternUnits","userSpaceOnUse"),wa.setAttribute("x",p-ua),wa.setAttribute("y",q-va),wa.setAttribute("width",ra.width),wa.setAttribute("height",ra.height),xa.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",fa[0]),xa.setAttribute("x",0),xa.setAttribute("y",0),xa.setAttribute("width",ra.width),xa.setAttribute("height",ra.height),wa.appendChild(xa),this.defs.appendChild(wa),N.setAttribute("x",p-ua),N.setAttribute("y",q-va),N.setAttribute("width",2*ua),N.setAttribute("height",2*va),N.setAttribute("fill","url(#"+ya+")")}w?(N.setAttribute("clip-path","url(#"+O+")"),w=!1):N.removeAttribute("clip-path")}else N.setAttribute("visibility","hidden")}}}}.call(),function(a){function b(a,e,f,g){var h=$global.webgl.RenderStep;g=g||{},Ogma.renderers.dummy.call(this,a,e,f,g),this.samplingLevel="super-sampling"===g.antialias?2:1;for(var i=Ogma.utils.pixelRatio();this.samplingLevel>1&&"firefox"===Ogma.utils.browser&&(this.samplingLevel*window.innerWidth*i>B||this.samplingLevel*window.innerHeight*i>C);)this.samplingLevel/=2;var j="native"===g.antialias||"super-sampling"===g.antialias&&1!==Ogma.utils.pixelRatio(),k={stencil:!0,antialias:j,alpha:!0,premultipliedAlpha:!1};this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl",k),this.gl||($info('Using "experimental-webgl"'),this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("experimental-webgl",k)),this.canvas.className="ogma";var m=this.gl;this.setBackgroundColor(g.backgroundColor),m.enable(m.BLEND),m.blendFuncSeparate(m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA,m.SRC_ALPHA,m.ONE),m.enable(m.DEPTH_TEST),m.depthFunc(m.LEQUAL),this._nbAttributesEnabled=0;var n=this;this._createTextureFromCanvas=function(a,b){return l(n,a,b,"text")},this.programs={};for(var o=Object.keys(b.programs),p=0;p<o.length;++p){var q=o[p],r=b.programs[q];this.programs[q]=new b.Program(m,q,r.uniforms,r.attributes,r.varyings,r.functions,r.vertex,r.fragment)}this.shapeList=new Ogma.utils.StaticList({bufferOffset:Int32Array,bufferIndex:Int32Array,components:Array}),this.texturesByUrl={},this.textureCounter=0,this.fontSamplingSize=g.fontSamplingSize,this.minSvgSize=g.minSvgSize,this.bitmapFontCounter=0,this.bitmapFontsByIndex={},this.bitmapFonts={},this.buffersBySubLayer={},this.bufferList=[],this._offset=null,this._renderSteps=[],this._renderSteps.push(new h(this,c,{ratio:this.samplingLevel})),1!==this.samplingLevel&&(this.antiAliasBuffer=this.programs.antialias.createBuffer(),this.antiAliasBuffer.add(),this.antiAliasBuffer.add(),this.antiAliasBuffer.positionOnScreen.set3(0,-1,-1,1,-1,1,1),this.antiAliasBuffer.positionOnScreen.set3(1,1,1,-1,1,-1,-1),this._renderSteps.push(new h(this,d))),this._sortSubLayerFunction=function(a,b){return w(n,a,b)},this.resize(48,48)}function c(a,b,c){b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT|b.STENCIL_BUFFER_BIT),y(a),A(a,c.renderWidth,c.renderHeight)}function d(a,b,c,d){b.disable(b.DEPTH_TEST),b.disable(b.STENCIL_TEST),a._nbAttributesEnabled=a.programs.antialias.prepare(a._nbAttributesEnabled),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,d.texture),b.generateMipmap(b.TEXTURE_2D);var e=a.programs.antialias.uniforms,f=c.renderWidth/(d.textureWidth/d.ratio),g=c.renderHeight/(d.textureHeight/d.ratio);e.texture.set(0),e.screenTextureRatio.set(f,g),a.antiAliasBuffer.draw()}function e(a){return"number"==typeof a&&a%1===0&&a>=0}function f(a,b,c,d){if(e(c)){var g=a.shapeList.attributes,h=g.components[c];if(h)for(var i=0;i<h.length;++i)f(a,b,h[i],d);else{var j=g.bufferIndex[c],k=g.bufferOffset[c],l=a.bufferList[j];"depth"===b&&l.transparency&&d>=0&&(d-=K),l[b].set(k,d),a.refresh()}}}function g(a,b,c,d,f,h,i){if(e(c)){var j=a.shapeList.attributes,k=j.components[c];if(k)for(var l=0;l<k.length;++l)g(a,b,k[l],d,f,h,i);else{var m=j.bufferIndex[c],n=j.bufferOffset[c],o=a.bufferList[m];o[b].set(n,d,f,h,i),a.refresh()}}}function h(b,c,d,f,g,i,j,k,l,m,n){var o,p,q=b.shapeList.attributes;if(e(c)&&q.bufferIndex[c]!==-2){if(o=b.bufferList[q.bufferIndex[c]],p=q.bufferOffset[c],q.components[c]||!o||o.programName!==f||o.texture!==m)return b.delete(c),h(b,-1,d,f,g,i,j,k,l,m,n);o.animation.set(p,+b.animationMode,b.currentTime,b.animationDuration),k!==a&&o.depth.set(p,k)}else{c=b.shapeList.add(),q.components[c]=a;var s=r(b.buffersBySubLayer,d),t=r(s,f);o=t[m],o||(o=b.programs[f].createBuffer(),o.index=b.bufferList.length,o.transparency=n,o.texture=m,t[m]=o,b.bufferList.push(o)),p=o.add(),q.components[c]=a,q.bufferOffset[c]=p,q.bufferIndex[c]=o.index,o.animation.set(p,0,0,0),o.depth.set(p,$or(k,1))}var u=b._offset||L;return o.absolutePosition.shift(p,g.x+u.x,g.y+u.y,i.x+u.x,i.y+u.y,j.x+u.x,j.y+u.y),o.zoomOffset.shift(p,g.zx+u.zx,g.zy+u.zy,i.zx+u.zx,i.zy+u.zy,j.zx+u.zx,j.zy+u.zy),o.offset.shift(p,g.ox+u.ox,g.oy+u.oy,i.ox+u.ox,i.oy+u.oy,j.ox+u.ox,j.oy+u.oy),o.visibilityCondition1.set(p,0,0,0,0),o.visibilityCondition2.set(p,0,0,0,0),"lineText"!==f&&"linePolygon"!==f&&o.angleOffset.shift(p,g.ax+u.ax,g.ay+u.ay,i.ax+u.ax,i.ay+u.ay,j.ax+u.ax,j.ay+u.ay),"circle"===f&&o.circleMultiplier.set2x3(p,-1,1,-1,-F,F,1),o.symbolicSize.set(p,l),b.refresh(),c}function i(b,c,d,e,f,g,i,j,k,l){k===a&&(k=-1),l===a&&(l="default");var m=b.getSubLayer(d);return h(b,c,d,e,f,g,i,j,k,l,m.transparency)}function j(a,b){a.texturesByUrl[b]||a.imageManager.use(b,function(c){var d=b.endsWith(".svg"),e=l(a,c,null,d?"svg":null);e.width=c.width,e.height=c.height,a.texturesByUrl[b]=e,a.refresh()})}function k(a,b,c){var d=b.width,e=b.height,f=!1;if(c&&a.minSvgSize){var g=Math.max(a.minSvgSize/d,a.minSvgSize/e);g>1&&(d=d*g|0,e=e*g|0,f=!0)}if(Ogma.utils.isPowerOfTwo(d)&&Ogma.utils.isPowerOfTwo(e)||(d=Ogma.utils.upperPowerOf(d,2),e=Ogma.utils.upperPowerOf(e,2),f=!0),f){var h=document.createElement("canvas"),i=h.getContext("2d");return h.width=d,h.height=e,i.drawImage(b,0,0,d,e),h}return b}function l(a,b,c,d){var e,f,g=a.gl;c?(f=c.texture,e=c):(f=g.createTexture(),e={index:a.textureCounter,texture:f},a.textureCounter+=1),b=k(a,b,"svg"===d),g.bindTexture(g.TEXTURE_2D,f);try{g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,b)}catch(b){console.error(b),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,a.imageManager.getErrorImage())}return g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,"text"===d?g.LINEAR:g.NEAREST_MIPMAP_LINEAR),g.generateMipmap(g.TEXTURE_2D),g.bindTexture(g.TEXTURE_2D,null),e}function m(b,c){if(c!==a&&!b.subLayers[c])throw new Error('Sub-layer "'+c+'" does not exist.');return c}function n(a,b,c,d,e,f,g,h,j,k,l,n,o){k=m(a,k),Q.ax=(c.ax+f.ax)/2,Q.ay=(c.ay+f.ay)/2,Q.zx=(c.zx+f.zx)/2,Q.zy=(c.zy+f.zy)/2,Q.ox=(c.ox+f.ox)/2,Q.oy=(c.oy+f.oy)/2,o(0,c,d,e,f,Q,N),o(1/M,c,d,e,f,Q,O),Ogma.utils.lineFromBoundaries(N,O,g,h,R,S,T,U);for(var p=a.updateComposite(b,2*M),q=2;q<=M;++q)o(q/M,c,d,e,f,Q,P),Ogma.utils.lineFromBoundaries(O,P,g,h,V,W,X,Y),p[2*(q-2)]=i(a,p[2*(q-2)],k,"polygon",R,S,W,l,n),p[2*(q-2)+1]=i(a,p[2*(q-2)+1],k,"polygon",W,V,R,l,n),N.set(O),O.set(P),R.set(V),S.set(W);for(Ogma.utils.lineFromBoundaries(N,f,g,h,V,W,X,Y),p[2*M-2]=i(a,p[2*M-2],k,"polygon",V,W,X,l,n),p[2*M-1]=i(a,p[2*M-1],k,"polygon",X,Y,V,l,n),q=0;q<p.length;++q)a.setColor(p[q],j);return a.composite(b,p)}function o(a,b,c,d,e,f,g){Ogma.geometry.getPointOnQuadraticCurve(a,b.x,b.y,e.x,e.y,c.x,c.y,g),g.add(f)}function p(a,b,c,d,e,f,g){Ogma.geometry.getPointOnBezierCurve(a,b.x,b.y,e.x,e.y,c.x,c.y,d.x,d.y,g),g.add(f)}function q(a,b,c,d,e,f,g,h,i,j,k,l){var m=a.shapeList.attributes,n=m.bufferIndex[b],o=m.bufferOffset[b],p=a.bufferList[n];c||(p.textureBox.set(o,e,f),p.duplicate.set(o,+d)),p.textureCoords.set2x3(o,g,h,i,j,k,l)}function r(a,b){var c=a[b];return c||(c={},a[b]=c),c}function s(a,b,c){"italic"!==c&&"bold"!==c&&(c="none");var d=a.bitmapFonts[b];d||(d={},a.bitmapFonts[b]=d);var e=d[c];return e||(e=new Ogma.renderers.webgl.BitmapFont(b,c,a._createTextureFromCanvas,a.defaultFont,a.fontSamplingSize),e.index=a.bitmapFontCounter++,a.bitmapFontsByIndex[e.index]=e,d[c]=e),e}function t(a,b,c,d,e,f,g,h,j,k,l,n,o,p,q){n=m(a,n);for(var r,t,w=0,x=g,y=f,z=q?"lineText":"text",A=s(a,e,j),B=0;B<d.length;++B){var C=A.get(d[B]);w+=C.ratio}r=w*f,w*=g,Z.reset(),"center"===k?(Z.ox-=w/2,Z.zx-=r/2):"right"===k&&(Z.ox-=w,Z.zx-=r),"middle"===l?(Z.oy-=x/2,Z.zy-=y/2):"bottom"===l&&(Z.oy-=x,Z.zy-=y),G.set(c).add(Z),H.set(c).add(Z),I.set(c).add(Z),J.set(c).add(Z),H.oy+=x,J.oy+=x,H.zy+=y,J.zy+=y;var D=a.updateComposite(b,2*d.length),E=A.index;for(B=0;B<d.length;++B){var F=A.get(d[B]);t=F.ratio,I.ox=G.ox+g*t,J.ox=H.ox+g*t,I.zx=G.zx+f*t,J.zx=H.zx+f*t,D[2*B]=i(a,D[2*B],n,z,G,I,J,o,p,E),D[2*B+1]=i(a,D[2*B+1],n,z,J,H,G,o,p,E),a.setColor(D[2*B],h,!0),a.setColor(D[2*B+1],h,!0),u(a,D[2*B],F.x1,F.y1,F.x2,F.y1,F.x2,F.y2,f,g),u(a,D[2*B+1],F.x2,F.y2,F.x1,F.y2,F.x1,F.y1,f,g),q&&(v(a,D[2*B],q.textWidth,q.textHeight,q.ratio,q.angle,q.length,q.size,q.strokeSize),v(a,D[2*B+1],q.textWidth,q.textHeight,q.ratio,q.angle,q.length,q.size,q.strokeSize)),G.set(I),H.set(J)}return a.composite(b,D)}function u(a,b,c,d,e,f,g,h,i,j){var k=a.shapeList.attributes,l=k.bufferIndex[b],m=k.bufferOffset[b],n=a.bufferList[l];n.textureCoords.set2x3(m,c,d,e,f,g,h)}function v(a,b,c,d,e,f,g,h,i){var j=a.shapeList.attributes,k=j.bufferIndex[b],l=j.bufferOffset[b],m=a.bufferList[k];m.textDimensions.set(l,c,d,e),m.lineInfo.set(l,f,g,h,i)}function w(a,b,c){return x(a,b)-x(a,c)}function x(a,b){if("undefined"===b)return 1e4;var c=a.subLayers[b],d=c.level;return c.transparency&&(d+=5e3),d}function y(a){Ogma.utils.forEach(a.bitmapFonts,function(a){Ogma.utils.forEach(a,function(a){a.updateIfNecessary()})})}function z(a,b){b.defineClipSpace||b.useClipSpace?(a.enable(a.STENCIL_TEST),a.stencilOp(a.KEEP,a.KEEP,a.REPLACE),b.defineClipSpace?(a.clear(a.STENCIL_BUFFER_BIT),a.depthFunc(a.LEQUAL),a.stencilFunc(a.ALWAYS,1,1)):(a.depthFunc(a.EQUAL),a.stencilFunc(a.EQUAL,1,1))):(a.depthFunc(a.LEQUAL),a.disable(a.STENCIL_TEST))}function A(a,b,c){var d=a.gl,e=a.buffersBySubLayer,f=Object.keys(e).sort(a._sortSubLayerFunction),g=Ogma.utils.pixelRatio();d.enable(d.DEPTH_TEST);for(var h=0;h<f.length;++h){var i=f[h],j=a.subLayers[i]||a.DEFAULT_LAYER,k=e[i],l=Object.keys(a.programs),m=j.camera;if(!j.disabled){z(d,j);for(var n=0;n<l.length;++n){var o=l[n],p=k[o];if(p){var q=a.programs[o],r=q.uniforms,s=Object.keys(p);a._nbAttributesEnabled=q.prepare(a._nbAttributesEnabled),r.pixelRatio.set(g),r.textureMultiplier.set(a.samplingLevel),r.animationMode.set(+a.animationsEnabled),r.symbolicSizeThreshold.set(j.symbolicSizeThreshold),r.screenSize.set(b,c),r.camPosition.set(m.x,m.y),r.camAngle.set(m.angle),r.cosCamAngle.set(Math.cos(m.angle)),r.sinCamAngle.set(Math.sin(m.angle)),r.camZoom.set(m.zoom),r.currentTime.set(a.currentTime),r.vcMargin.set(a._visibilityConditionTolerance);for(var t=0;t<s.length;++t){var u=s[t],v=p[u];if("nonScaledImage"===o||"image"===o){var w=a.texturesByUrl[u];if(!w)continue;d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,w.texture),q.uniforms.texture.set(0),"nonScaledImage"===o&&r.textureDimensions.set(w.width,w.height)}else if("text"===o||"lineText"===o){var x=a.bitmapFontsByIndex[u],y=x.bigTexture;d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,y.texture),q.uniforms.bigTexture.set(0)}v.draw()}}}}}}var Ogma=$global.Ogma;$global.webgl={};var B=4096,C=4096,D=!1;if("undefined"!=typeof document)try{var E=document.createElement("canvas").getContext("webgl")||document.createElement("canvas").getContext("experimental-webgl");D=!!E}catch(a){}var F=Math.SQRT2+1;b.prototype=Object.create(Ogma.renderers.dummy.prototype),b.prototype.constructor=b,b.prototype.render=function(a){for(var b=null,c=0;c<this._renderSteps.length;++c){var d=this._renderSteps[c];d.render(b),b=d}this.gl.flush()},b.prototype.resize=function(a,b){Ogma.utils.resizeElement(this.canvas,a,b),this.width=a,this.height=b;for(var c=0,d=this._renderSteps.length;c<d;++c)this._renderSteps[c].resize(a,b,c!==d-1);this.refresh()},b.prototype.usedMemory=function(){var a=this.bufferList.map(function(a){return a._attributeList.map(function(b){return 4*a[b]._content.length}).reduce(function(a,b){return a+b})},0).reduce(function(a,b){return a+b},0);return(a/1e3|0)+"K"};var G=new Ogma.utils.Position,H=new Ogma.utils.Position,I=new Ogma.utils.Position,J=new Ogma.utils.Position;b.prototype.setDepth=function(a,b){f(this,"depth",a,b),this.refresh()},b.prototype.setSymbolicSize=function(a,b){f(this,"symbolicSize",a,b),this.refresh()},b.prototype.setVisibilityCondition1=function(a,b,c,d,e){g(this,"visibilityCondition1",a,c,d,e,+b),this.refresh()},b.prototype.setVisibilityCondition2=function(a,b,c,d,e){g(this,"visibilityCondition2",a,c,d,e,+b),this.refresh()},b.prototype.reloadFonts=function(){Ogma.utils.forEach(this.bitmapFonts,function(a){Ogma.utils.forEach(a,function(a){a.reload()})})},b.infoName="WebGL";var K=Ogma.constants.EPSILON;b.prototype.updateComposite=function(a,b){var c=this.shapeList.attributes;if(!e(a)||c.bufferIndex[a]===-2)return[];var d=c.components[a];if(!d)return this.deleteTriangle(a),[];if(d.length!==b){for(var f=0;f<d.length;++f)this.delete(d[f]);return[]}return d},b.prototype.composite=function(a,b){var c,d=this.shapeList.attributes;if(e(a)&&d.bufferIndex[a]!==-2){var f=d.components[a];f!==b&&(d.components[a]=b),c=a}else{var g=this.shapeList.add();d.bufferIndex[g]=-1,d.bufferOffset[g]=-1,d.components[g]=b,c=g}return c},b.prototype.setColor=function(a,b,c){if(e(a)){var d=this.shapeList.attributes,f=d.components[a];if(f)for(var g=0;g<f.length;++g)this.setColor(f[g],b,c);else{var h=d.bufferIndex[a],i=d.bufferOffset[a],j=this.bufferList[h],k=4*Ogma.colors.getIndex(b),l=Ogma.colors.rgba;if("shadowPolygon"===j.programName||"shadowCircle"===j.programName)return;this.animationMode&&j.prevColor.copy(j.color,i),this.shadowsEnabled?j.color.set(i,0,0,0,.9):j.color.set(i,l[k],l[k+1],l[k+2],c?0:l[k+3]),this.refresh()}}},b.prototype.stopAnimations=function(){for(var a=this.bufferList,b=a.length,c=0;c<b;++c)a[c].animation.fill(0);this.refresh()};var L=new Ogma.utils.Position;b.prototype._nbTriangles=function(){for(var a=0,b=0;b<this.bufferList.length;++b)a+=this.bufferList[b]._nbTriangles;return a},b.prototype.delete=function(b){if(!e(b))return-1;var c=this.shapeList.attributes,d=c.bufferIndex[b],f=c.components[b];if(d===-2)return-1;if(f)for(var g=0;g<f.length;++g)this.delete(f[g]);else this.deleteTriangle(b);return c.bufferIndex[b]=-2,c.components[b]=a,this.shapeList.remove(b),this.refresh(),-1},b.prototype.deleteTriangle=function(a){var b=this.shapeList.attributes,c=b.bufferIndex[a],d=b.bufferOffset[a],e=this.bufferList[c];e.remove(d)},b.prototype.domElement=function(){return this.canvas},b.available=D,b.prototype.triangle=function(a,b,c,d,e,f,g,h){var j=i(this,a,m(this,f),"polygon",b,c,d,g,h);return this.setColor(j,e),j},b.prototype.circle=function(a,b,c,d,e,f,g,h){return G.set(b).addZXY(-c,c).addOXY(-d,d),H.set(b).addZXY(-c,-c*F).addOXY(-d,-d*F),I.set(b).addZXY(c*F,c).addOXY(d*F,d),this._relativeRadius=c,this._absoluteRadius=d,a=i(this,a,m(this,f),"circle",G,H,I,g,h),this.setColor(a,e),a},b.prototype.rectangle=function(a,b,c,d,e,f,g,h){return Ogma.utils.rectangleFromCenterAndDimensions(b,c,G,H,I,J),this.quadrilateral(a,G,H,I,J,d,e,f,g,h)},b.prototype.quadrilateral=function(a,b,c,d,e,f,g,h,j,k){var l=k?"linePolygon":"polygon";g=m(this,g);var n=this.updateComposite(a,2);return n[0]=i(this,n[0],g,l,b,c,d,h,j),n[1]=i(this,n[1],g,l,d,e,b,h,j),k&&(v(this,n[0],k.textWidth,k.textHeight,k.ratio,k.angle,k.length,k.size,k.strokeSize),v(this,n[1],k.textWidth,k.textHeight,k.ratio,k.angle,k.length,k.size,k.strokeSize)),a=this.composite(a,n),this.setColor(a,f),a},b.prototype.polygon=function(a,b,c,d,e,f){if(!b instanceof Ogma.utils.PositionList)throw new Error('Argument "points" must be of type Ogma.utils.PositionList.');if(b.length<3)throw new Error("A polygon must have at least 3 points.");d=m(this,d);for(var g=Ogma.geometry.triangulatePolygon(b.getXYList()),h=this.updateComposite(a,g.length),j=0;j<g.length;++j){var k=g[j],l=b[k[0]],n=b[k[1]],o=b[k[2]];h[j]=i(this,h[j],d,"polygon",l,n,o,e,f),this.setColor(h[j],c)}return this.composite(a,h)};var M=50,N=new Ogma.utils.Position,O=new Ogma.utils.Position,P=new Ogma.utils.Position,Q=new Ogma.utils.Position,R=new Ogma.utils.Position,S=new Ogma.utils.Position,T=new Ogma.utils.Position,U=new Ogma.utils.Position,V=new Ogma.utils.Position,W=new Ogma.utils.Position,X=new Ogma.utils.Position,Y=new Ogma.utils.Position;b.prototype.quadraticCurve=function(a,b,c,d,e,f,g,h,i,j){return n(this,a,b,c,c,d,e,f,g,h,i,j,o)},b.prototype.cubicCurve=function(a,b,c,d,e,f,g,h,i,j,k){return n(this,a,b,c,d,e,f,g,h,i,j,k,p)},b.prototype.line=function(a,b,c,d,e,f,g,h,i){return Ogma.utils.lineFromBoundaries(b,c,d,e,G,H,I,J),this.quadrilateral(a,G,H,I,J,f,g,h,i)},b.prototype.image=function(a,b,c,d,e,f,g,h,k){j(this,d),Ogma.utils.rectangleFromCenterAndDimensions(b,c,G,H,I,J),g=m(this,g);var l=e?"image":"nonScaledImage",n=this.updateComposite(a,2);return n[0]=i(this,n[0],g,l,G,H,I,h,k,d),n[1]=i(this,n[1],g,l,I,J,G,h,k,d),q(this,n[0],e,f,2*c.zx,2*c.zy,0,0,1,0,1,1),q(this,n[1],e,f,2*c.zx,2*c.zy,1,1,0,1,0,0),this.composite(a,n)};var Z=new Ogma.utils.Position;b.prototype.text=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return t(this,a,b,c,d,e,f,g,h,i,j,k,l,m,n)},b.prototype.textWidth=function(a,b,c,d){for(var e=s(this,b,d),f=0,g=0;g<a.length;++g){var h=e.get(a[g]);f+=h.ratio}return f*c},b.prototype.clear=function(){this.shapeList.clear(),this.shapeList.attributes.bufferIndex.fill(-2);for(var a=0;a<this.bufferList.length;++a)this.bufferList[a].clear()},b.prototype.setBackgroundColor=function(a){if(a){var b=4*Ogma.colors.getIndex(a),c=Ogma.colors.rgba;this.gl.clearColor(c[b],c[b+1],c[b+2],c[b+3])}else this.gl.clearColor(0,0,0,0)},Ogma.renderers.webgl=b}.call(),function(a){function b(a,b,c,d){n.call(this,a,b,c,d||{}),this.canvas=Ogma.utils.createCanvas(a,b),this.ctx=this.canvas.getContext("2d"),this.backgroundColor=d.backgroundColor,this.atomicShapes=[],this.nbAtomicShapes=0,this.shapes=new Ogma.utils.StaticList({type:Int8Array,components:Array,info:Array,prevInfo:Array,depth:Float32Array,subLayer:Array,symbolicSize:Float32Array,animationDuration:Float32Array,creationDate:Int32Array,visibilityCondition1:Array,visibilityCondition2:Array}),this._refresh=function(){this.refresh()}.bind(this)}function c(a){return"number"==typeof a&&a%1===0&&a>=0}function d(a,b){g(a,b),f(a,b)}function e(a,b,d,f,g){var h=a.shapes.attributes;if(c(b)&&h.type[b]!==o.DELETED)if(h.type[b]===o.COMPOSITE)for(var i=h.components[b],j=0;j<i.length;++j)e(a,i[j],d,f,g);else"depth"===d&&h.subLayer[b].transparency&&(f-=m),h[d][b]=f,g&&g(a,b)}function f(a,b){var c=a.shapes.attributes,d=a.atomicShapes,e=a.atomicShapes.length,f=c.depth[b],g=c.subLayer[b],h=g.level;if(!(f<0)){for(var i=0;i<e;++i){var j=d[i],k=c.depth[j],l=c.subLayer[j],m=l.level;if(f<k||f===k&&h<m)break}i===e?d.push(b):d.splice(i,0,b),a.nbAtomicShapes+=1,a.refresh()}}function g(a,b){var c=a.atomicShapes.lastIndexOf(b,a.nbAtomicShapes-1);a.nbAtomicShapes>0&&c!==-1&&(a.atomicShapes.splice(c,1),a.nbAtomicShapes-=1)}function h(b,e,g,h,i,j,k){k===a&&(k=-1);var l=b.shapes.attributes,n=!0;if(c(e)&&l.type[e]!==o.DELETED)if(l.type[e]===o.COMPOSITE)for(var p=l.components[e],q=0;q<p.length;++q)b.delete(p[q]);else n=!1;else e=b.shapes.add();var r=b.getSubLayer(i);return(n||j!==a)&&(j=$or(j,1),r.transparency&&(j-=m),l.depth[e]=j),l.components[e]=a,l.prevInfo[e]=n||!b.animationMode?a:l.info[e],l.creationDate[e]=b.currentTime,l.animationDuration[e]=b.animationMode?b.animationDuration:0,l.info[e]=h,l.visibilityCondition1[e]=null,l.visibilityCondition2[e]=null,l.type[e]=g,l.subLayer[e]=r,l.symbolicSize[e]=k,n?f(b,e):d(b,e),e}function i(b){if(!b)return a;for(var c={},d=0;d<t.length;++d){var e=t[d];c[e]=b[e]}return c}function j(a,b){var c=a._offset,d=Ogma.utils.deepCopy(b);return c&&(d.x+=c.x,d.y+=c.y,d.zx+=c.zx,d.zy+=c.zy,d.ax+=c.ax,d.ay+=c.ay,d.ox+=c.ox,d.oy+=c.oy),d}function k(a){for(var b=0;b<a.length;++b)if(z.indexOf(a.charAt(b))===-1)return!1;return!0}var Ogma=$global.Ogma,l="undefined"!=typeof document&&null!=document.createElement("canvas").getContext("2d"),m=Ogma.constants.EPSILON,n=Ogma.renderers.dummy;b.prototype=Object.create(n.prototype),b.prototype.constructor=b,b.prototype.clear=function(){this.shapes.clear(),this.shapes.attributes.type.fill(o.DELETED),this.atomicShapes=[],this.nbAtomicShapes=0},b.prototype.domElement=function(){return this.canvas},b.prototype.resize=function(a,b){Ogma.utils.resizeElement(this.canvas,a,b),this.refresh(),this.width=a,this.height=b},b.available=l,b.prototype.delete=function(a){var b=this.shapes.attributes;if(!c(a)||b.type[a]===o.DELETED)return-1;if(b.type[a]===o.COMPOSITE)for(var d=b.components[a],e=0;e<d.length;++e)this.delete(d[e]);else g(this,a);return b.type[a]=o.DELETED,this.shapes.remove(a),-1},b.prototype.updateComposite=function(a,b){var d=this.shapes.attributes,e=d.type[a];if(!c(a)||e===o.DELETED)return[];var f=d.components[a];if(e!==o.COMPOSITE)return g(this,a),d.type[a]=o.COMPOSITE,[];if(f.length!==b){for(var h=0;h<f.length;++h)this.delete(f[h]);return[]}return f},b.prototype.composite=function(a,b){var d=this.shapes.attributes;if(c(a)&&d.type[a]===o.COMPOSITE){var e=d.components[a];return e!==b&&(d.components[a]=b),a}var f=this.shapes.add();return d.type[f]=o.COMPOSITE,d.components[f]=b,f},b.prototype.setDepth=function(a,b){e(this,a,"depth",b,d),this.refresh()},b.prototype.setSymbolicSize=function(a,b){e(this,a,"symbolicSize",b),this.refresh()},b.prototype.setColor=function(a,b){e(this,a,"color",b),this.refresh()},b.prototype.setVisibilityCondition1=function(a,b,c,d,f){e(this,a,"visibilityCondition1",b?[c,d,f]:null)},b.prototype.setVisibilityCondition2=function(a,b,c,d,f){e(this,a,"visibilityCondition2",b?[c,d,f]:null)};var o={DELETED:-1,COMPOSITE:0,POLYGON:1,CIRCLE:2,IMAGE:3,TEXT:4,LINE:5,QUADRATIC:6,CUBIC:7},p=new Ogma.utils.Position,q=new Ogma.utils.Position,r=new Ogma.utils.Position,s=new Ogma.utils.Position,t=["textWidth","textHeight","angle","length","size","strokeSize","ratio"];b.prototype.triangle=function(b,c,d,e,f,g,i,k){return h(this,b,o.POLYGON,[f,a,j(this,c),j(this,d),j(this,e)],g,i,k)},b.prototype.circle=function(a,b,c,d,e,f,g,i){return h(this,a,o.CIRCLE,[e,j(this,b),c,d],f,g,i)},b.prototype.rectangle=function(a,b,c,d,e,f,g,h){return Ogma.utils.rectangleFromCenterAndDimensions(b,c,p,q,r,s),this.quadrilateral(a,p,q,r,s,d,e,f,g,h)},b.prototype.quadrilateral=function(a,b,c,d,e,f,g,k,l,m){return h(this,a,o.POLYGON,[f,i(m),j(this,b),j(this,c),j(this,d),j(this,e)],g,k,l)},b.prototype.polygon=function(a,b,c,d,e,f){var g=new Array(b.length+2);g[0]=c;for(var i=0;i<b.length;++i)g[i+2]=j(this,b[i]);return h(this,a,o.POLYGON,g,d,e,f)},b.prototype.line=function(a,b,c,d,e,f,g,i,k){return h(this,a,o.LINE,[f,d,e,j(this,b),j(this,c)],g,i,k)},b.prototype.quadraticCurve=function(a,b,c,d,e,f,g,i,k,l){return h(this,a,o.QUADRATIC,[g,e,f,j(this,b),j(this,c),j(this,d)],i,k,l)},b.prototype.cubicCurve=function(a,b,c,d,e,f,g,i,k,l,m){return h(this,a,o.CUBIC,[i,f,g,j(this,b),j(this,c),j(this,d),j(this,e)],k,l,m)},b.prototype.image=function(a,b,c,d,e,f,g,i,k){return this.imageManager.use(d,this._refresh,!0),h(this,a,o.IMAGE,[d,j(this,b),j(this,c),e,f],g,i,k)},b.prototype.text=function(a,b,c,d,e,f,g,k,l,m,n,p,q,r){return h(this,a,o.TEXT,[g,c,j(this,b),e,f,d,k,l,m,i(r)],n,p,q)};var u=null,v=null,w=null,x=null,y=null;"undefined"!=typeof document&&(u=document.createElement("canvas"),v=u.getContext("2d")),b.prototype.textWidth=function(a,b,c,d){return b===x&&c===w&&d===y||(v.font=("italic"===d||"bold"===d?d+" ":"")+c+"px "+b,w=c,x=b,y=d),v.measureText(a).width};var z="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ";b.prototype.stopAnimations=function(){this.shapes.attributes.animationDuration.fill(0),this._refresh()},b.prototype.setBackgroundColor=function(a){this.options.backgroundColor=a};var A=2*Math.PI,B=Math.PI/2,C=Math.PI,D=new Array(128);b.prototype.render=function(b){function c(b,c,d){var e,f,g,i,j=fa[b],k=L!==-1?ga[b]:a,l=c!==a?fa[c]:a;if(l){I=0;var m,n,o=l.size*Y;if(l.ratio===-1?(m=l.textWidth,n=l.textHeight):(m=l.textWidth*Y,n=l.textHeight*Y),l.length>-99999&&l.length*Y<m)H=0;else{H=X-l.angle;
var p=-1;H<-B?(H+=C,H<-B&&(H+=C)):H>B?(H-=C,H>B&&(H-=C)):p=1,l.length<-99999&&(p=-1),I=p*((n+o)/2+l.strokeSize)}e=(j.x-V)*Y,f=(j.y-W)*Y;var s=Z*e+$*f,t=-$*e+Z*f;if(d)if(I+=j.oy,k){e=(k.x-V)*Y,f=(k.y-W)*Y;var u=Z*e+$*f,v=-$*e+Z*f;q=u+(s-u)*L,r=v+(t-v)*L}else q=s,r=t;else{var w=Math.cos(H),x=Math.sin(H),y=j.ox+j.zx*Y,z=j.oy+j.zy*Y+I;q=w*y+x*z+s,r=-x*y+w*z+t,k&&(e=(k.x-V)*Y,f=(k.y-W)*Y,u=Z*e+$*f,v=-$*e+Z*f,g=w*y+x*z+u,i=-x*y+w*z+v,q=g+(q-g)*L,r=i+(r-i)*L)}}else e=(j.x-V)*Y+j.ax,f=(j.y-W)*Y+j.ay,q=Z*e+$*f+j.zx*Y+j.ox,r=-$*e+Z*f+j.zy*Y+j.oy,k&&(e=(k.x-V)*Y+k.ax,f=(k.y-W)*Y+k.ay,g=Z*e+$*f+k.zx*Y+k.ox,i=-$*e+Z*f+k.zy*Y+k.oy,q=g+(q-g)*L,r=i+(r-i)*L);q*=h,r*=h}function d(){s=ga&&L!==-1?(ga[2]+(fa[2]-ga[2])*L)*Y+(ga[3]+(fa[3]-ga[3])*L):fa[2]*Y+fa[3],s*=h}function e(){if(ga&&L!==-1){var a=4*Ogma.colors.getIndex(ga[0]),b=4*Ogma.colors.getIndex(fa[0]);if(a===b)J=fa[0];else{var c=K[a]+(K[b]-K[a])*L,d=K[a+1]+(K[b+1]-K[a+1])*L,e=K[a+2]+(K[b+2]-K[a+2])*L,f=K[a+3]+(K[b+3]-K[a+3])*L;J="rgba("+(255*c|0)+", "+(255*d|0)+", "+(255*e|0)+", "+f+")"}}else J=fa[0]}function f(){var a=N-i.creationDate[Q];L=ga&&M&&a<i.animationDuration[Q]?a/i.animationDuration[Q]:-1}function g(a){if(!a)return!0;var b=(a[0]-V)*Y,c=(a[1]-W)*Y;return q=Z*b+$*c,r=-$*b+Z*c,s=a[2]*Y,q+s>-O&&r+s>-O&&q-s<n+O&&r-s<p+O}var h=Ogma.utils.pixelRatio(),i=this.shapes.attributes,j=this.atomicShapes,l=this.nbAtomicShapes,m=this.ctx,n=this.width,p=this.height,q=0,r=0,s=0,t=null,u=null,v=null,w=null,x=null,y=-1,z=D,E=0,F=null,G=!1,H=0,I=0,J="black",K=Ogma.colors.rgba,L=-1,M=this.animationsEnabled,N=this.currentTime,O=this._visibilityConditionTolerance;this.options.backgroundColor?(m.fillStyle=this.options.backgroundColor,m.fillRect(0,0,n*h,p*h)):m.clearRect(0,0,n*h,p*h);for(var P=0;P<l;++P){var Q=j[P],R=i.subLayer[Q],S=i.symbolicSize[Q],T=R.symbolicSizeThreshold,U=R.camera,V=U.x,W=U.y,X=U.angle,Y=U.zoom,Z=Math.cos(X),$=Math.sin(X);if(!(R.disabled||S!==-1&&S*R.camera.zoom<T)){var _=i.visibilityCondition1[Q],aa=i.visibilityCondition2[Q];if(g(_)||g(aa)){if(R.defineClipSpace){var ba=i.depth[Q];y!==ba||F!==R?(y=ba,F=R,E=1,z[0]=Q):(z[E]=Q,E+=1)}else if(R.useClipSpace&&i.depth[Q]===y&&i.type[Q]!==o.TEXT){for(Y=i.subLayer[Q].camera.zoom,G=!0,m.save(),m.beginPath(),ha=0;ha<E;++ha){var ca=z[ha];if(ea=i.type[ca],fa=i.info[ca],ga=i.prevInfo[ca],f(),ea===o.POLYGON){for(var da=2;da<fa.length;++da)c(da),m[2===da?"moveTo":"lineTo"](q,r);m.closePath()}else ea===o.CIRCLE&&(c(1),s=fa[2]*Y+fa[3],m.arc(q,r,s,0,A))}m.clip()}var ea=i.type[Q],fa=i.info[Q],ga=i.prevInfo[Q];if(f(),ea===o.POLYGON||ea===o.TEXT||ea===o.CIRCLE?(e(),m.fillStyle=J,m.strokeStyle=J,m.lineWidth=.08*h):ea!==o.LINE&&ea!==o.QUADRATIC&&ea!==o.CUBIC||(e(),m.strokeStyle=J,m.lineWidth=(fa[1]*Y+fa[2])*h),m.beginPath(),ea===o.POLYGON){for(var ha=2;ha<fa.length;++ha)c(ha,1),1===ha?m.moveTo(q,r):m.lineTo(q,r);m.closePath(),m.fill(),m.stroke()}else if(ea===o.CIRCLE)c(1),d(),m.arc(q,r,s,0,A),m.fill();else if(ea===o.LINE)c(3),m.moveTo(q,r),c(4),m.lineTo(q,r),m.stroke();else if(ea===o.QUADRATIC){c(3),m.moveTo(q,r),c(4);var ia=q,ja=r;c(5),m.quadraticCurveTo(ia,ja,q,r),m.stroke()}else if(ea===o.CUBIC){c(3),m.moveTo(q,r),c(4);var ka=q,la=r;c(5);var ma=q,na=r;c(6),m.bezierCurveTo(ka,la,ma,na,q,r),m.stroke()}else if(ea===o.TEXT){var oa=fa[3],pa=fa[4],qa=fa[5],ra=fa[6],sa=fa[7],ta=fa[8],ua=(oa*Y+pa)*h,va=fa[1];if("FontAwesome"===qa&&k(va)&&(qa=this.defaultFont),ua!==u||qa!==t||ra!==v){var wa=("italic"===ra||"bold"===ra?ra+" ":"")+ua+"px "+qa;m.font=wa,u=ua,t=qa,v=ra}sa!==w&&(m.textAlign=sa,w=sa),ta!==x&&(m.textBaseline=ta,x=ta),c(2,9,!0),fa[9]?(m.save(),m.translate(q,r),m.rotate(-H),m.fillText(va,0,I),m.restore()):m.fillText(va,q,r)}else if(ea===o.IMAGE){var xa=this.imageManager.getImage(fa[0]),ya=fa[3],za=fa[4],Aa=fa[2];if(xa){c(1);var Ba=(Aa.zx+Aa.x)*Y+Aa.ox,Ca=(Aa.zy+Aa.y)*Y+Aa.oy;if(ya)m.drawImage(xa,q-Ba,r-Ca,2*Ba,2*Ca);else{if(m.save(),m.beginPath(),m.rect(q-Ba,r-Ca,2*Ba,2*Ca),m.clip(),za){var Da=0,Ea=0,Fa=q-Ba,Ga=r-Ca;for(q-=xa.width/2;q>Fa;)q-=xa.width,Da+=1;for(r-=xa.height/2;r>Ga;)r-=xa.height,Ea+=1;var Ha=r;for(Da=2*Da+1,Ea=2*Ea+1,ha=0;ha<Da;++ha){for(da=0;da<Ea;++da)m.drawImage(xa,q,r,xa.width,xa.height),r+=xa.height;r=Ha,q+=xa.width}}else m.drawImage(xa,q-xa.width/2,r-xa.height/2,xa.width,xa.height);m.restore()}}}G&&(G=!1,m.restore())}}}},Ogma.renderers.canvas=b}.call(),function(a){function b(a,b,d,e){this._gl=a,this._glprogram=d,this.programName=b,this._capacity=h,this._attributeList=Object.keys(e),this._pointSize=0;for(var f=0;f<this._attributeList.length;++f){var g=this._attributeList[f],j=i[e[g]],k=a.getAttribLocation(d,g);if(!j)throw new Error("attribute "+g+" has invalid type "+e[g]);if(k===-1)throw new Error("program "+b+": attribute location "+g+" should not be -1");this[g]=new c(a,g,j,k,h,g),this._pointSize+=j}this._availableOffsets=new Ogma.utils.IndexList,this._nbTriangles=0}function c(a,b,c,d,e,g){this._location=d,this._id=j++,this._gl=a,this._size=c,this._glBuffer=a.createBuffer(),this._eltBuffer=new Float32Array(3*c),this._nbToUpdate=0,this._name=g,this._bufferAll=!0,this.programName=b,this._content=new Float32Array(0),this._toUpdate=new Int8Array(0),1===c?(this.set=this.set1x1,this.set3=this.set1x3):2===c?(this.set=this.set2x1,this.set3=this.set2x3):3===c?(this.set=this.set3x1,this.set3=this.set3x3):4===c&&(this.set=this.set4x1,this.set3=this.set4x3),f(this,e)}function d(a,b){a._bufferAll||a._toUpdate[b]||(a._nbToUpdate+=1,a._nbToUpdate>1e4?a._bufferAll=!0:a._toUpdate[b]=1)}function e(a){var b=a._gl;if(a._bufferAll)b.bufferSubData(b.ARRAY_BUFFER,0,a._content),a._toUpdate.fill(0),a._bufferAll=!1,a._nbToUpdate=0;else if(0!==a._nbToUpdate){for(var c=a._toUpdate,d=c.length,e=3*a._size,f=a._eltBuffer,g=a._content,h=0;h<d;++h)if(c[h]){for(var i=h*e,j=0;j<e;++j)f[j]=g[i+j];b.bufferSubData(b.ARRAY_BUFFER,4*i,f),c[h]=0}a._nbToUpdate=0}}function f(a,b){var c=a._gl;c.bindBuffer(c.ARRAY_BUFFER,a._glBuffer),c.bufferData(c.ARRAY_BUFFER,b*a._size*3*4,c.DYNAMIC_DRAW),c.bufferSubData(c.ARRAY_BUFFER,0,a._content);var d=new Float32Array(b*a._size*3),e=new Int8Array(b);d.set(a._content),e.set(a._toUpdate),a._content=d,a._toUpdate=e}function g(a){var b=a._gl;b.bindBuffer(b.ARRAY_BUFFER,a._glBuffer),e(a),b.vertexAttribPointer(a._location,a._size,b.FLOAT,!1,0,0)}var Ogma=$global.Ogma;Ogma.renderers.webgl.Buffer=b;var h=256,i={float:1,vec2:2,vec3:3,vec4:4};b.prototype.draw=function(){if(0!==this._nbTriangles){for(var a=this._gl,b=0;b<this._attributeList.length;++b){var c=this._attributeList[b];g(this[c])}a.drawArrays(a.TRIANGLES,0,3*this._nbTriangles)}},b.prototype.add=function(){var a;if(this._availableOffsets.size>0)a=this._availableOffsets.pop();else{if(this._nbTriangles===this._capacity){this._capacity=1.5*this._capacity|0;for(var b=0;b<this._attributeList.length;++b){var c=this._attributeList[b];f(this[c],this._capacity)}}a=this._nbTriangles,this._nbTriangles+=1}return a},b.prototype.remove=function(a){return!this._availableOffsets.has(a)&&(this._availableOffsets.add(a),this.depth.set1x1(a,-1),!0)},b.prototype.clear=function(){this._nbTriangles=0,this._availableOffsets.clear()};var j=0;c.prototype.clear=function(){this._bufferAll=!0},c.prototype.copy=function(a,b){d(this,b);var c=this._content,e=a._content,g=3*b*this._size,h=g+3*this._size;c.length<e.length&&(f(this,e.length/(3*this._size)),c=this._content);for(var i=g;i<h;++i)c[i]=e[i]},c.prototype.fill=function(a){this._content.fill(a),this._bufferAll=!0},c.prototype.shift=function(a,b,c,e,f,g,h){d(this,a);var i=this._content;a*=12,i[a+2]=i[a],i[a+3]=i[a+1],i[a+6]=i[a+4],i[a+7]=i[a+5],i[a+10]=i[a+8],i[a+11]=i[a+9],i[a]=b,i[a+1]=c,i[a+4]=e,i[a+5]=f,i[a+8]=g,i[a+9]=h},c.prototype.set1x3=function(a,b,c,e){d(this,a);var f=this._content;a*=3,f[a]=b,f[a+1]=c,f[a+2]=e},c.prototype.set1x1=function(a,b){d(this,a);var c=this._content;a*=3,c[a]=b,c[a+1]=b,c[a+2]=b},c.prototype.set2x3=function(a,b,c,e,f,g,h){d(this,a);var i=this._content;a*=6,i[a]=b,i[a+1]=c,i[a+2]=e,i[a+3]=f,i[a+4]=g,i[a+5]=h},c.prototype.set2x1=function(a,b,c){d(this,a);var e=this._content;a*=6,e[a]=b,e[a+1]=c,e[a+2]=b,e[a+3]=c,e[a+4]=b,e[a+5]=c},c.prototype.set3x3=function(a,b,c,e,f,g,h,i,j,k){d(this,a);var l=this._content;a*=9,l[a]=b,l[a+1]=c,l[a+2]=e,l[a+3]=f,l[a+4]=g,l[a+5]=h,l[a+6]=i,l[a+7]=j,l[a+8]=k},c.prototype.set3x1=function(a,b,c,e){d(this,a);var f=this._content;a*=9,f[a]=b,f[a+1]=c,f[a+2]=e,f[a+3]=b,f[a+4]=c,f[a+5]=e,f[a+6]=b,f[a+7]=c,f[a+8]=e},c.prototype.set4x3=function(a,b,c,e,f,g,h,i,j,k,l,m,n){d(this,a);var o=this._content;a*=12,o[a]=b,o[a+1]=c,o[a+2]=e,o[a+3]=f,o[a+4]=g,o[a+5]=h,o[a+6]=i,o[a+7]=j,o[a+8]=k,o[a+9]=l,o[a+10]=m,o[a+11]=n},c.prototype.set4x1=function(a,b,c,e,f){d(this,a);var g=this._content;a*=12,g[a]=b,g[a+1]=c,g[a+2]=e,g[a+3]=f,g[a+4]=b,g[a+5]=c,g[a+6]=e,g[a+7]=f,g[a+8]=b,g[a+9]=c,g[a+10]=e,g[a+11]=f}}.call(),function(a){function b(a,b,d,e,f,j,k,l){var m=c(d),n=c(e),o=c(f),p=i(a,b,g(m,n,o,j,k),!0),q=i(a,b,h(m,o,j,l),!1),r=a.createProgram();if(a.attachShader(r,p),a.attachShader(r,q),a.linkProgram(r),!a.getProgramParameter(r,a.LINK_STATUS))throw new Error("unable to initialize WebGL program "+b+": \n"+a.getProgramInfoLog(r));this._gl=a,this.programName=b,this._glProgram=r,this._attributeDef=n,this._attributeList=Object.keys(n),this.uniforms=new Ogma.renderers.webgl.UniformList(a,b,r,m)}function c(a){a instanceof Array||(a=[a]);for(var b={},c=0;c<a.length;++c)d(b,a[c]);return b}function d(a,b){for(var c=Object.keys(b),d=0;d<c.length;++d){var e=c[d];a[e]=b[e]}}function e(a){if("string"==typeof a)return a+"\n";for(var b="",c=0;c<a.length;++c)b+=e(a[c]);return b}function f(a,b){b=b||{};for(var c=Object.keys(b),d=[],e=0;e<c.length;++e){var f=c[e],g=b[f];d.push(a+" "+g+" "+f+";")}return d}function g(a,b,c,d,g){var h=[];return g=["void main() {",g,"}"],h.push(j),h.push(f("uniform",a)),h.push(f("attribute",b)),h.push(f("varying",c)),(d||[]).forEach(function(a){h.push(a)}),h.push(g),h.map(function(a){return e(a)}).join("\n")}function h(a,b,c,d){var g=[];return d=["void main() {",d,"}"],g.push(j),g.push(f("uniform",a)),g.push(f("varying",b)),(c||[]).forEach(function(a){g.push(a)}),g.push(d),g.map(function(a){return e(a)}).join("\n")}function i(a,b,c,d){var e=a.createShader(d?a.VERTEX_SHADER:a.FRAGMENT_SHADER);if(a.shaderSource(e,c),a.compileShader(e),!a.getShaderParameter(e,a.COMPILE_STATUS)){var f=0;throw console.log(c.split("\n").map(function(a){return++f+"  "+a}).join("\n")),new Error("Error in program "+b+":"+(d?"vertex":"fragment")+":\n"+a.getShaderInfoLog(e))}return e}var Ogma=$global.Ogma,j=["precision mediump float;","precision mediump int;"];b.prototype.prepare=function(a){this._gl.useProgram(this._glProgram);for(var b=a;b<this._attributeList.length;++b)this._gl.enableVertexAttribArray(b);for(b=this._attributeList.length;b<a;++b)this._gl.disableVertexAttribArray(b);return this._attributeList.length},b.prototype.createBuffer=function(){return new Ogma.renderers.webgl.Buffer(this._gl,this.programName,this._glProgram,this._attributeDef)},Ogma.renderers.webgl.Program=b}.call(this),function(a){function b(){return["vec2 positionOnCamera, _position, _angleOffset, _zoomOffset, _offset;","bool thresholdPassed = symbolicSize < 0.0 || (symbolicSize * camZoom) > symbolicSizeThreshold;","if (!thresholdPassed || depth < 0.0) {","  gl_Position = vec4(-1.0, -1.0, 1.0, 1.0);","  return;","}","vec2 vcScreenSize = screenSize / textureMultiplier / pixelRatio;","if (!checkVisibilityCondition(visibilityCondition1, vcScreenSize, camPosition, camZoom, cosCamAngle, sinCamAngle) && !checkVisibilityCondition(visibilityCondition2, vcScreenSize, camPosition, camZoom, cosCamAngle, sinCamAngle)) {;","  gl_Position = vec4(-1.0, -1.0, 1.0, 1.0);","  return;","}","float animationRatio = 2.0;","if (animationMode == 1 && animation.x > 0.5) animationRatio = (currentTime - animation.y) / animation.z;","if (animationRatio >= 1.0) {","  _position = absolutePosition.xy;","  _angleOffset = angleOffset.xy;","  _zoomOffset = zoomOffset.xy;","  _offset = offset.xy;","} else {","  _position = interpolate(absolutePosition.zw, absolutePosition.xy, animationRatio);","  _angleOffset = interpolate(angleOffset.zw, angleOffset.xy, animationRatio);","  _zoomOffset = interpolate(zoomOffset.zw, zoomOffset.xy, animationRatio);","  _offset = interpolate(offset.zw, offset.xy, animationRatio);","}","vec2 tmp = ((_position - camPosition) * camZoom + _angleOffset);","vec2 refPoint = vec2(","  cosCamAngle * tmp.x + sinCamAngle * tmp.y,","  -sinCamAngle * tmp.x + cosCamAngle * tmp.y",");","positionOnCamera = (refPoint + _zoomOffset * camZoom + _offset) * pixelRatio;",c()]}function c(){return["vec2 clipSpace = (positionOnCamera * textureMultiplier / screenSize) * 2.0 - 1.0;","gl_Position = vec4(clipSpace * vec2(1.0, -1.0), 1.0 - depth, 1.0);"]}function d(){return["  const float PI = 3.1415926535897932384626433832795;","  const float PI_2 = PI / 2.0;","  bool thresholdPassed = symbolicSize < 0.0 || symbolicSizeThreshold <= (symbolicSize * camZoom);","  if (!thresholdPassed || depth < 0.0) {","    gl_Position = vec4(-1.0, -1.0, 1.0, 1.0);","    return;","  }","  vec2 vcScreenSize = screenSize / textureMultiplier / pixelRatio;","  if (!checkVisibilityCondition(visibilityCondition1, vcScreenSize, camPosition, camZoom, cosCamAngle, sinCamAngle) && !checkVisibilityCondition(visibilityCondition2, vcScreenSize, camPosition, camZoom, cosCamAngle, sinCamAngle)) {","    gl_Position = vec4(-1.0, -1.0, 1.0, 1.0);","    return;","  }","  float absoluteEdgeLength = lineInfo.y * camZoom;","  float absoluteEdgeSize = lineInfo.z * camZoom;","  float textWidth, textHeight;","  if (textDimensions.z < 0.0) {","    textWidth = textDimensions.x;","    textHeight = textDimensions.y;","  } else {","    textWidth = camZoom * textDimensions.x;","    textHeight = camZoom * textDimensions.y;","  }","  float cosToUse, sinToUse, s = 1.0;","  vec2 additionalOffset, _position, _zoomOffset, _offset;","  if (!isSelfLoop(lineInfo) && absoluteEdgeLength < textWidth) {","    cosToUse = 1.0;","    sinToUse = 0.0;","    additionalOffset = vec2(0.0, 0.0);","  } else {","    float v = (textHeight + absoluteEdgeSize + lineInfo.w) / -2.0;","    float angleToUse = camAngle - lineInfo.x;","    if (!isSelfLoop(lineInfo)) {","      if (angleToUse < -PI_2) { angleToUse += PI; if (angleToUse < -PI_2) { angleToUse += PI; } }","      else if (angleToUse > PI_2) { angleToUse -= PI; if (angleToUse > PI_2) { angleToUse -= PI; } }","    } else if (angleToUse > -PI_2 && angleToUse < PI_2) {","      v = - v + absoluteEdgeSize * 2.0;","    } else {","      if (angleToUse < -PI_2) { angleToUse += PI; if (angleToUse < -PI_2) { angleToUse += PI; } }","      else if (angleToUse > PI_2) { angleToUse -= PI; if (angleToUse > PI_2) { angleToUse -= PI; } }","    }","    additionalOffset = vec2(0.0, v);","    cosToUse = cos(angleToUse);","    sinToUse = sin(angleToUse);","  }","  float animationRatio = 2.0;","  if (animationMode == 1 && animation.x > 0.5) animationRatio = (currentTime - animation.y) / animation.z;","  if (animationRatio > 1.0) {","    _position = absolutePosition.xy;","    _zoomOffset = zoomOffset.xy * camZoom;","    _offset = offset.xy + additionalOffset;","  } else {","    _position = interpolate(absolutePosition.zw, absolutePosition.xy, animationRatio);","    _zoomOffset = interpolate(zoomOffset.zw, zoomOffset.xy, animationRatio) * camZoom;","    _offset = interpolate(offset.zw, offset.xy, animationRatio) + additionalOffset;","  }","  vec2 center, positionOnCamera;","  center = rotate((_position - camPosition) * camZoom, cosCamAngle, sinCamAngle);","  positionOnCamera = (center + rotate(_zoomOffset + _offset, cosToUse, sinToUse)) * pixelRatio;","  vec2 clipSpace = (positionOnCamera * textureMultiplier / screenSize) * 2.0 - 1.0;","  gl_Position = vec4(clipSpace * vec2(1.0, -1.0), 1.0 - depth, 1.0);"]}function e(){return["vTextureCoords = textureCoords;",g()]}function f(){return["vec4 textureColor = texture2D(bigTexture, vTextureCoords);","float alpha = textureColor.a;","gl_FragColor = vec4(textureColor.rgb, alpha) + vColor;"]}function g(){return["vec4 selectedColor = color;","if (animationRatio < 1.0) {","  selectedColor = interpolate(prevColor, color, animationRatio);","}","vColor = selectedColor;"]}var Ogma=$global.Ogma,h={},i={depth:"float",symbolicSize:"float",animation:"vec3",absolutePosition:"vec4",angleOffset:"vec4",zoomOffset:"vec4",offset:"vec4",visibilityCondition1:"vec4",visibilityCondition2:"vec4"},j={depth:"float",symbolicSize:"float",animation:"vec3",absolutePosition:"vec4",zoomOffset:"vec4",offset:"vec4",textDimensions:"vec3",lineInfo:"vec4",visibilityCondition1:"vec4",visibilityCondition2:"vec4"},k={screenSize:"vec2",camPosition:"vec2",cosCamAngle:"float",sinCamAngle:"float",camAngle:"float",animationMode:"int",symbolicSizeThreshold:"float",camZoom:"float",currentTime:"float",textureMultiplier:"float",vcMargin:"float",pixelRatio:"float"},l={texture:"sampler2D"},m={textureCoords:"vec2"},n={vTextureCoords:"vec2"},o={bigTexture:"sampler2D",smallTexture:"sampler2D"},p={textureCoords:"vec2"},q={vTextureCoords:"vec2"},r={color:"vec4",prevColor:"vec4"},s={vColor:"vec4"},t=["float interpolate(in float start, in float end, in float ratio) {","  return start + (end - start) * ratio;","}","vec2 interpolate(in vec2 start, in vec2 end, in float ratio) {","  return start + (end - start) * ratio;","}","vec3 interpolate(in vec3 start, in vec3 end, in float ratio) {","  return start + (end - start) * ratio;","}","vec4 interpolate(in vec4 start, in vec4 end, in float ratio) {","  return start + (end - start) * ratio;","}"],u=["vec2 rotate(in vec2 v, in float cosAngle, in float sinAngle) {","  return vec2(cosAngle * v.x + sinAngle * v.y, -sinAngle * v.x + cosAngle * v.y);","}"],v=["bool isSelfLoop(in vec4 lineInfo) {","  return lineInfo.y < -99999.0;","}"],w=["vec2 computePositionOnScreen(in vec2 absoluteCoords, in vec2 camPos, in float zoom, in float cosAngle, in float sinAngle) {","  vec2 tmp = (absoluteCoords - camPos) * zoom;","  return vec2(","    cosAngle * tmp.x + sinAngle * tmp.y,","    -sinAngle * tmp.x + cosAngle * tmp.y","  );","}"],x=["bool checkVisibilityCondition(in vec4 condition, in vec2 screenDimensions, in vec2 camPos, in float zoom, in float cosAngle, in float sinAngle) {","  if (condition.w == 0.0) return true;","  vec2 posOnScreen = computePositionOnScreen(condition.xy, camPos, zoom, cosAngle, sinAngle);","  float radiusOnScreen = zoom * condition.z;","  return posOnScreen.x - radiusOnScreen - vcMargin < screenDimensions.x && posOnScreen.x + radiusOnScreen + vcMargin > 0.0 && posOnScreen.y - radiusOnScreen - vcMargin < screenDimensions.y && posOnScreen.y + radiusOnScreen + vcMargin > 0.0;","}"],y=[t,u,w,x],z={circleMultiplier:"vec2"},A={vMultiplier:"vec2"};h.polygon={uniforms:k,attributes:[i,r],varyings:s,functions:y,vertex:[b(),g()],fragment:["gl_FragColor = vColor;"]},h.circle={uniforms:k,attributes:[i,r,z],varyings:[s,A],functions:y,vertex:[b(),g(),"vMultiplier = circleMultiplier;"],fragment:["const vec3 black = vec3(0.0, 0.0, 0.0);","float d = length(vMultiplier);","if (d <= 1.0) {","  gl_FragColor = vColor;","} else {","  discard;","}"]},h.image={uniforms:[k,l],attributes:[i,m],varyings:[n],functions:y,vertex:[b(),"vTextureCoords = textureCoords;"],fragment:["gl_FragColor = texture2D(texture, vTextureCoords);"]},h.nonScaledImage={uniforms:[k,l,{textureDimensions:"vec2"}],attributes:[i,m,{textureBox:"vec2",duplicate:"float"}],varyings:[n,{vDuplicateTexture:"float"}],functions:y,vertex:[b(),"float offsetW = ((textureBox.x * camZoom) / (textureDimensions.x * 2.0)) + 0.5;","float offsetH = ((textureBox.y * camZoom) / (textureDimensions.y * 2.0)) + 0.5;","vTextureCoords = vec2(","  textureCoords.x == 1.0 ? offsetW : 1.0 - offsetW,","  textureCoords.y == 1.0 ? offsetH : 1.0 - offsetH",");","vDuplicateTexture = duplicate;"],fragment:["if (vDuplicateTexture == 0.0 && (vTextureCoords.x < 0.0 || vTextureCoords.x > 1.0 || vTextureCoords.y < 0.0 || vTextureCoords.y > 1.0)) {","  discard;","} else {","  gl_FragColor = texture2D(texture, vTextureCoords);","}"]},h.text={uniforms:[k,o],attributes:[i,p,r],varyings:[q,s],functions:y,vertex:[b(),e()],fragment:[f()]},h.lineText={uniforms:[k,o],attributes:[j,p,r],varyings:[q,s],functions:[y,v],vertex:[d(),e()],fragment:[f()]},h.linePolygon={uniforms:[k],attributes:[j,r],varyings:[s],functions:[y,v],vertex:[d(),g()],fragment:["gl_FragColor = vColor;"]};var B={texture:"sampler2D",screenTextureRatio:"vec2"},C={positionOnScreen:"vec2"},D={vTextureCoords:"vec2"};h.antialias={uniforms:[B],attributes:[C],varyings:[D],functions:[],vertex:["float coordX, coordY;","float difRatioX = (1.0 - screenTextureRatio.x) / 2.0;","float difRatioY = (1.0 - screenTextureRatio.y) / 2.0;","if (positionOnScreen.x == -1.0) coordX = 0.0; else coordX = screenTextureRatio.x;","if (positionOnScreen.y == -1.0) coordY = 0.0; else coordY = screenTextureRatio.y;","vTextureCoords = vec2(coordX, coordY);","gl_Position = vec4(positionOnScreen, 0.0, 1.0);"],fragment:["gl_FragColor = texture2D(texture, vTextureCoords);"]},Ogma.renderers.webgl.programs=h}.call(),function(a){function b(a,b,d,e,f){this.fontFamily=a,this.fontStyle=b,this.updateTexture=d,this.defaultFont=e,this.characterResolution=f,this.textureRatio=h,c(this,b,a),this.charList=i,this.mustUpdate=!1,this.reload(),this.updateIfNecessary(),this.missingCharacter=this.get(g)}function c(a,b,c){a.textureSize=Ogma.utils.upperPowerOf(a.characterResolution*a.textureRatio,2),a.canvas=document.createElement("canvas"),a.canvas.width=a.textureSize,a.canvas.height=a.textureSize,a.ctx=a.canvas.getContext("2d"),a.ctx.textBaseline="middle",a.ctx.textAlign="center",d(a.ctx,c,b,a.characterResolution),a.ctx.fillStyle="black"}function d(a,b,c,d){a.font=("italic"===c||"bold"===c?c+" ":"")+d+"px "+b}function e(a){return i.indexOf(a)!==-1}function f(a,b){var c=a.characterResolution;if(a.full)return null;var f="FontAwesome"!==a.fontFamily||e(b)?a.ctx.measureText(b).width/c:1.2,g=1,i=f+j,l=g+k;if(a.nextX+i>h&&(a.nextX=0,a.nextY+=l,a.nextY>=h))return a.full=!0,null;var m=a.nextX+i/2,n=a.nextY+l/2;"FontAwesome"===a.fontFamily&&(e(b)?d(a.ctx,a.defaultFont,a.fontStyle,c):d(a.ctx,a.fontFamily,a.fontStyle,c)),a.ctx.fillText(b,Math.round(m*c),Math.round(n*c));var o={x1:a.nextX/h,y1:a.nextY/h,x2:(a.nextX+i)/h,y2:(a.nextY+l)/h,ratio:i/l};return a.nextX+=i,a.charMap[b]=o,a.charList+=b,o}var Ogma=$global.Ogma,g="□",h=32,i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 _";b.prototype.get=function(a){var b=this.charMap[a];if(!b){if(b=f(this,a),!b)return this.charMap[a]=this.missingCharacter,console.warn('Cannot create texture for character "'+a+'": BitMap font ('+this.fontFamily+") ["+this.fontStyle+"] full."),this.missingCharacter;this.mustUpdate=!0}return b},b.prototype.updateIfNecessary=function(){this.mustUpdate&&(this.bigTexture=this.updateTexture(this.canvas,this.bigTexture),this.mustUpdate=!1)},b.prototype.reload=function(){this.nextX=0,this.nextY=0,this.charMap={},this.full=!1,this.ctx.clearRect(0,0,this.textureSize,this.textureSize);var a=this.charList;this.charList="";for(var b=0;b<a.length;++b)f(this,a[b]);this.mustUpdate=!0};var j=.11,k=.15;b.TOTAL_CHAR_HEIGHT=1+k,Ogma.renderers.webgl.BitmapFont=b}.call(),function(){function a(a,b,c){c=c||{},this.renderer=a,this.gl=a.gl,this.renderFunction=b,this.ratio=$or(c.ratio,1),this.wrap=$or(c.wrap,this.gl.CLAMP_TO_EDGE),this.minFilter=$or(c.minFilter,this.gl.NEAREST_MIPMAP_LINEAR),this.magFilter=$or(c.magFilter,this.gl.NEAREST),this.texture=null,this.framebuffer=null,this.depthStencilBuffer=null,this.screenWidth=null,this.screenHeight=null,this.renderWidth=null,this.renderHeight=null}var Ogma=$global.Ogma;a.prototype.resize=function(a,b,c){var d=Ogma.utils.pixelRatio();if(a*=d,b*=d,this.screenWidth=a,this.screenHeight=b,this.renderWidth=a*this.ratio,this.renderHeight=b*this.ratio,c){var e=this.gl,f=Ogma.utils.upperPowerOf(a,2)*this.ratio,g=Ogma.utils.upperPowerOf(b,2)*this.ratio;f===this.textureWidth&&g===this.textureHeight||(this.textureWidth=f,this.textureHeight=g,this.texture&&e.deleteTexture(this.texture),this.framebuffer&&e.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer),this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this.wrap),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this.wrap),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this.minFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this.magFilter),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.textureWidth,this.textureHeight,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null),this.depthStencilBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.depthStencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.textureWidth,this.textureHeight),this.framebuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.depthStencilBuffer))}},a.prototype.render=function(a){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,this.framebuffer),b.viewport(0,0,this.renderWidth,this.renderHeight),this.renderFunction(this.renderer,b,this,a)},$global.webgl.RenderStep=a}(),function(a){function b(a,b,d,e){for(var f=Object.keys(e),g=0;g<f.length;++g){var h=f[g],i=e[h],j=new c(a,b,d,h,i);this[h]=j}}function c(a,b,c,d,e){var f=a.getUniformLocation(c,d);if(f===-1)throw new Error("program "+b+": uniform location "+d+" should not be -1");"vec4"===e?this.set=function(b,c,d,e){a.uniform4f(f,b,c,d,e)}:"vec3"===e?this.set=function(b,c,d){a.uniform3f(f,b,c,d)}:"vec2"===e?this.set=function(b,c){a.uniform2f(f,b,c)}:"float"===e?this.set=function(b){a.uniform1f(f,b)}:this.set=function(b){a.uniform1i(f,b)}}var Ogma=$global.Ogma;Ogma.renderers.webgl.UniformList=b}.call(),function(a){function b(a){this.renderFunction=a;var b=this;this._animationFrame=function(a){b._newFrame(a)},this._time=0,this._inFrame=!1,this._mustRefresh=!1,this._updateTimeCouter=!0,this._nextFrame=[],this._nbFrames=0,this._totalElapsed=0}var c="undefined"!=typeof window&&window.requestAnimationFrame?function(a){window.requestAnimationFrame(a)}:function(a){setTimeout(a,17)};$global.FrameManager=b,b.prototype.kill=function(){$kill(this),this._nextFrame=a},b.prototype.requestNewFrame=function(){this._inFrame?(this._mustRefresh=!0,this._updateTimeCouter=!0):this._requestDone||(this._requestDone=!0,c(this._animationFrame))},b.prototype.atNextFrame=function(a){this._nextFrame.push(a)},b.prototype._newFrame=function(a){var b=a-this._time;if(this._inFrame=!0,this._mustRefresh=!1,this._time=a,this.renderFunction(this._updateTimeCouter?b:0),this._nextFrame.length){var d=this._nextFrame;this._nextFrame=[];for(var e=0;e<d.length;++e)d[e]()}this._mustRefresh?c(this._animationFrame):(this._inFrame=!1,this._requestDone=!1,this._updateTimeCouter=!1)}}.call(),function(a){function b(a){this.images={},this.crossOrigin=a}$global.ImageManager=b;var c="undefined"!=typeof Image?Image:function(){},d="data:image/png;base64,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",e=new c;
e.src=d,b.prototype.use=function(b,d,f){var g=this.images[b];if(g){if(f)return;g.loaded?d(g.content):g.onLoad.push(d)}else{var h=new c;g={content:h,loaded:!1,onLoad:[d]},g.content.crossOrigin=this.crossOrigin,g.content.src=b,g.content.onload=function(){g.loaded=!0,g.onLoad.forEach(function(a){a(g.content)}),g.onLoad=a}.bind(this),g.content.onerror=function(c){this.images[b]||(this.images[b].content=e,g.loaded=!0,g.onLoad.forEach(function(a){a(g.content)}),g.onLoad=a)}.bind(this),this.images[b]=g}},b.prototype.kill=function(){$kill(this),this.images=a},b.prototype.getErrorImage=function(){return e},b.prototype.getImage=function(a){var b=this.images[a];return b&&b.loaded?b.content:null}}.call(),function(a){$global.Ogma}.call(),function(a){function b(a){return"string"!=typeof a?null:"#"===a.charAt(0)?d(a):c(a)}function c(b){var c=b.match(/(\d*\.\d+)|(\d+)/g);return c&&c.length>=3?(j[0]=parseInt(c[0])/255,j[1]=parseInt(c[1])/255,j[2]=parseInt(c[2])/255,j[3]=c[3]===a?1:parseFloat(c[3]),j):null}function d(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?(j[0]=parseInt(c[1],16)/255,j[1]=parseInt(c[2],16)/255,j[2]=parseInt(c[3],16)/255,j[3]=1,j):null}function e(a,b){return i===Ogma.colors.indexToStr.length&&(Ogma.colors.indexToStr=Ogma.memory.expand(Ogma.colors.indexToStr),Ogma.colors.rgba=Ogma.memory.expand(Ogma.colors.rgba)),h[a]=i,Ogma.colors.indexToStr[i]=a,Ogma.colors.rgba[4*i]=b[0],Ogma.colors.rgba[4*i+1]=b[1],Ogma.colors.rgba[4*i+2]=b[2],Ogma.colors.rgba[4*i+3]=b[3],i+=1,i-1}function f(a){return a<16?"0"+a.toString(16):a.toString(16)}var Ogma=$global.Ogma;Ogma.colors=Object.create(null);var g=256,h={},i=1;Ogma.colors.indexToStr=Ogma.memory.allocate(Array,g),Ogma.colors.rgba=Ogma.memory.allocate(Float32Array,4*g);var j=new Float32Array(4);Ogma.colors.is=function(a){return 0!==this.getIndex(a)},Ogma.colors.getIndex=function(c){var d=h[c];if(d===a){var f=b(c);f?d=e(c,f):(d=0,h[c]=0)}return d},Ogma.colors.colorToHexa=function(a){var b=4*Ogma.colors.getIndex(a),c=Ogma.colors.rgba;return"#"+f(255*c[b]|0)+f(255*c[b+1]|0)+f(255*c[b+2]|0)},Ogma.colors.toRgb=function(a){var b=4*Ogma.colors.getIndex(a),c=Ogma.colors.rgba;return[255*c[b]|0,255*c[b+1]|0,255*c[b+2]|0]},Ogma.colors.toRgba=function(a){var b=4*Ogma.colors.getIndex(a),c=Ogma.colors.rgba;return[255*c[b]|0,255*c[b+1]|0,255*c[b+2]|0,c[b+3]]};for(var k=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],l=0;l<k.length;l+=2){var m=k[l].toLowerCase(),n=k[l+1];e(m,b(n))}}.call(),function(a){var Ogma=$global.Ogma;Ogma.shapes={nodes:{},edges:{}};var b=2,c=4,d=new Ogma.utils.Position,e=new Ogma.utils.Position,f={},g={};Ogma.shapes.utils={getCurveControlPoint:function(a,d,e,f,g,h){return g<0?Ogma.geometry.getQuadraticControlPoints(a,d,e,f,b,c/g,h):Ogma.geometry.getQuadraticControlPoints(e,f,a,d,b,c/g*-1,h)},getLoopControlPoints:function(a,b,c,d,e){return Ogma.geometry.getSelfLoopControlPoints(a,b,d+c,e)},createDashedEdgeType:function(a,b){return{drawStraight:function(c,f,g,h,i,j,k,l,m,n,o,p,q,r){for(var s=k*a,t=s*b,u=s+t,v=Ogma.geometry.distance(g,h,i,j),w=(i-g)/v,x=(j-h)/v,y=.7*m,z=(v-y)/u|0,A=y,B=c.updateComposite(f,z),C=0;C<z;++C)d.setXY(g+w*A,h+x*A),A+=s,e.setXY(g+w*A,h+x*A),A+=t,B[C]=c.line(B[C],d,e,k,l,o,p,q,r);return c.composite(f,B)},drawCurved:function(c,g,h,i,j,k,l,m,n,o,p,q,r,s,t){for(var u=l*a,v=u*b,w=u+v,x=Ogma.shapes.utils.getCurveControlPoint(h,i,j,k,n,x),y=Ogma.geometry.quadraticCurveLength(h,i,x.x,x.y,j,k),z=.7*o,A=(y-z)/w|0,B=u/y,C=v/y,D=z/y,E=c.updateComposite(g,A),F=0;F<A;++F)Ogma.geometry.getPointOnQuadraticCurve(D,h,i,j,k,x.x,x.y,f),d.setXY(f.x,f.y),D+=B,Ogma.geometry.getPointOnQuadraticCurve(D,h,i,j,k,x.x,x.y,f),e.setXY(f.x,f.y),D+=C,E[F]=c.line(E[F],d,e,l,m,q,r,s,t);return c.composite(g,E)},drawLoop:function(c,f,g,h,i,j,k,l,m,n,o,p){var q=i*a,r=q*b,s=Ogma.shapes.utils.getLoopControlPoints(g,h,k,l,s),t=Ogma.geometry.cubicCurveLength(g,h,s.x1,s.y1,s.x2,s.y2,g,h),u=.7*l,v=q/t,w=r/t,x=u/t,y=0;c.delete(f);for(var z=[];x<=1;){Ogma.geometry.getPointOnBezierCurve(x,g,h,g,h,s.x1,s.y1,s.x2,s.y2,d),x+=v;do Ogma.geometry.getPointOnBezierCurve(x,g,h,g,h,s.x1,s.y1,s.x2,s.y2,e),x+=.01;while(Ogma.geometry.distance(d.x,d.y,e.x,e.y)<q);do Ogma.geometry.getPointOnBezierCurve(x,g,h,g,h,s.x1,s.y1,s.x2,s.y2,e),x-=.01;while(Ogma.geometry.distance(d.x,d.y,e.x,e.y)>q);x+=w+.01,z[y]=c.line(z[y],d,e,i,j,m,n,o,p),++y}return c.composite(-1,z)},detectStraight:function(a,b,c,d,e,f,g,h,i){return Ogma.geometry.isPointInLine(a,b,c,d,e,f,g)},detectCurved:function(a,b,c,d,e,f,h,i,j,k){return Ogma.shapes.utils.getCurveControlPoint(c,d,e,f,i,g),Ogma.geometry.isPointOnQuadraticCurve(a,b,c,d,e,f,g.x,g.y,h/2)},detectLoop:function(a,b,c,d,e,f,h){return Ogma.shapes.utils.getLoopControlPoints(c,d,f,h,g),Ogma.geometry.isPointOnBezierCurve(a,b,c,d,c,d,g.x1,g.y1,g.x2,g.y2,e/2)}}}}}.call(),function(a){function b(a,b,c,d,g,h,i,j,k,l,m,n,o,p){return e.x=c,e.y=d,f.x=g,f.y=h,a.line(b,e,f,i,j,m,n,o,p)}function c(a,b,c,d,e,f,g,i,l,m,n,o,p,q,r){return h.reset(),j.reset(),k.reset(),j.x=c,j.y=d,k.x=e,k.y=f,Ogma.shapes.utils.getCurveControlPoint(c,d,e,f,l,h),a.quadraticCurve(b,j,h,k,g,i,o,p,q,r)}function d(a,b,c,d,e,f,k,l,m,n,o,p){return h.reset(),i.reset(),j.reset(),h.reset(),i.reset(),j.reset(),j.x=c,j.y=d,Ogma.shapes.utils.getLoopControlPoints(c,d,k,l,g),h.x=g.x1,h.y=g.y1,i.x=g.x2,i.y=g.y2,a.cubicCurve(b,j,h,i,j,e,f,m,n,o,p)}var Ogma=$global.Ogma,e=new Ogma.utils.Position,f=new Ogma.utils.Position,g={},h=new Ogma.utils.Position,i=new Ogma.utils.Position,j=new Ogma.utils.Position,k=new Ogma.utils.Position;Ogma.shapes.edges.line={drawStraight:b,drawCurved:c,drawLoop:d,detectStraight:function(a,b,c,d,e,f,g,h,i){return Ogma.geometry.isPointInLine(a,b,c,d,e,f,g)},detectCurved:function(a,b,c,d,e,f,h,i,j,k){return Ogma.shapes.utils.getCurveControlPoint(c,d,e,f,i,g),Ogma.geometry.isPointOnQuadraticCurve(a,b,c,d,e,f,g.x,g.y,h/2)},detectLoop:function(a,b,c,d,e,f,h){return Ogma.shapes.utils.getLoopControlPoints(c,d,f,h,g),Ogma.geometry.isPointOnBezierCurve(a,b,c,d,c,d,g.x1,g.y1,g.x2,g.y2,e/2)},haloStraight:b,haloCurved:c,haloLoop:d}}.call(),function(a){function b(b,c){return c===a&&(c=3),b+Math.log(b+1)*c}function c(a){return function(c,d,e,f,g,j,k,n,o,p,q,r,s,t,u){u=u||m;var v=b(k,u.arrowSizeRatio),w=n/2,x=Ogma.geometry.distance(e,f,g,j),y=(g-e)/x,z=(j-f)/x,A=g-y*(v+p),B=j-z*(v+p),C=g-y*p,D=j-z*p,E=-z,F=y,G=A+E*(v/2),H=B+F*(v/2),I=A-E*(v/2),J=B-F*(v/2),K=A+E*w,L=B+F*w,M=A-E*w,N=B-F*w;h.x=e,h.y=f,i.x=A,i.y=B,l.reset(),l[0].setXY(G,H),l[1].setXY(I,J),l[2].setXY(C,D),l[0].setAXY(K-A,L-B),l[1].setAXY(M-A,N-B),a&&(l[2].setAXY(y*w,z*w),l[0].ax-=y*w,l[0].ay-=z*w,l[1].ax-=y*w,l[1].ay-=z*w);var O=c.updateComposite(d,2);return O[0]=c.line(O[0],h,i,k,n,q,r,s,t),O[1]=c.triangle(O[1],l[0],l[1],l[2],q,r,s,t),c.composite(d,O)}}function d(a){return function(b,c,d,e,g,k,m,n,o,u,v,w,x,y,z,A){f(d,e,g,k,m,o,v,A.arrowSizeRatio),h.setXY(d,e),i.setXY(p,q),j.setXY(t.x,t.y),l.reset(),l[0].setXY(p+r,q+s),l[1].setXY(p+.6*s,q-.6*r),l[2].setXY(p-.6*s,q+.6*r),f(d,e,g,k,n,o,v,A.arrowSizeRatio),l[1].setAXY(.3*s,.3*-r),l[2].setAXY(.3*-s,.3*r),a&&(l[0].setAXY(r,s),l[1].ax-=.3*(r-s),l[1].ay-=.3*(s+r),l[2].ax-=.3*(r+s),l[2].ay-=.3*(s-r));var B=b.updateComposite(c,2);return B[0]=b.quadraticCurve(B[0],h,j,i,m,n,w,x,y,z),B[1]=b.triangle(B[1],l[0],l[1],l[2],w,x,y,z),b.composite(c,B)}}function e(a){return function(b,c,d,e,f,m,n,o,u,v,w,x,y){g(d,e,f,n,o,y.arrowSizeRatio),h.setXY(d,e),i.setXY(p,q),j.setXY(t.x1,t.y1),k.setXY(t.x2,t.y2),l.reset(),l[0].setXY(p+r,q+s),l[1].setXY(p+.6*s,q-.6*r),l[2].setXY(p-.6*s,q+.6*r),g(d,e,m,n,o,y.arrowSizeRatio),l[1].setAXY(.3*s,.3*-r),l[2].setAXY(.3*-s,.3*r),a&&(l[0].setAXY(r,s),l[1].ax-=.3*(r-s),l[1].ay-=.3*(s+r),l[2].ax-=.3*(r+s),l[2].ay-=.3*(s-r));var z=b.updateComposite(c,2);return z[0]=b.cubicCurve(z[0],h,k,j,i,f,m,u,v,w,x),z[1]=b.triangle(z[1],l[0],l[1],l[2],u,v,w,x),b.composite(c,z)}}function f(a,c,d,e,f,g,h,i){n=b(f,i),Ogma.shapes.utils.getCurveControlPoint(a,c,d,e,g,t),o=Ogma.geometry.distance(d,e,t.x,t.y),p=t.x+(d-t.x)*(o-n-h)/o,q=t.y+(e-t.y)*(o-n-h)/o,r=(d-t.x)*n/o,s=(e-t.y)*n/o}function g(a,c,d,e,f,g){n=b(d,g),Ogma.shapes.utils.getLoopControlPoints(a,c,e,f,t);var h=f+(d-e),i=h/2;t.x1+=h,t.y1+=h,t.y2-=i,o=Math.sqrt(Math.pow(a-t.x1,2)+Math.pow(c-t.y1,2)),p=t.x1+(a-t.x1)*(o-n-f)/o,q=t.y1+(c-t.y1)*(o-n-f)/o,r=(a-t.x1)*n/o,s=(c-t.y1)*n/o}var Ogma=$global.Ogma,h=new Ogma.utils.Position,i=new Ogma.utils.Position,j=new Ogma.utils.Position,k=new Ogma.utils.Position,l=new Ogma.utils.PositionList(3),m={};Ogma.shapes.edges.arrow={drawStraight:c(!1),drawCurved:d(!1),drawLoop:e(!1),haloStraight:c(!0),haloCurved:d(!0),haloLoop:e(!0),detectStraight:function(a,c,d,e,f,g,h,i,j){var k=b(h),l=Ogma.geometry.distance(d,e,f,g),m=(f-d)/l,n=(g-e)/l,o=f-m*(k+j),p=g-n*(k+j),q=f-m*j,r=g-n*j,s=Ogma.geometry.lineFromPoint(o,p,f,g,k);return Ogma.geometry.isPointInLine(a,c,d,e,o,p,h)||Ogma.geometry.isPointInTriangle(a,c,s.x1,s.y1,s.x2,s.y2,q,r)},detectCurved:function(a,b,c,d,e,g,h,i,j,k){return f(c,d,e,g,h,i,k),Ogma.geometry.isPointOnQuadraticCurve(a,b,c,d,p,q,t.x,t.y,h/2)||Ogma.geometry.isPointInTriangle(a,b,p+r,q+s,p+.6*s,q-.6*r,p-.6*s,q+.6*r)},detectLoop:function(a,b,c,d,e,f,h){return g(c,d,e,f,h),Ogma.geometry.isPointOnBezierCurve(a,b,p,q,c,d,t.x1,t.y1,t.x2,t.y2,e/2)||Ogma.geometry.isPointInTriangle(a,b,p+r,q+s,p+.6*s,q-.6*r,p-.6*s,q+.6*r)}};var n,o,p,q,r,s,t={}}.call(),function(a){var Ogma=$global.Ogma,b=3,c=3/8;Ogma.shapes.edges.dashed=Ogma.shapes.utils.createDashedEdgeType(b,c)}.call(),function(a){var Ogma=$global.Ogma,b=1,c=1;Ogma.shapes.edges.dotted=Ogma.shapes.utils.createDashedEdgeType(b,c);new Ogma.utils.Position,new Ogma.utils.Position,new Ogma.utils.Position,new Ogma.utils.Position,new Ogma.utils.Position}.call(),function(a){function b(a,b,c,d,e,g,h,i,j,k,l,m){return f(c,d,e,g,h,i),a.polygon(b,x,j,k,l,m)}function c(a,b,c,d,f,g,h,i,j,k,l,m,n,o,p){return e(c,d,f,g,h,i,j,k,l),a.polygon(b,x,m,n,o,p)}function d(a,b,c,d,e,f,g,h,i,k,l,m,n,o){var p=Ogma.geometry.distance(c,d,e,f);Ogma.geometry.orthogonal(c,d,e,f,1,j);var q=(c-e)/p,r=(d-f)/p,s=-r,t=q,u=h/2;return y.reset().setXY(c+s*g,d+t*g).setXY(c-s*g,d-t*g).setXY(e+q*k,f+r*k).setXY(e+q*k,f+r*k),y.setAXY(s*u,t*u).setAXY(-s*u,-t*u).setAXY((-s-q)*u,(-t-r)*u).setAXY((s-q)*u,(t-r)*u),a.quadrilateral(b,y[0],y[1],y[2],y[3],l,m,n,o)}function e(a,b,c,d,e,f,h,j,o){Ogma.shapes.utils.getCurveControlPoint(a,b,c,d,h,k);var p=Ogma.geometry.distance(k.x,k.y,c,d);l.setXY(a,b),m.setXY(c+(k.x-c)/p*o,d+(k.y-d)/p*o),n.setXY(k.x,k.y),i(l,n,n,m,2*e,f,g)}function f(a,b,c,d,e,f){Ogma.shapes.utils.getLoopControlPoints(a,b,e,f,k);var g=Ogma.geometry.distance(k.x2,k.y2,a,b);l.setXY(a,b),m.setXY(a+(k.x1-a)/g*f,b+(k.y1-b)/g*f),n.setXY(k.x1,k.y1),o.setXY(k.x2,k.y2),i(l,o,n,m,2*c,d,h)}function g(a,b,c,d,e,f){Ogma.geometry.getPointOnQuadraticCurve(a,b.x,b.y,e.x,e.y,c.x,c.y,f)}function h(a,b,c,d,e,f){Ogma.geometry.getPointOnBezierCurve(a,b.x,b.y,e.x,e.y,c.x,c.y,d.x,d.y,f)}function i(a,b,c,d,e,f,g){g(0,a,b,c,d,p),g(1/w,a,b,c,d,q),Ogma.utils.lineFromBoundaries(p,q,e,f,s,t,u,v),x[0].set(s),x[2*w].set(t),x[2*w-1].set(u),x[1].set(v);for(var h=2;h<w;++h)g(h/w,a,b,c,d,r),Ogma.utils.lineFromBoundaries(q,r,e*(1-h/w),f,s,t,u,v),s.set(u),t.set(v),x[2*w-h].set(s),x[h].set(t),p.set(q),q.set(r);x[w].set(d)}var Ogma=$global.Ogma,j=(new Ogma.utils.PositionList(3),{}),k={},l=new Ogma.utils.Position,m=new Ogma.utils.Position,n=new Ogma.utils.Position,o=new Ogma.utils.Position,p=new Ogma.utils.Position,q=new Ogma.utils.Position,r=new Ogma.utils.Position,s=new Ogma.utils.Position,t=new Ogma.utils.Position,u=new Ogma.utils.Position,v=new Ogma.utils.Position,w=40,x=new Ogma.utils.PositionList(2*w+1);Ogma.shapes.edges.tapered={drawStraight:d,drawCurved:c,drawLoop:b,haloStraight:d,haloCurved:c,haloLoop:b,detectStraight:function(a,b,c,d,e,f,g,h,i){return Ogma.geometry.lineFromPoint(c,d,e,f,2*g,j),Ogma.geometry.isPointInTriangle(a,b,j.x1,j.y1,j.x2,j.y2,e,f)},detectCurved:function(a,b,c,d,f,g,h,i,j,k){return e(c,d,f,g,h,0,i,j,k),Ogma.geometry.isPointInPolygon(a,b,x)},detectLoop:function(a,b,c,d,e,g,h){return f(c,d,e,0,g,h),Ogma.geometry.isPointInPolygon(a,b,x)}};var y=new Ogma.utils.PositionList(4)}.call(),function(a){for(var Ogma=$global.Ogma,b=5,c=.4,d=2*b,e=2*Math.PI/d,f=[],g=[],h=0;h<d;++h)f[h]=Math.cos(h*e-Math.PI/2),g[h]=Math.sin(h*e-Math.PI/2);var i=new Ogma.utils.PositionList(10);Ogma.shapes.nodes.star={draw:function(a,b,e,h,j,k,l,m,n,o){i.reset(),i.x=e,i.y=h;for(var p=0;p<d;++p){var q=p%2===1?c:1;i[p].zx=f[p]*j*q,i[p].zy=g[p]*j*q,i[p].ox=f[p]*k*q*2.5,i[p].oy=g[p]*k*q*2.5}return a.polygon(b,i,l,m,n,o)},detect:function(a,b,e,h,j){i.reset();for(var k=0;k<d;++k){var l=k%2===1?c:1;i[k].x=a+f[k]*e*l,i[k].y=b+g[k]*e*l}return Ogma.geometry.isPointInPolygon(h,j,i)}}}.call(),function(a){function b(a,b){return e.reset(),e.x=a,e.y=b,e}function c(a,b,c,d){return f.reset(),f.zx=a,f.zy=b,f.ox=c,f.oy=d,f}var Ogma=$global.Ogma,d=.31,e=new Ogma.utils.Position,f=new Ogma.utils.Position;Ogma.shapes.nodes.cross={draw:function(a,e,f,g,h,i,j,k,l,m){var n=a.updateComposite(e,2);return n[0]=a.rectangle(n[0],b(f,g),c(h,h*d,i,i),j,k,l,m),n[1]=a.rectangle(n[1],b(f,g),c(h*d,h,i,i),j,k,l,m),a.composite(e,n)},detect:function(a,b,c,e,f){var g=c*d;return Ogma.geometry.isPointInRectangle(e,f,a-c,b-g,a+c,b+g)||Ogma.geometry.isPointInRectangle(e,f,a-g,b-c,a+g,b+c)}}}.call(),function(a){var Ogma=$global.Ogma,b=new Ogma.utils.Position;Ogma.shapes.nodes.circle={draw:function(a,c,d,e,f,g,h,i,j,k){return a.circle(c,b.setXY(d,e),f,g,h,i,j,k)},detect:function(a,b,c,d,e){var f=a-d,g=b-e;return f*f+g*g<c*c}}}.call(),function(a){function b(a,b){return d.reset(),d.x=a,d.y=b,d}function c(a,b,c,d){return e.reset(),e.zx=a,e.zy=b,e.ox=c,e.oy=d,e}var Ogma=$global.Ogma,d=new Ogma.utils.Position,e=new Ogma.utils.Position;Ogma.shapes.nodes.square={draw:function(a,d,e,f,g,h,i,j,k,l){return a.rectangle(d,b(e,f),c(g,g,h,h),i,j,k,l)},detect:function(a,b,c,d,e){return Ogma.geometry.isPointInRectangle(d,e,a-c,b-c,a+c,b+c)}}}.call(),function(a){function b(a,b,d,e){c.reset(),c.x=a,c.y=b,c[0].zy=-d,c[1].zx=d,c[2].zy=d,c[3].zx=-d,c[0].oy=-e,c[1].ox=e,c[2].oy=e,c[3].ox=-e}var Ogma=$global.Ogma,c=new Ogma.utils.PositionList(4);Ogma.shapes.nodes.diamond={draw:function(a,d,e,f,g,h,i,j,k,l){return b(e,f,g,h),a.quadrilateral(d,c[0],c[1],c[2],c[3],i,j,k,l)},detect:function(a,b,d,e,f){return c.reset(),c.setXY(a-d,b).setXY(a,b-d).setXY(a+d,b).setXY(a,b+d),Ogma.geometry.isPointInPolygon(e,f,c)}}}.call(),function(a){for(var Ogma=$global.Ogma,b=[],c=0;c<10;++c)b.push({x:0,y:0});var d={};Ogma.shapes.nodes.equilateral={draw:function(a,b,c,e,f,g,h,i,j,k,l){l=l||d;var m=l.numPoints||5,n=new Ogma.utils.PositionList(m),o=-Math.PI/2+(l.rotate||0),p=2*Math.PI/m;n.x=c,n.y=e;for(var q=0;q<m;++q){var r=Math.cos(o),s=Math.sin(o);n[q].setZXY(r*f,s*f),n[q].setOXY(r*g,s*g),o+=p}return a.polygon(b,n,h,i,j,k)},detect:function(a,c,d,e,f,g){for(var h=g.numPoints||5,i=-Math.PI/2+(g.rotate||0),j=2*Math.PI/h,k=0;k<h;++k)b[k].x=a+Math.cos(i)*d,b[k].y=c+Math.sin(i)*d,i+=j;return Ogma.geometry.isPointInPolygon(e,f,b,h)}}}.call(),function(a){var Ogma=$global.Ogma;Ogma.types={}}.call(),function(a){function b(){this.predicates={}}function c(a){return 0!==Ogma.colors.getIndex(a)}function d(a){return isFinite(a)&&a>=0}function e(){return!0}function f(a,b,c){return function(d,f){c=c||e;var h=null;return("undefined"==typeof d?"undefined":_typeof(d))===b&&c(d,f)||(h="expected "+a,f.values instanceof Array&&(f.values.indexOf(d)!==-1?h=null:h+=" or one of the following values: "+g(f.values))),h}}function g(b){for(var c="[",d=0;d<b.length;++d){var e=b[d];c+=e===a?"undefined":JSON.stringify(e),d!==b.length-1&&(c+=", ")}return c+="]"}var Ogma=$global.Ogma;b.prototype.check=function(a,b){var c;if("string"==typeof b.type){if(c=this.predicates[b.type],!c)throw new Error("type "+b.type+" is not a valid type. Valid types are "+JSON.stringify(Object.keys(this.predicates)))}else{if("function"!=typeof b.check){if(b.values instanceof Array)return b.values.indexOf(a)===-1?"expected one of following values: "+g(b.values):void 0;throw new Error('missing field "type", "check" or "values".')}c=b.check}return c(a,b)},b.prototype.register=function(a,b){this.predicates[a]=b},b.prototype.registerMultiple=function(a){Ogma.utils.forEach(a,function(a,b){this.register(b,a)},this)};var h=new b;Ogma.types.check=function(a,b){return h.check(a,b)},Ogma.types.register=function(a,b){h.register(a,b)},h.registerMultiple({string:f("string","string"),number:f("number","number"),boolean:f("boolean","boolean"),color:f("color","string",c),positive:f("finite positive number","number",d)})}.call(),function(a){function b(a){Object.defineProperty(Ogma.modules,a,{get:function(){},set:function(){throw new Error('A module cannot be named "'+a+'".')}})}var Ogma=$global.Ogma;Ogma.modules=Object.create(null),b("ogma"),b("modules"),b("clear"),b("kill")}.call(),function(a){function b(a){this._topology=a.topology,this._operators=Object.create(null),this._aggregators=Object.create(null),this.registerOperators(m)}function c(b,c){if("function"==typeof c)return null;if(!(c instanceof Array||"string"==typeof c))return"invalid expression "+JSON.stringify(c)+": an expression must be a string or an array of size at least one.";if("string"!=typeof c){if(c.length<1)return JSON.stringify(c)+" must have a length of at least one.";var f=d(b,c[0]),h=c[1]!==a&&null!==c[1]&&e(b,c[1]),i=c[2]!==a&&d(b,c[2]),j=c[3]!==a&&g(b,c[3]);if(f)return f;if(h)return h;if(i)return i;if(j)return j}return null}function d(a,b){var d="undefined"==typeof b?"undefined":_typeof(b);if("function"===d)return null;if(b instanceof Array){var e=c(a,b);if(e)return e}else if("string"!==d&&null!==b&&("object"!==d||!b.hasOwnProperty("value")))return JSON.stringify(b)+': invalid operand value. An operand can be an expression, a string, or an object containing the property "value".'}function e(a,b){if("string"!=typeof b||!a._operators[b])return"invalid operator "+JSON.stringify(b)+": operators must have one of the following values: "+JSON.stringify(Object.keys(a._operators))}function f(a){if(!(a instanceof Array))return 0;var b=a[3]?1:0,c=f(a[0]),d=a[1]?f(a[2]):0;return b+Math.max(c,d)}function g(a,b){if("object"!==("undefined"==typeof b?"undefined":_typeof(b))||null===b)return"invalid aggregator "+JSON.stringify(b)+": an aggregator must be an object with only one key among the following values: "+JSON.stringify(n);var c=Object.keys(b),d=c[0],e=b[d];return 1!==c.length||n.indexOf(d)===-1?"invalid aggregator "+JSON.stringify(b)+": an aggregator must be an object with only one key among the following values: "+JSON.stringify(n):"string"==typeof e&&a._aggregators[e]?void 0:"invalid aggregator name "+JSON.stringify(e)+": aggregators must have one of the following values: "+JSON.stringify(Object.keys(a._aggregators))}function h(a,b,c,d){if("function"==typeof c)return c(b);var e,f=null,g=null,h=null;if("string"==typeof c?e=c:(e=c[0],f=c[2],g=k(a,c[1])||null,h=c[3]),h&&b.isNode){for(var j=Object.keys(h),m=j[0],n=h[m],q=l(a,n),r=a._topology.getAdjacentElements(b,{type:p[m],direction:o[m]}),s=new Array(r.length),t=0;t<r.length;++t)s[t]=i(a,r[t],g,e,f,d);return q(s)}return i(a,b,g,e,f,d)}function i(b,c,d,e,f,g){var h=j(b,c,e,g);if(h===a&&g)return a;if(d){var i=f!==a&&null!==f?j(b,c,f,g):a;return d(h,i)}return h}function j(a,b,c,d){var e="undefined"==typeof c?"undefined":_typeof(c);if(c instanceof Array||"function"===e)return h(a,b,c,d);if("string"===e)return"."===c?b:Ogma.utils.strToObjectRef(b,c);if("object"===e&&null!==c&&c.hasOwnProperty("value")&&1===Object.keys(c).length)return c.value;throw new TypeError(c+" is not a valid operand")}function k(b,c){if(!c)return a;var d=b._operators[c];if(!d)throw new Error('Undefined operator "'+c+'".');return d}function l(a,b){var c=a._aggregators[b];if(!c)throw new Error('Undefined aggregator "'+b+'".');return c}var Ogma=$global.Ogma;b.dependencies=["topology"];var m={"===":function(a,b){return a===b},"==":function(a,b){return a==b},"!==":function(a,b){return a!==b},"!=":function(a,b){return a!=b},">":function(a,b){return a>b},"<":function(a,b){return a<b},">=":function(a,b){return a>=b},"<=":function(a,b){return a<=b},"&&":function(a,b){return a&&b},"||":function(a,b){return a||b},"+":function(a,b){return a+b},"-":function(a,b){return a-b},"*":function(a,b){return a*b},"/":function(a,b){return a/b},"!":function(a){return!a},not:function(a){return!a},includes:function(a,b){return a===b||a instanceof Array&&a.indexOf(b)!==-1}};b.prototype.computeExpression=function(a,b,c){return h(this,a,b,c)},b.prototype.checkExpressionFormat=function(a){return c(this,a)},b.prototype.expressionDepth=function(a){return f(a)},b.prototype.registerOperator=function(a,b,c){if(this._operators[a]&&!c)throw new Error("Operator "+a+" is already defined.");this._operators[a]=b},b.prototype.registerOperators=function(a,b){Ogma.utils.forEach(a,function(a,c){this.registerOperator(c,a,b)},this)},b.prototype.registerAggregator=function(a,b,c){if(this._aggregators[a]&&!c)throw new Error("Aggregator "+a+" is already defined.");this._aggregators[a]=b},b.prototype.registerAggregators=function(a,b){Ogma.utils.forEach(a,function(a,c){this.registerAggregator(c,a,b)},this)},b.prototype.operators=function(){return Ogma.utils.deepCopy(this._operators)},b.prototype.aggregators=function(){return Ogma.utils.deepCopy(this._aggregators)};var n=["nodes","edges","inNodes","outNodes","inEdges","outEdges"],o={nodes:"both",inNodes:"in",outNodes:"out",edges:"both",inEdges:"in",outEdges:"out"},p={nodes:"nodes",inNodes:"nodes",outNodes:"nodes",edges:"edges",inEdges:"edges",outEdges:"edges"};Ogma.modules.dsl=b}.call(),function(a){function b(a,b){if(b.fps){this._render=a.render,this._settings=a.settings.get("fps");var c=this._settings.average;this._dom=document.createElement("div"),this._domCurrent=document.createElement("div"),this._domAverage=document.createElement("div"),this._domCurrentText=document.createElement("span"),this._domCurrentValue=document.createElement("span"),this._domCurrentText.innerHTML=c?"Current FPS: ":"FPS: ",this._domAverageText=document.createElement("span"),this._domAverageValue=document.createElement("span"),this._domAverageText.innerHTML="Average FPS: ",this._domCurrentValue.id="ogma-current-fps",this._domAverageValue.id="ogma-average-fps",this._dom.style.position="absolute",this._dom.style.left="5px",this._dom.style.top="5px",this._dom.style.fontFamily="Arial",this._dom.style.backgroundColor="white",this._dom.style.border="solid 1px black",this._dom.style.padding="5px",this._domCurrent.appendChild(this._domCurrentText),this._domCurrent.appendChild(this._domCurrentValue),this._domAverage.appendChild(this._domAverageText),this._domAverage.appendChild(this._domAverageValue),this._dom.appendChild(this._domCurrent),c&&this._dom.appendChild(this._domAverage),this.reset();var d=this;a.events.bind({"render.newFrame":function(){d._nbFrames+=1;var a=Ogma.utils.now();a-d._lastDate>1e3&&(d._nbFrames>60&&(d._nbFrames=60),d._lastDate=a,d._records.push(d._nbFrames),d._average=Math.round(d._records.reduce(function(a,b){return a+b},0)/d._records.length),d._domCurrentValue.innerHTML=d._nbFrames,d._domAverageValue.innerHTML=d._average,d._nbFrames=0),d._render.refresh()},"drawing.everything":function(){d._nbFrames=0,d._average=0,d._lastDate=Ogma.utils.now(),d._records=[]},"render.setContainer":function(a){a&&a.appendChild(d._dom)}})}}var Ogma=$global.Ogma;b.dependencies=["render","drawing"],b.settings={average:{default:!1,type:"boolean"}},b.prototype.reset=function(){this._nbFrames=0,this._average=0,this._lastDate=Ogma.utils.now(),this._records=[],this._domCurrentValue.innerHTML="0",this._domAverageValue.innerHTML="0"},b.prototype.records=function(){return this._records.slice()},b.prototype.average=function(){return this._average},b.prototype.dom=function(){return this._dom},Ogma.modules.fps=b}.call(),function(){function a(a,b){return a.indexOf(b)!==-1}function b(a,b){if(void 0!==b&&("number"!=typeof b||!isFinite(b)))throw new TypeError("node "+a.id+": "+b+" is not a valid longitude")}function c(a,b){if(void 0!==b&&("number"!=typeof b||!isFinite(b)))throw new TypeError("node "+a.id+": "+b+" is not a valid latitude")}function d(a){a._init&&(a._tileSize=R*Ogma.utils.pixelRatio(),Ogma.utils.resizeElement(a._canvas,a._screen.width,a._screen.height),Ogma.utils.resizeElement(a._rcanvas,a._screen.width,a._screen.height))}function e(a){if(a._enabled){var b=a._settings.attribution;a._settings.attribution?a._brand.set(b):a._brand.remove()}}function f(a){a._settings.attribution&&a._brand.remove()}function g(a,b,c,d,e,f,g,i){b=b||a._ctx;var j=Math.ceil(e),k=a._settings.tileBuffer,l=j-e,n=1/Math.pow(2,l),o=a._tileSize*n,p=j,q=Ogma.utils.pixelRatio();c+=2*k*o,d+=2*k*o,a._settings.detectRetina&&(o/=q,p+=Math.log2(q));for(var r=N(f,g,p),s=0|r.x,t=0|r.y,u=r.x-s,v=r.y-t,w=c/2-u*o,x=d/2-v*o;w>0;)w-=o,s-=1;for(;x>0;)x-=o,t-=1;var y=!0;w-=k*o,x-=k*o;var z,A,B,C,D,E=[];for(z=w,A=s;z<c;z+=o,++A)for(B=x,C=t;B<d;B+=o,++C)E.push([A,C,z,B]);a._tileBounds=[s-k,t-k,A+k,C+k];var F=s+(A-s)/2,G=t+(C-t)/2,H=Ogma.geometry.squaredDistance;for(E.sort(function(a,b){return H(a[0],a[1],F,G)-H(b[0],b[1],F,G)}),z=0,D=E.length;z<D;z++){var I=E[z];y&=m(a,b,I[2],I[3],p,I[0],I[1],o,i)}return clearTimeout(a._pruneTimer),a._pruneTimer=setTimeout(function(){return h(a,p)},S),y}function h(a,b){var c,d,e,f,g,h={},j=a._settings.tileBuffer,k=a._tileBounds,h={};for(var l in a._tiles){var m=l.split("/"),n=parseInt(m[0]),f=parseInt(m[1]),g=parseInt(m[2]);h[n]=h[n]||[],h[n].push([f,g])}var o=[];for(var n in h){var p=parseInt(n),q=Math.pow(2,p-b),r=h[n];for(c=0,d=r.length;c<d;c++)e=r[c],f=e[0],g=e[1],(f<k[0]*q-j||f>k[2]*q+j||g<k[1]*q-j||g>k[3]*q+j)&&o.push(s(p,e[0],e[1]))}return i(a,o),o.length}function i(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c],f=a._tiles[e];f&&(f.err||f.loaded||V--,f.img&&r(f.img)),delete a._tiles[e]}}function j(a){i(a,Object.keys(a._tiles)),a._tiles={}}function k(a,b,c,d){if(a._enableMapBackground&&a._ctx){var e=a._ctx,f=a._lat,h=a._lng,i=a._zoom,j=Ogma.utils.pixelRatio(),l=a._screen.width*j,m=a._screen.height*j;e.globalAlpha=b||1,e.fillStyle=c||a._settings.backgroundColor,e.fillRect(0,0,l,m),b&&(e.globalAlpha=b),g(a,a._ctx,l,m,i,f,h,!0)?a._events.loaded():(clearTimeout(a._redrawTimer),a._redrawTimer=setTimeout(function(){return k(a,b,c)},U)),a._rctx.drawImage(a._canvas,0,0)}}function l(a){return a instanceof Image}function m(a,b,c,d,e,f,g,h,i){var j=t(a,e,f,g,!0);if(l(j))return b.drawImage(j,c,d,h,h),!0;if(j===Y.LOADING){if(i){var k;if(j=t(a,e-1,f/2|0,g/2|0,!1),l(j)){k=j.naturalWidth/2;var m=1&f?k:0,n=1&g?k:0;b.drawImage(j,m,n,k,k,c,d,h,h)}else{var o=t(a,e+1,2*f,2*g,!1),p=t(a,e+1,2*f+1,2*g,!1),q=t(a,e+1,2*f,2*g+1,!1),r=t(a,e+1,2*f+1,2*g+1,!1);l(o)&&l(p)&&l(q)&&l(r)&&(k=h/2,b.drawImage(o,c,d,k,k),b.drawImage(p,c+k,d,k,k),b.drawImage(q,c,d+k,k,k),b.drawImage(r,c+k,d+k,k,k))}}return!1}return!0}function n(a,b){var c=a._sIndex;return b.length>0?(c=(c+1)%b.length,a._sIndex=c,c):0}function o(a,b,c,d){var e=a._settings.tileUrlSubdomains,f=n(a,e);return a._settings.tileUrlTemplate.replace("{z}",d).replace("{x}",b).replace("{y}",c).replace("{s}",e.charAt(f))}function p(){V--,this._tile.err=!0,r(this)}function q(){V--,this._tile.loaded=!0,r(this)}function r(a){a.onLoad=a.onError=null,a._tile=null}function s(a,b,c){return a+"/"+b+"/"+c}function t(a,b,c,d,e){var f=Math.pow(2,b)-1;if(b<0||c<0||c>f||d<0||d>f)return Y.INVALID;var g=s(b,c,d),h=a._tiles[g];if(h)return h.err?Y.MISSING:h.loaded?h.img:Y.LOADING;if(e){if(!a._camera.animationInProgress()&&V<W){var i=new Image;h={img:i,err:!1,loaded:!1},i._tile=h,i.setAttribute("crossOrigin","anonymous"),i.onError=p,i.onload=q,i.src=o(a,c,d,b),V++}return a._tiles[g]=h,Y.LOADING}return Y.MISSING}function u(a,b,c,d){return c=c||function(){},b===a._enabled||a._transition||(a._enabled=b,a._transition=!0,b?v(a,function(){a._transition=!1,a._events.enabled(),a._events.ready(),c.call(d)}):w(a,function(){a._transition=!1,a._events.disabled(),c.call(d)})),new Promise(function(c,d){a._transition?a._ogma.events.once(b?"geo.enabled":"geo.disabled",c):c()})}function v(a,b){var c=a._render.getContainer(),d=a._settings.transitionDuration;c&&(a._init||A(a,c),c.insertBefore(a._rcanvas,c.firstChild)),a._enableTime=Ogma.utils.now(),a._enableMapBackground=!1,a._drawing.redrawEverything(),B(a,a._graph.nodes),J(a,a._graph.edges,"size","geo.prevSize");var f;a._locate.computeCameraConfig();a._onNodesAdded(a._ogma.nodes,[]),a._onEdgesAdded(a._ogma.edges,[]),G(a,!1,a._graph.edges),G(a,!0,a._graph.nodes),a._drawing.animate(function(){a._drawing.redrawEverything(),F(a,a._graph.nodes),f=a._locate.computeCameraConfig(),f.zoom=Math.pow(2,Math.floor(Math.log2(f.zoom))),a._camera.loadConfig(f)},d,function(){a._prevBgColor=a._render.setBackgroundColor(null),
a._cameraSettings=a._settingsModule.update("camera",{minZoom:1,maxZoom:Math.pow(2,a._settings.maxZoomLevel)}),a._cameraInteractionSettings=a._settingsModule.update("cameraInteractions",{cameraFixDuration:null,zoomModifier:2,rotationEnabled:!1}),a._enableMapBackground=!0,e(a),k(a,a._settings.opacity,a._settings.backgroundColor),b()})}function w(a,b){var c=a._render.getContainer();if(c){var d=a._settings.transitionDuration,e=a._settings.backgroundFadingDuration,g=Ogma.utils.now(),h=function h(){var i=Ogma.utils.now(),l=(i-g)/e;if(l<1)k(a,1-l,a._prevBgColor),setTimeout(h,17);else{var m;a._locate.computeCameraConfig();f(a),a._drawing.animate(function(){a._drawing.redrawEverything(),C(a,a._graph.nodes),m=a._locate.computeCameraConfig()},d,function(){D(a,a._graph.nodes),J(a,a._graph.edges,"geo.prevSize","size"),a._locate.center(),a._drawing.redrawEverything(),c.removeChild(a._rcanvas),a._render.setBackgroundColor(a._prevBgColor),a._settingsModule.update("camera",a._cameraSettings),a._settingsModule.update("cameraInteractions",a._cameraInteractionSettings),j(a),b()})}};setTimeout(h,17)}}function x(a){var b=a._camera,c=Math.log2(b.zoom),d=M(b.x-a._cameraDx,b.y-a._cameraDy);z(a,d[0],d[1],c)}function y(a){var b=L(a._lat,a._lng),c=Math.pow(2,a._zoom);a._camera.setCenter(b[0]+a._cameraDx,b[1]+a._cameraDy),a._camera.setZoom(c)}function z(a,b,c,d){if(a._enabled){a._zoom-d;a._lat=b,a._lng=c,a._zoom=d,k(a)}}function A(a,b){a._rcanvas=document.createElement("canvas"),a._rctx=a._rcanvas.getContext("2d"),a._canvas=document.createElement("canvas"),a._ctx=a._canvas.getContext("2d"),a._rcanvas.style.position="absolute",a._rcanvas.style.zIndex=+(b.style.zIndex||0)-1,a._init=!0,d(a)}function B(a,b){I(a,b,"x","geo.prevX"),I(a,b,"y","geo.prevY"),I(a,b,"size","geo.prevSize"),I(a,b,"latitude","geo.prevLat"),I(a,b,"longitude","geo.prevLng")}function C(a,b){I(a,b,"geo.prevX","x"),I(a,b,"geo.prevY","y")}function D(a,b){I(a,b,"geo.prevSize","size")}function E(a,b){I(a,b,"geo.prevLat","latitude"),I(a,b,"geo.prevLng","longitude"),F(a,b)}function F(a,b){for(var c=a._graph.attributes(!0),d=c.longitude,e=c.latitude,f=c.x,g=c.y,h=new Array(2),i=0,j=0,k=0,l=0,m=0,n=b.length;m<n;++m){var o=b[m].__index,p=e[o],q=d[o];if(void 0!==q&&void 0!==p){L(p,q,h);var r=h[0],s=h[1];i+=f[o],j+=g[o],k+=r,l+=s,f[o]=h[0],g[o]=h[1]}}for(var t=(i-k)/b.length,u=(j-l)/b.length,v=0,w=b.length;v<w;++v){var x=b[v].__index;f[x]+=t,g[x]+=u}a._cameraDx=t,a._cameraDy=u}function G(a,b,c){for(var d=a._graph.attributes(b),e=a._settings.sizeZoomReferential,f=Math.pow(2,e),g=d.size,h=d["geo.prevSize"],i=0,j=c.length;i<j;++i){var k=c[i].__index;g[k]=h[k]/f}}function H(a,b){for(var c=a._graph.attributes(!0),d=c.longitude,e=c.latitude,f=c.x,g=c.y,h=new Array(2),i=0,j=b.length;i<j;++i){var k=b[i].__index,l=e[k],m=d[k];void 0!==m&&void 0!==l&&(M(f[k]-a._cameraDx,g[k]-a._cameraDy,h),e[k]=h[0],d[k]=h[1])}}function I(a,b,c,d){K(a,!0,b,c,d)}function J(a,b,c,d){K(a,!1,b,c,d)}function K(a,b,c,d,e){for(var f=a._graph.attributes(b),g=f[d],h=f[e],i=0,j=c.length;i<j;++i){var k=c[i].__index;h[k]=g[k]}}function L(a,b,c){c=c||new Array(2);var d=Math.max(Math.min($,a),-$),e=Math.sin(d*aa);return c[0]=_*(ca*(Z*b*aa)+da),c[1]=_*(ea*(Z*Math.log((1+e)/(1-e))/2)+fa),c}function M(a,b,c){return c=c||new Array(2),a=(a/_-da)/ca,b=(b/_-fa)/ea,c[0]=(2*Math.atan(Math.exp(b/Z))-Math.PI/2)*ba,c[1]=a*ba/Z,c}function N(a,b,c){var d=1<<c;return a*=aa,{x:d*((b+180)/360),y:d*(1-Math.log(Math.tan(a)+1/Math.cos(a))/Math.PI)/2}}function O(a,b){var c=a._settings.maxZoomLevel;if("number"!=typeof b||!(b>=0&&b<=c))throw new Error("invalid zoom value "+b+": expected value between 0 and "+c)}function P(a,b){if("number"!=typeof a)throw new Error("invalid latitude "+a+": expected number");if("number"!=typeof b)throw new Error("invalid longitude "+b+": expected number")}var Ogma=$global.Ogma,Q={latitudePath:{default:"latitude",type:"string"},longitudePath:{default:"longitude",type:"string"},sizeZoomReferential:{default:5,type:"positive"},maxZoomLevel:{default:17,type:"positive"},tileUrlTemplate:{default:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png",type:"string"},tileUrlSubdomains:{default:"abc",type:"string"},attribution:{default:null,type:"string",values:[null]},backgroundColor:{default:"silver",type:"color"},opacity:{default:1,type:"positive"},transitionDuration:{default:0,type:"positive"},backgroundFadingDuration:{default:0,type:"positive"},detectRetina:{default:!1,type:"boolean"},tileBuffer:{default:1,type:"positive"}},R=256,S=500,T=100,U=100,V=0,W=10,X=function(){function f(a){var b=this;_classCallCheck(this,f),this._ogma=a,this._render=a.render,this._drawing=a.drawing,this._camera=a.camera,this._interactions=a.cameraInteractions,this._settingsModule=a.settings,this._locate=a.locate,this._brand=a.brand,this._settings=a.settings.get("geo",!0),this._graph=a.graph,this._screen=this._render.screen,this._tiles={},this._tileSize=R*Ogma.utils.pixelRatio(),this._enableMapBackground=!1,this._init=!1,this._enabled=!1,this._sIndex=0,this._lat=0,this._lng=0,this._zoom=1,this._zoomOffset=0,this._loadingTiles=0,this._cameraDx=this._cameraDy=0,this._graph.addNodeAttributes({"geo.prevX":Array,"geo.prevY":Array,"geo.prevLat":Array,"geo.prevLng":Array,"geo.prevSize":Array}),this._graph.addEdgeAttributes({"geo.prevSize":Array}),this._events=a.events.create("geo.",["enabled","disabled","loaded","ready"]),this._drawing.addNodeVisualProperty("longitude",{type:"number"},void 0,function(a){return F(b,[a])}),this._drawing.addNodeVisualProperty("latitude",{type:"number"},void 0,function(a){return F(b,[a])}),this._drawing.addNodeVisibilityCondition(function(a){return!b._enabled||void 0!==a.longitude&&void 0!==a.latitude}),this._drawing.addEdgeVisibilityCondition(function(a){return!b._enabled||void 0!==a.__source.longitude&&void 0!==a.__source.latitude&&void 0!==a.__target.longitude&&void 0!==a.__target.latitude}),a.on({"graph.addNodes":function(a,c){return b._onNodesAdded(a,c)},"graph.addEdges":function(a){return b._onEdgesAdded(a)},"render.setContainer":function(a){a&&A(b,a)},"settings.geo":function(a){return b._onSettingsChanged(a)},"camera.move":function(){return x(b)},"render.resize":function(){return b._onResize()},"drawing.nodes":function(a){return b._onNodesDrawn(a)}})}return _createClass(f,[{key:"_onNodesDrawn",value:function(a){this._enabled&&!this._transition&&H(this,a)}},{key:"_onResize",value:function(){d(this),x(this)}},{key:"_onNodesAdded",value:function(a,d){for(var e=this._settings.longitudePath,f=this._settings.latitudePath,g=this._graph.attributes(!0),h=g.longitude,i=g.latitude,j=Ogma.utils.strToObjectRef,k=0,l=a.length;k<l;++k){var m=a[k],n=m.__index,o=d[k]||m,p=j(o,e),q=j(o,f);m.hidden&&console.log(m),b(m,p),c(m,q),h[n]=p,i[n]=q}this._enabled&&(B(this,a),F(this,a),G(this,!0,a))}},{key:"_onEdgesAdded",value:function(a){this._enabled&&(J(this,this._graph.edges,"size","geo.prevSize"),G(this,!1,a))}},{key:"_onSettingsChanged",value:function(b){this._enabled&&(a(b,"tileUrlTemplate")&&(j(this),x(this)),a(b,"sizeZoomReferential")&&(G(this,!0,this._graph.nodes),G(this,!1,this._graph.edges),this._drawing.redrawEverything()),a(b,"attribution")&&e(this),a(b,"maxZoomLevel")&&this._settingsModule.update("camera",{minZoom:1,maxZoom:Math.pow(2,this._settings.maxZoomLevel)}))}},{key:"enable",value:function(a,b){return u(this,!0,a,b)}},{key:"disable",value:function(a,b){return u(this,!1,a,b)}},{key:"isEnabled",value:function(){return this._enabled}},{key:"toggle",value:function(a,b){return u(this,!this._enabled,a,b)}},{key:"resetCoordinates",value:function(){this._enabled&&(E(this,this._graph.nodes),F(this,this._graph.nodes))}},{key:"setView",value:function(a,b,c){if(!this._enabled)throw new Error("Geo mode is not enabled");O(this,c),P(a,b),z(this,a,b,c),y(this)}},{key:"setCenter",value:function(a,b){this.setView(a,b,this._zoom)}},{key:"setZoom",value:function(a){this.setView(this._lat,this._lng,a)}},{key:"getView",value:function(){return{latitude:this._lat,longitude:this._lng,zoom:this._zoom}}},{key:"getCenter",value:function(){return{latitude:this._lat,longitude:this._lng}}},{key:"getZoom",value:function(){return this._zoom}},{key:"exportBackground",value:function(a,b,c,d){var e=this;c=c||this._camera.saveConfig();var f=Math.log2(c.zoom),h=M(c.x-this._cameraDx,c.y-this._cameraDy);g(this,a.getContext("2d"),a.width,a.height,f,h[0],h[1],!1)?b():setTimeout(function(){return e.exportBackground(a,b,c)},T)}},{key:"whenReady",value:function(a,b){if("function"!=typeof a)throw new Error("Callback has to be a function");return this._transition?this._ogma.events.once("geo.ready",function(){a.call(b)}):a.call(b),this}}]),f}();X.dependencies=["render","settings","camera","cameraInteractions","graph","drawing","locate","brand"],X.settings=Q;var Y={INVALID:1,LOADING:2,MISSING:3},Z=6378137,$=85.0511287798,_=256,aa=Math.PI/180,ba=180/Math.PI,ca=.5/(Math.PI*Z),da=.5,ea=-ca,fa=.5;Ogma.modules.geo=X}(),function(){function a(a){var d=this;this._graph=a.graph,this._drawing=a.drawing,this._camera=a.camera,this._settings=a.settings.get("drag",!0),this._events=a.events.create("drag.",["start","progress","end"]),this._drawing.addLayer("drag",$C("layer","drag"));var e=this,f=null,g=0,h=0,i=0,j=0;this._dragNodes=a.exclusives.create({priority:$C("interaction","drag"),check:function(){return e._settings.manual},onStart:function(b,d,k){f=b.active?a.selection.nodes():[b];var l=c(e,d,k);g=l.x,h=l.y,i=0,j=0,f.forEach(function(a){return e._drawing.putElementOnLayer(a,"drag")}),e._events.start(f)},onProgress:function(a,d,k){var l=c(e,d,k),m=l.x-g,n=l.y-h;g=l.x,h=l.y,i+=m,j+=n,b(e,f,m,n)},onStop:function(){f.forEach(function(a){return e._drawing.removeElementFromLayer(a,"drag")}),e._events.end(f,i,j),f=null}}),a.on({"captor.startDragNode":function(a,b,c){return d._dragNodes.start(a,b,c)},"captor.dragNode":function(a,b,c){return d._dragNodes.progress(a,b,c)},"captor.endDragNode":function(a,b,c){return d._dragNodes.stop(a,b,c)}})}function b(a,b,c,d){for(var e=a._graph.attributes(!0),f=e.x,g=e.y,h=0,i=b.length;h<i;++h){var j=b[h].__index;f[j]+=c,g[j]+=d}a._drawing.redraw(b),a._events.progress(b,c,d)}function c(a,b,c){var d=Math.cos(a._camera.angle),e=Math.sin(a._camera.angle),f=b/a._camera.zoom,g=c/a._camera.zoom,h=d*f-e*g,i=e*f+d*g;return{x:h,y:i}}var Ogma=$global.Ogma,d={manual:{default:!0,type:"boolean"}};a.settings=d,a.dependencies=["graph","drawing","camera","events","captor","selection"],a.prototype.nodes=function(a,d,e,f){var g=f?c(this,d,e):{x:d,y:e};this._events.start(a),b(this,a,g.x,g.y),this._events.end(a,g.x,g.y)},Ogma.modules.drag=a}(),function(){var Ogma=$global.Ogma,a={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},b={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},c=function(){function c(a){_classCallCheck(this,c),this._render=a.render,this._settings=a.settings.get("brand",!0),this._container=null,this._brand=null;var b=this;a.events.bind({"render.setContainer":function(a,c){b._container=a,b._brand&&(c&&c.removeChild(b._brand),a&&a.appendChild(b._brand))}})}return _createClass(c,[{key:"set",value:function(c,d){this.remove();var e=document.createElement("div");e.innerHTML=c;var f=this._settings.position,g=this._settings.verticalMargin,h=this._settings.horizontalMargin;e.style.position="absolute",e.style[a[f]]=h+"px",e.style[b[f]]=g+"px",e.style.padding="0px 0px 0px 0px",e.style.zIndex="1000";var i=function(a){return a.stopPropagation()};e.addEventListener("mousemove",i),e.addEventListener("mousedown",i),e.addEventListener("mouseup",i),e.addEventListener("touchstart",i),e.addEventListener("touchend",i),d&&e.setAttribute("class",d),this._container&&this._container.appendChild(e),this._brand=e}},{key:"remove",value:function(){this._container&&this._brand&&this._container.removeChild(this._brand),this._brand=null}}]),c}();c.settings={position:{default:"bottom-right",values:["top-left","top-right","bottom-left","bottom-right"]},horizontalMargin:{default:0,type:"positive"},verticalMargin:{default:0,type:"positive"}},c.dependencies=["render"],c.onStart=function(a,b){b.brand&&a.set(b.brand)},c.onKill=function(a){a.remove()},Ogma.modules.brand=c}(),function(a){function b(a){this._graph=a.graph,this._camera=a.camera,this._renderer=a.render,this._drawing=a.drawing,this._shapes=a.shapes,this._settings=a.settings.get("halos"),this._shapeSettings=a.settings.get("shapes"),this._clusterCircles=[],this._drawing.addEdgeSubLayer("edgeHalos",$C("subLayer","edgeHalos")),this._drawing.addNodeSubLayer("nodeHaloStrokes",$C("subLayer","nodeHaloStrokes")),this._drawing.addNodeSubLayer("nodeHalos",$C("subLayer","nodeHalos")),this._drawing.addCommonVisualComponent("haloComponent",this._drawing.MIN_DEPTH),this._drawing.addNodeVisualComponent("haloStrokeComponent",this._drawing.MIN_DEPTH),this._drawing.addCommonVisualProperty("halo",{values:[!0,!1]},!1);var b=this;a.events.bind({"drawing.nodes":function(a){return e(b,a)},"drawing.edges":function(a){return f(b,a)},"camera.zoom":function(){return d(b)},"graph.clear":function(){for(var a=0;a<b._clusterCircles.length;++a)b.renderer.delete(b._clusterCircles[a])},"settings.halos":function(){b._settings=a.settings.get("halos"),b._drawing.redrawEverything()},"settings.shapes":function(){b._shapeSettings=a.settings.get("shapes"),b._drawing.redrawEverything()}})}function c(a,b,d,e,f){for(var g,h=0;h<a.length;++h){var i=a[h];if(i){for(var j=0,k=0,l=0,m=0;m<i.length;++m)g=i[m],j+=d.x[g],k+=d.y[g];for(j/=i.length,k/=i.length,m=0;m<i.length;++m)g=i[m],l=Math.max(l,Ogma.geometry.distance(j,k,d.x[g],d.y[g])+d.size[g]);for(m=h+1;m<a.length;++m){var n=a[m];if(n){for(var o=0,p=0,q=0,r=0;r<n.length;++r)g=n[r],o+=d.x[g],p+=d.y[g];for(o/=n.length,p/=n.length,r=0;r<n.length;++r)g=n[r],q=Math.max(q,Ogma.geometry.distance(o,p,d.x[g],d.y[g])+d.size[g]);var s=Ogma.geometry.distance(j,k,o,p)*e,t=l+q,u=t*e+2*b;if(s<=u&&u-b<=f)return a[h]=i.concat(n),a[m]=null,void c(a,b,d,e,f)}}}}}function d(a){if(a._settings.nodeClustering){for(var b=a._graph.nodeAttributes,d=a._graph.nodes.list,e=a._graph.nodes.size,f=b.halo,g=a._settings.nodeSize,i=a._settings.nodeColor,j=a._settings.nodeStrokeColor,k=a._settings.nodeStrokeWidth,l=a._camera.zoom,m=a._renderer,n=a._drawing.MIN_DEPTH,o=[],p=0;p<e;++p){var q=d[p];f[q]&&o.push([q])}for(c(o,g,b,l,a._settings.nodeClusteringMaxRadius/l),p=0;p<a._clusterCircles.length;++p)m.delete(a._clusterCircles[p]);for(a._clusterCircles=[],p=0;p<o.length;++p){var r=o[p];if(r&&1!==r.length){for(var s=0,t=0,u=0,v=0;v<r.length;++v)q=r[v],s+=b.x[q],t+=b.y[q];for(s/=r.length,t/=r.length,v=0;v<r.length;++v)q=r[v],u=Math.max(u,Ogma.geometry.distance(s,t,b.x[q],b.y[q])+b.size[q]);var w=m.circle(-1,h.setXY(s,t),0,u*l+g,i,"nodeHalos",n);if(a._clusterCircles.push(w),j){var x=m.circle(-1,h.setXY(s,t),0,u*l+g+k,j,"nodeHaloStrokes",n);a._clusterCircles.push(x)}}}}}function e(a,b){for(var c=a._graph.nodeAttributes,e=a._renderer,f=a._settings.nodeColor,g=a._settings.nodeSize,i=a._settings.nodeStrokeColor,j=a._settings.nodeStrokeWidth,k=a._drawing.MIN_DEPTH,l=c.halo,m=c.halo,n=c.haloComponent,o=c.haloStrokeComponent,p=c.size,q=c.x,r=c.y,s=c.depth,t=0,u=b.length;t<u;++t){var v=b[t].__index,w=k;m[v]&&s[v]!==-1||(w=-1),l[v]?(n[v]=e.circle(n[v],h.setXY(q[v],r[v]),p[v],g,f,"nodeHalos",w),i?o[v]=e.circle(o[v],h,p[v],g+j,i,"nodeHaloStrokes",w):o[v]=e.delete(o[v])):(n[v]=e.delete(n[v]),o[v]=e.delete(o[v]))}d(a)}function f(b,c){for(var d=b._graph.edgeAttributes,e=b._graph.nodeAttributes,f=b._renderer,g=b._settings.edgeColor,h=2*b._settings.edgeSize,i=b._drawing.MIN_DEPTH,j=Ogma.shapes.edges.line,k=d.halo,l=d.haloComponent,m=d.visible,n=d.source,o=d.target,p=d.curvature,q=d.curvature,r=e.x,s=e.y,t=e.size,u=d.size,v=d.shape,w=d.shapeParameters,x=b._shapeSettings.defaultEdgeShape,y=Ogma.shapes.edges,z=0,A=c.length;z<A;++z){var B=c[z].__index,C=n[B],D=o[B],E=p[B],F=q[B],G=r[C],H=s[C],I=t[C],J=r[D],K=s[D],L=t[D],M=u[B],N=y[v[B]||x],O=w[B];if(k[B]){var P,Q=F>=0?i:-1;m[B]||(Q=-1),P=C===D?(N.haloLoop||j.haloLoop)(f,l[B],G,H,M,h,E,I,g,"edgeHalos",Q,a,O):0!==E?(N.haloCurved||j.haloCurved)(f,l[B],G,H,J,K,M,h,E,I,L,g,"edgeHalos",Q,a,O):(N.haloStraight||j.haloStraight)(f,l[B],G,H,J,K,M,h,I,L,g,"edgeHalos",Q,a,O),l[B]=P}else l[B]=f.delete(l[B])}}var Ogma=$global.Ogma,g={nodeColor:{default:"white",type:"color"},nodeSize:{default:50,type:"positive"},nodeStrokeColor:{default:a,type:"color",values:[a]},nodeStrokeWidth:{default:1,type:"positive"},nodeClustering:{default:!1,type:"boolean"},nodeClusteringMaxRadius:{default:1e3,type:"positive"},edgeColor:{default:"white",type:"color"},edgeSize:{default:10,type:"positive"}};b.dependencies=["graph","camera","render","drawing","shapes"],b.settings=g;var h=new Ogma.utils.Position;Ogma.modules.halos=b}.call(),function(a){function b(a){var b=this,c=this;this._events=a.events.create("graph.",["addNodes","addEdges","startInit","endInit","nodeDataChange","edgeDataChange"],["clear","removeNodes","removeEdges"]),this._maps=$dual(Ogma.utils.Map),this._elts=$dual(Ogma.utils.StaticList),this._properties=$dual(Object),this._getters=$dual(Object),this._subClasses=$dual(Object),this._NodeClass=d(),this._EdgeClass=e(),Object.defineProperty(this._NodeClass.prototype,"isNode",{value:!0,enumerable:!0}),Object.defineProperty(this._EdgeClass.prototype,"isNode",{value:!1,enumerable:!0}),this._NodeClass.prototype.toJSON=function(){return c.cloneElement(this)},this._EdgeClass.prototype.toJSON=function(){return c.cloneElement(this)},this._nodeList=[],this._edgeList=[],Ogma.utils.setReadOnly(this,{nodes:function(){return b._nodeList},edges:function(){return b._edgeList}}),this.nodeAttributes=this._elts.nodes.attributes,this.edgeAttributes=this._elts.edges.attributes,this._insertionCounter=0,this._elts.nodes.addAttributes({ref:Array,id:Array,insertionOrder:Int32Array,edges:Array}),this._elts.edges.addAttributes({ref:Array,id:Array,source:Int32Array,target:Int32Array,insertionOrder:Int32Array,sourceId:Array,targetId:Array});var f=this._elts.nodes.attributes,g=this._elts.edges.attributes;this.nodeAttributes=f,this.edgeAttributes=g,this.addNodeReadOnlyProperty("id",function(a){return f.id[a.__index]}),this.addEdgeReadOnlyProperty("id",function(a){return g.id[a.__index]}),this.addNodeReadOnlyProperty("edges",function(a){return f.edges[a.__index]},!1),this.addEdgeReadOnlyProperty("source",function(a){return g.sourceId[a.__index]}),this.addEdgeReadOnlyProperty("target",function(a){return g.targetId[a.__index]})}function c(b,c,d,e){if(d.isNode!==c)throw new TypeError(d.id+" is not a "+(c?"node":"edge"));for(var f=d.__index,g=b._elts.fetch(c).attributes,h=b._properties.fetch(c),i=Object.keys(h),j=0;j<i.length;++j){var k=i[j];if(Ogma.utils.hasProperty(e,k)){var l=h[k],m=l.type,n=l.defaultValue,o=Ogma.utils.strToObjectRef(e,k);Ogma.utils.typeCheck.property(k,o,m),o===a&&(o=n),g[k][f]=o}}}function d(){var a=function(a,b){Object.defineProperty(this,"__index",{value:a}),Object.defineProperty(this,"__self",{value:b||this})};return a}function e(){var a=function(a,b,c,d){Object.defineProperty(this,"__index",{value:a}),Object.defineProperty(this,"__sourceIndex",{value:b.__index,writable:!0}),Object.defineProperty(this,"__targetIndex",{value:c.__index,writable:!0}),Object.defineProperty(this,"__source",{value:b,writable:!0}),Object.defineProperty(this,"__target",{value:c,writable:!0}),Object.defineProperty(this,"__self",{value:d||this})};return a}function f(a){return a?d():e()}function g(){}function h(a,b,c){var d,e=a[b?"_NodeClass":"_EdgeClass"];if("undefined"==typeof c)d=a[b?"nodes":"edges"].slice();else if(c instanceof Array){d=new Array(c.length);for(var f=0;f<c.length;++f){var g=c[f];g instanceof e?d[f]=g:d[f]=a.getElement(b,g,!0)}}else d=[a.getElement(b,c,!0)];return d}function i(a){var b="undefined"==typeof a?"undefined":_typeof(a);return"string"===b||"number"===b}function j(a){return"object"===("undefined"==typeof a?"undefined":_typeof(a))&&null!==a}var Ogma=$global.Ogma;b.dependencies=["events"],b.onStart=function(a,b){"object"===_typeof(b.graph)&&null!==b.graph&&a.init(b.graph.nodes||[],b.graph.edges||[])},b.onClear=function(a){a.clear()},b.prototype.init=function(a,b){if(this._elts.nodes.size)throw new Error("graph is not empty");this._events.startInit(),this.initializing=!0,this.addNodes(a),this.addEdges(b),this.initializing=!1,this._events.endInit()},b.prototype.clear=function(){this._events.clear(),this._elts.nodes.clear(),this._elts.edges.clear(),this._nodeList=[],this._edgeList=[],this._maps.nodes.clear(),this._maps.edges.clear()},b.prototype.updateElement=function(a,b,d){c(this,a,b,d)},b.prototype.updateNode=function(a,b){c(this,!0,a,b)},b.prototype.updateEdge=function(a,b){c(this,!1,a,b)},b.prototype.addElements=function(a,b){return a?this.addNodes(b):this.addEdges(b)},b.prototype.addElement=function(a,b){return a?this.addNode(b):this.addEdge(b)},b.prototype.addNodes=function(b){this._elts.nodes.reserve(this._elts.nodes.size+b.length);for(var c=this._elts.nodes.attributes.id,d=this._elts.nodes.attributes.ref,e=this._elts.nodes.attributes.insertionOrder,f=this._elts.nodes.attributes.edges,g=this._maps.nodes,h=this._nodeList,k=this._elts.nodes,l=b.length,m=new Array(l),n=this._NodeClass,o=this._subClasses.nodes,p=Object.keys(o),q=this._properties.nodes,r=Object.keys(q),s=r.map(function(a){return q[a]}),t=this._elts.nodes.attributes,u=0;u<l;++u){var v=b[u];if(!j(v))throw new TypeError('invalid node "'+v+'": expected object');if(!i(v.id))throw new TypeError('invalid node id "'+v.id+"\": a node's id must be a number or a string");if(g.has(v.id))throw new Error('invalid node id "'+v.id+'": duplicate id'+("number"==typeof v.id?"(possibly previously added as a string)":""));for(var w=k.addElement(),x=new n(w),y=v.id,z=0;z<p.length;++z){var A=p[z],B=o[A];Object.defineProperty(x,A,{value:new B(w,x)})}for(x.data=v.data,z=0;z<r.length;++z){var C=r[z],D=s[z],E=D.type,F=D.defaultValue,G=Ogma.utils.strToObjectRef(v,C);Ogma.utils.typeCheck.property(C,G,E),G===a&&(G=F),t[C][w]=G}d[w]=x,c[w]=y,e[w]=++this._insertionCounter,f[w]=[],h.push(x),g.set(y,x),m[u]=x}return m.length&&this._events.addNodes(m,b),m},b.prototype.addEdges=function(b){this._elts.edges.reserve(this._elts.edges.size+b.length);for(var c=this._elts.edges.attributes.id,d=this._elts.edges.attributes.ref,e=this._elts.edges.attributes.insertionOrder,f=this._elts.edges.attributes.source,g=this._elts.edges.attributes.target,h=this._elts.edges.attributes.sourceId,k=this._elts.edges.attributes.targetId,l=this._elts.nodes.attributes.edges,m=this._elts.nodes.attributes.id,n=this._maps.edges,o=this._maps.nodes,p=this._edgeList,q=this._elts.edges,r=b.length,s=new Array(r),t=this._EdgeClass,u=this._subClasses.edges,v=Object.keys(u),w=this._properties.edges,x=Object.keys(w),y=x.map(function(a){return w[a]}),z=this._elts.edges.attributes,A=0;A<r;++A){var B=b[A];if(!j(B))throw new TypeError("invalid edge "+B+": expected object");if(!i(B.id))throw new TypeError("invalid edge id "+B.id+": a edge's id must be a number or a string");if(n.has(B.id))throw new Error("invalid node id "+B.id+": duplicate id");var C=o.get(B.source),D=o.get(B.target);if(!C)throw new Error("invalid source id "+B.source+": no node has this id");if(!D)throw new Error("invalid target id "+B.target+": no node has this id");for(var E=q.addElement(),F=C.__index,G=D.__index,H=new t(E,C,D),I=B.id,J=0;J<v.length;++J){var K=v[A],L=u[K];Object.defineProperty(H,K,{value:new L(E,C,D,H)})}for(H.data=B.data,J=0;J<x.length;++J){var M=x[J],N=y[J],O=N.type,P=N.defaultValue,Q=Ogma.utils.strToObjectRef(B,M);Ogma.utils.typeCheck.property(M,Q,O),Q===a&&(Q=P),z[M][E]=Q}f[E]=F,g[E]=G,h[E]=m[F],k[E]=m[G],d[E]=H,c[E]=I,e[E]=++this._insertionCounter,l[F].push(H),F!==G&&l[G].push(H),p.push(H),n.set(I,H),s[A]=H}return s.length&&this._events.addEdges(s,b),s},b.prototype.removeNodes=function(a){if(a.length){for(var b=a.length,c=this._maps.nodes,d=this._elts.nodes,e=this._elts.edges.attributes.id,f=[],g=this._elts.nodes.attributes.edges,h=[],i=0;i<b;++i){var j=a[i],k=c.get(j);if(k){for(var l=k.__index,m=g[l],n=0;n<m.length;++n)h.push(e[m[n].__index]);f.push(k),g[l]=[]}}for(this.removeEdges(h),i=0;i<a.length;++i)c.delete(a[i]);for(this._nodeList=c.values(),f.length&&this._events.removeNodes(f),i=0;i<f.length;++i)d.removeElement(f[i].__index)}},b.prototype.removeEdges=function(a){if(a.length){for(var b=this._maps.edges,c=this._elts.edges,d=this._elts.nodes.attributes.edges,e=[],f=a.length,g=0;g<f;++g){var h=a[g],i=b.get(h);if(i){var j=i.__sourceIndex,k=i.__targetIndex,l=d[j],m=d[k],n=l.indexOf(i),o=m.indexOf(i);n!==-1&&l.splice(n,1),o!==-1&&j!==k&&m.splice(o,1),b.delete(h),e.push(i)}}for(this._edgeList=b.values(),e.length&&this._events.removeEdges(e),g=0;g<e.length;++g)c.removeElement(e[g].__index)}},b.prototype.addNode=function(a){return this.addNodes([a])[0]},b.prototype.addEdge=function(a){return this.addEdges([a])[0]},b.prototype.removeElements=function(a,b){return this[a?"removeNodes":"removeEdges"](b)},b.prototype.removeNode=function(a){return this.removeNodes([a])},b.prototype.removeEdge=function(a){this.removeEdges([a])},b.prototype.removeElement=function(a,b){return a?this.removeNode(b):this.removeEdge(b)},b.prototype.addNodeReadOnlyProperty=function(a,b,c){return this.addReadOnlyProperty(!0,a,b,c)},b.prototype.addEdgeReadOnlyProperty=function(a,b,c){return this.addReadOnlyProperty(!1,a,b,c)},b.prototype.addReadOnlyProperty=function(a,b,c,d){var e=this._getters.fetch(a),g=this._properties.fetch(a),h=this[a?"_NodeClass":"_EdgeClass"],i=b.split(".");if(e[b]||g[b])throw new Error((a?"node":"edge")+" property "+b+" already exists");e[b]={func:c,serializable:$or(d,!0)};var j=function(){return c(this.__self)};if(i.length>1){var k=i[0],l=this._subClasses.fetch(a)[k];l||(l=f(a),this._subClasses.fetch(a)[k]=l),Object.defineProperty(l.prototype,i[1],{get:j})}else Object.defineProperty(h.prototype,b,{get:j})},b.prototype.addNodeProperty=function(a,b,c,d){this.addProperty(!0,a,b,c,d)},b.prototype.addEdgeProperty=function(a,b,c,d){this.addProperty(!1,a,b,c,d)},b.prototype.addProperty=function(b,c,d,e,h){function i(b){Ogma.utils.typeCheck.property(c,b,d),b===a&&(b=e);var f=p[c],g=f[this.__index];f[this.__index]=b,h(this.__self,b,g!==b)}function j(){return p[c][this.__index]}var k=this._getters.fetch(b),l=this._properties.fetch(b),m=this[b?"_NodeClass":"_EdgeClass"],n=c.split("."),o=this._elts.fetch(b),p=o.attributes;if(k[c]||l[c])throw new Error((b?"node":"edge")+" property "+c+" already exists");if(o.addAttribute(c,Array),h=h||g,d=Ogma.utils.deepCopy(d),d.required=!1,l[c]={type:d,defaultValue:e},n.length>1){var q=n[0],r=this._subClasses.fetch(b)[q];r||(r=f(b),this._subClasses.fetch(b)[q]=r),Object.defineProperty(r.prototype,n[1],{get:j,set:i,enumerable:!0})}else Object.defineProperty(m.prototype,c,{get:j,set:i,enumerable:!0})},b.prototype.addCommonProperty=function(a,b,c,d){this.addProperty(!0,a,b,c,d),this.addProperty(!1,a,b,c,d)},b.prototype.createNodeSet=function(){return this.createElementSet(!0)},b.prototype.createEdgeSet=function(){return this.createElementSet(!1)},b.prototype.createElementSet=function(a){return new Ogma.utils.ElementSet(this._elts.fetch(a).attributes)},b.prototype.createDualSet=function(){return new Ogma.utils.BiSet(this._elts.nodes.attributes,this._elts.edges.attributes)},b.prototype.addAttribute=function(a,b){this._elts.fetch(a).addAttribute(b,Array)},b.prototype.addNodeAttributes=function(a){this._elts.nodes.addAttributes(a)},b.prototype.addEdgeAttributes=function(a){this._elts.edges.addAttributes(a)},b.prototype.addCommonAttributes=function(a){this._elts.nodes.addAttributes(a),this._elts.edges.addAttributes(a)},b.prototype.attributes=function(a){return this._elts.fetch(a).attributes},b.prototype.unusedNodeId=function(){return this.unusedId(!0)},b.prototype.unusedEdgeId=function(){return this.unusedId(!1)},b.prototype.unusedId=function(a){do var b=Math.random().toString().substr(2);while(this._maps.fetch(a).has(b));return b},b.prototype.notifyNodeDataChange=function(a){this.notifyDataChange(!0,a)},b.prototype.notifyEdgeDataChange=function(a){this.notifyDataChange(!1,a)},b.prototype.notifyDataChange=function(a,b){var c=h(this,a,b);this._events[a?"nodeDataChange":"edgeDataChange"](c)},b.prototype.getNode=function(a,b){return this.getElement(!0,a,b)},b.prototype.getEdge=function(a,b){return this.getElement(!1,a,b)},b.prototype.getElement=function(a,b,c){if("string"!=typeof b&&"number"!=typeof b)throw new TypeError("invalid "+(a?"node":"edge")+" id "+b+": expected string or number");var d=this._maps.fetch(a).get(b);if(!d&&c)throw new Error((a?"node":"edge")+" "+b+" does not exist");return d},b.prototype.cloneNode=function(a){return this.cloneElement(a)},b.prototype.cloneEdge=function(a){return this.cloneElement(a)},b.prototype.cloneElement=function(b){var c={},d=this._properties.fetch(b.isNode),e=this._getters.fetch(b.isNode),f=Object.keys(d).sort(),g=Object.keys(e).sort();for(h=0;h<g.length;++h)i=g[h],e[i].serializable&&(j=Ogma.utils.strToObjectRef(b,i),j!==a&&Ogma.utils.setPathValue(c,i,j));for(var h=0;h<f.length;++h){var i=f[h],j=Ogma.utils.strToObjectRef(b,i);j!==a&&Ogma.utils.setPathValue(c,i,j)}return c.isNode=b.isNode,c.data=b.data,c},b.prototype.getNodeIdList=function(){return this.nodes.map(function(a){return a.id})},b.prototype.getEdgeIdList=function(){return this.edges.map(function(a){return a.id})},b.prototype.getNodeList=function(a){return this.getElementList(!0,a)},b.prototype.getEdgeList=function(a){return this.getElementList(!1,a)},b.prototype.getElementList=function(a,b){return h(this,a,b)},b.prototype.forEachNode=function(a){this._nodeList.forEach(a)},b.prototype.forEachEdge=function(a){this._edgeList.forEach(a)},Object.defineProperty(Ogma.prototype,"nodes",{get:function(){return this.graph.nodes}}),Object.defineProperty(Ogma.prototype,"edges",{get:function(){return this.graph.edges}}),Ogma.modules.graph=b}.call(),function(){function a(a,b){var d=this;this._libs=a.libraries,this._settings=a.settings.get("touch",!0),this._dom=a.render.getCanvas(),this._events=a.events.create("touch.",["down","up","tap","doubleTap","move","startGesture","gesture","endGesture"]),this._enabled=!0,this._dom=null,this._binds=[],this._x=0,this._y=0,this._pressed=!1,Ogma.utils.setReadOnly(this,{x:function(){return d._x},y:function(){return d._y},pressed:function(){return d._pressed}}),$or(b.touch,!0)&&this._dom&&c(this)}function b(a){a._binds.forEach(function(a){return Ogma.utils.unbind(a)}),a._binds=[]}function c(a){var b=null,c=0,d=0,e=0,f=0,g=!1,h=0,i=!1,j=a._events,k=!1,l=1,m=0,n=function(){a._x=c,a._y=d,a._pressed=g},o=function(a,b,e,f){l=a,m=b,c=e,d=f,n()},p=function(b){var e=a._dom.getBoundingClientRect(),f=b.touches[0].clientX-e.left,g=b.touches[0].clientY-e.top,h=b.touches[1].clientX-e.left,i=b.touches[1].clientY-e.top,j=(f+h)/2,k=(g+i)/2,n=j-c,p=k-d,q=(Math.sqrt(n*n+p*p),Ogma.geometry.distance(f,g,h,i)),r=q/l,s=Ogma.geometry.lineAngle(f,g,h,i),t=s-m,u={dx:n,dy:p,rotation:t,scale:r};return o(q,s,j,k),u},q=function(a){return 2!==a.touches.length&&k?(k=!1,j.endGesture()):2!==a.touches.length||k||(k=!0,p(a,!0),j.startGesture()),2===a.touches.length},r=function(a){if(2===a.touches.length&&k){var b=p(a);j.gesture(b,c,d)}},s=function(b,c){a._binds.push(Ogma.utils.bind(a._dom,b,function(b){a._settings.enabled&&a._enabled&&c(b)},a._settings.eventRate))},t=function(b){if(e=c,f=d,1!==b.touches.length)g=!1,b.touches.length>1&&j.up(c,d);else{var h=a._dom.getBoundingClientRect();c=b.touches[0].clientX-h.left,d=b.touches[0].clientY-h.top,g=!0}return n(),1===b.touches.length},u=function(){b=null,h=0};s("touchstart",function(e){q(e),t(e)&&(j.down(c,d),h+=1,b=setTimeout(u,a._events.doubleTapTimer),i=!0)});var v=function(a){q(a),t(a),0===a.touches.length&&(1===h?j.tap(c,d):h>1&&(j.doubleTap(c,d),u()),j.up(c,d))};s("touchend",v),s("touchcancel",v),s("touchmove",function(a){return r(a),i?void(i=!1):(u(),void(t(a)&&j.move(c,d,c-e,d-f)))});var w=function(a){return a.preventDefault()};s("touchstart",w),s("touchend",w),
s("touchcancel",w)}var Ogma=$global.Ogma,d={enabled:{default:!0,type:"boolean"},doubleTapTimer:{default:500,type:"positive"},eventRate:{default:15,type:"positive"}};a.settings=d,a.dependencies=["render"],a.onKill=function(a){b(a)},Ogma.modules.touch=a}(),function(a){function b(a){var b=this;this._graph=a.graph,this._shapes=a.shapes,this._drawing=a.drawing,this._texts=a.texts,this._mouse=a.mouse,this._renderer=a.render,this._settings=a.settings.get("hover",!0),this._drawing.addLayer("hover",{level:$C("layer","hover"),disableThreshold:!0},c(this)),this._timeout=null,this._hovered=null,a.events.bind({"captor.hoverNode captor.hoverEdge":function(a){(a.isNode&&b._settings.nodes||!a.isNode&&b._settings.edges)&&e(b,a)},"captor.unhoverNode captor.unhoverEdge":function(a){f(b,a)}})}function c(a){return{nodeFontStyle:a._settings.nodeTextFontStyle,nodeFontColor:a._settings.nodeTextFontColor,nodeTextBackgroundColor:a._settings.nodeTextBackgroundColor,edgeFontStyle:a._settings.edgeTextFontStyle,edgeFontColor:a._settings.edgeTextFontColor,edgeTextBackgroundColor:a._settings.edgeTextBackgroundColor,nodeOuterStrokeColor:a._settings.nodeOuterStrokeColor,edgeOuterStrokeColor:a._settings.edgeColor,outline:a._settings.outline}}function d(a){a._timeout&&(clearTimeout(a._timeout),a._timeout=null)}function e(a,b){if(d(a),!a._drawing.isAnimating()){var c=a._settings.delay,e=function d(){a._drawing.isAnimating()?a._timeout=setTimeout(d,c):(g(a,b),a._hovered=b,a._timeout=null)};a._timeout=setTimeout(e,c)}}function f(a,b){d(a),a._hovered===b&&(h(a,b),a._hovered=null)}function g(a,b){var c=b.isNode;a._drawing.putElementOnLayer(b,"hover"),a._renderer.setCursorStyle(a._settings[c?"nodeCursorStyle":"edgeCursorStyle"]),c||(a._drawing.putNodeOnLayer($source(b),"hover"),a._drawing.putNodeOnLayer($target(b),"hover"))}function h(a,b){var c=b.isNode;a._drawing.removeElementFromLayer(b,"hover"),a._renderer.removeCursorStyle(a._settings[c?"nodeCursorStyle":"edgeCursorStyle"]),c||(a._drawing.removeNodeFromLayer($source(b),"hover"),a._drawing.removeNodeFromLayer($target(b),"hover"))}var Ogma=$global.Ogma,i={nodeOuterStrokeColor:{default:"red",type:"color",values:["inherit",null]},edgeColor:{default:"red",type:"color",values:["inherit",null]},highlightEdgeExtremities:{default:!0,type:"boolean"},nodeCursorStyle:{default:"pointer",type:"string"},edgeCursorStyle:{default:"pointer",type:"string"},nodeTextBackgroundColor:{default:"rgb(220, 220, 220)",type:"color",values:[a,null]},nodeTextFontStyle:{default:a,values:[a,"none","italic","bold"]},nodeTextFontColor:{default:a,type:"color",values:[a]},edgeTextBackgroundColor:{default:"rgb(220, 220, 220)",type:"color",values:[a,null]},edgeTextFontStyle:{default:a,values:[a,"none","italic","bold"]},edgeTextFontColor:{default:a,type:"color",values:[a]},outline:{default:!0,type:"boolean"},nodes:{default:!0,type:"boolean"},edges:{default:!0,type:"boolean"},delay:{default:100,type:"positive"}};b.dependencies=["graph","shapes","drawing","texts","mouse","render","exclusives"],b.settings=i,Ogma.modules.hover=b}.call(),function(a){function b(a){this._graph=a.graph,this._drawing=a.drawing,this._renderer=a.render,this._settings=a.settings.get("icons"),this._drawing.addNodeSubLayer("nodeIcons",{symbolicSizeThreshold:this._settings.threshold,level:$C("subLayer","nodeIcons"),useClipSpace:!0}),this._drawing.addNodeVisualProperty("icon.font",{type:"string"}),this._drawing.addNodeVisualProperty("icon.content",{type:"string"}),this._drawing.addNodeVisualProperty("icon.scale",{type:"number"}),this._drawing.addNodeVisualProperty("icon.color",{type:"string"}),this._drawing.addNodeVisualComponent("iconComponent");var b=this;a.events.bind({"drawing.nodes":function(a){return c(b,a)},"settings.icons":function(){b._drawing.changeSubLayerThreshold("nodeIcons",b._settings.threshold),b._drawing.redrawEverything()}})}function c(a,b){for(var c=a._graph.nodeAttributes,d=a._renderer,e=new Ogma.utils.Position,f=c["icon.font"],g=c["icon.scale"],h=c["icon.content"],i=c["icon.color"],j=0;j<b.length;++j){var k=b[j].__index,l=f[k]||a._settings.defaultFont,m=g[k]||a._settings.defaultScale,n=h[k],o=i[k]||a._settings.defaultColor;e.x=c.x[k],e.y=c.y[k],n?c.iconComponent[k]=d.text(c.iconComponent[k],e,n,l,c.size[k]*m,0,o,"none","center","middle","nodeIcons",c.depth[k],c.size[k]):c.iconComponent[k]=d.delete(c.iconComponent[k])}}var Ogma=$global.Ogma;b.dependencies=["graph","drawing","render","images"],b.settings={defaultFont:{default:"Arial",type:"string"},defaultColor:{default:"black",type:"color"},defaultScale:{default:1.4,type:"positive"},threshold:{default:10,type:"positive"}},Ogma.modules.icons=b}.call(),function(a){function b(a){this._render=a.render,this._registered=[],this._associatedFunctions=[],this._toUpdate=[],this._batch=!1;var b=this;a.events.bind({"render.beforeNewFrame":function(){var a=b._toUpdate;b._toUpdate=[];for(var c=0;c<a.length;++c)b._registered[a[c]]()}})}function c(a,b){a.indexOf(b)===-1&&a.push(b)}var Ogma=$global.Ogma;b.dependencies=["render"],b.prototype.create=function(a){var b=this._registered.indexOf(a),d=this;return b===-1&&(b=this._registered.length,this._registered.push(a),this._associatedFunctions.push(function(){d._render.refresh(),c(d._toUpdate,b)})),this._associatedFunctions[b]},Ogma.modules.batch=b}.call(),function(a){function b(a){var b=this;this._ogma=a,this._graph=a.graph,this._renderer=a.render,this._camera=a.camera,this._drawing=a.drawing,this._partitions=a.partitions,this._render=a.render,this._batch=a.batch,this._settings=a.settings.get("texts",!0),this._shapesSettings=a.settings.get("shapes",!0),this._screen=this._renderer.screen,this._graph.addCommonAttributes({textBoundingBox:Array}),this._drawing.addNodeSubLayer("nodeTextBackground",$C("subLayer","nodeTextBackground")),this._drawing.addNodeSubLayer("nodeText",$C("subLayer","nodeText")),this._drawing.addEdgeSubLayer("edgeTextBackground",$C("subLayer","edgeTextBackground")),this._drawing.addEdgeSubLayer("edgeText",$C("subLayer","edgeText")),this._drawing.addCommonVisualComponent("textComponent","top-layer",this._settings.preventOverlap),this._drawing.addCommonVisualComponent("textBackgroundComponent","top-layer",this._settings.preventOverlap),this._drawing.addNodeVisualComponent("textIndicatorComponent","top-layer",this._settings.preventOverlap),this._drawing.addCommonVisualProperty("text",{type:"string"}),this._nodeTextDrawingEnabled=!0,this._edgeTextDrawingEnabled=!0,this._nodePartitionList=null,this._edgePartitionList=null,this._cellSize=null,this._nodeGrid=null,this._edgeGrid=null,this._timeout=null;var h=function(){d(b),e(b,!0),e(b,!1),b._timeout=null};this._updateGrid=function(){b._timeout&&clearTimeout(b._timeout),b._timeout=setTimeout(h,200)},f(b),a.events.bind({"settings.texts":function(){return f(b)},"graph.addNodes":function(a){return g(b,!0,a)},"graph.addEdges":function(a){return g(b,!1,a)},"drawing.nodes":function(a){j(b,a,!0)},"drawing.edges":function(a){j(b,a,!1)},"render.resize":function(){c(b),b._updateGrid()},"camera.move":function(a){a&&b._updateGrid()}}),c(this)}function c(a){a._cellSize=Math.min(a._settings.nodeFontSize,a._settings.edgeFontSize)-1,a._cellSize<1&&(a._cellSize=1),a._gridW=Math.ceil(a._screen.width/a._cellSize),a._gridH=Math.ceil(a._screen.height/a._cellSize),a._gridLength=a._gridW*a._gridH,a._nodeGrid=new Int32Array(a._gridLength),a._edgeGrid=new Int32Array(a._gridLength),d(a)}function d(a){a._settings.preventOverlap&&(a._nodeGrid.fill(-1),a._edgeGrid.fill(-1))}function e(a,b){var c=a._drawing.topOfLayer,d=a._graph._elts.fetch(b),e=d.attributes,f=e.exists,g=d.totalSize,h=a._cellSize,i=a._gridW-1,j=a._gridH-1,k=a._gridH,l=a._camera.zoom,m=a._camera.x-a._render.screen.width/2/l,o=a._camera.y-a._render.screen.height/2/l,p=(a._settings[b?"nodeBackgroundMargin":"edgeBackgroundMargin"],a._camera.angle),r=Math.cos(a._camera.angle),s=Math.sin(a._camera.angle),t=a._settings[b?"nodeSizeThreshold":"edgeFontSizeThreshold"]||0,u="fixed"===a._settings[b?"nodeFontSizeFunction":"edgeFontSizeFunction"],v=e.symbolicSize,w=(a._graph.nodeAttributes.symbolicSize,e.textBoundingBox),x=e.visibleOnScreen,y=e.size,z=a[b?"_nodeGrid":"_edgeGrid"],A=a._nodeGrid,B=a._render,C=e.textComponent,D=e.textBackgroundComponent,E=e.textIndicatorComponent,F=e.depth,G=a._settings.preventOverlap?a._settings.overlapNbBuckets:1;if(a._settings.preventOverlap&&a[b?"_nodeTextDrawingEnabled":"_edgeTextDrawingEnabled"]&&a._settings[b?"nodes":"edges"]){var H=[];for(U=0;U<g;++U){Z=U;var I=v[Z];f[Z]&&w[Z]&&x[Z]&&(I===-1||I*l>=t)&&H.push(Z)}var J=H.length;if(0!==J){var K=new Array(2*G);for(U=0;U<K.length;++U)K[U]=[];var L=1/0,M=-(1/0);for(U=0;U<J;++U){Z=H[U];var N=y[Z];N<L&&(L=N),N>M&&(M=N)}var O=M-L;for(U=0;U<J;++U){Z=H[U],N=y[Z];var P=v[Z],Q=(O-(N-L))/O*G-1e-5|0;P!==-1&&(Q+=G),K[Q].push(Z)}for(var R=0;R<K.length;++R)for(var S=K[R],T=S.length,U=0;U<T;++U){var V,W,X,Y,Z=S[U],$=w[Z],_=!0;if(b){var aa=$[0],ba=$[1],ca=$[2],da=(aa.x-m)*l,ea=(aa.y-o)*l,fa=r*da+s*ea+aa.zx*l+aa.ox,ga=-s*da+r*ea+aa.zy*l+aa.oy;u||(ba*=l,ca*=l),V=Math.max(fa/h|0,0),W=Math.min((fa+ba)/h|0,i),X=Math.max(ga/h|0,0),Y=Math.min((ga+ca)/h|0,j);for(var ha=V;ha<=W;++ha)for(var ia=X;ia<=Y;++ia){var ja=z[ha*k+ia];if(ja!==-1){_=!1,ha=W+1;break}}}else{aa=$[0];var ka=$[1],la=ka.textWidth,ma=ka.textHeight,na=0,oa=0,pa=ka.size*l;if(u||(la*=l,ma*=l),ka.length===-1||ka.length*l>la){na=p-ka.angle;var qa=-1;na<-q?(na+=n,na<-q&&(na+=n)):na>q?(na-=n,na>q&&(na-=n)):qa=1,ka.length!==-1&&(qa=-1),oa=qa*((ma+pa)/2+ka.strokeSize)}da=(aa.x-m)*l,ea=(aa.y-o)*l;var ra=r*da+s*ea,sa=-s*da+r*ea,ta=Math.cos(na),ua=Math.sin(na),va=-(la/2),wa=-(ma/2)+oa,xa=la/2,ya=ma/2+oa,za=ra+ta*va+ua*wa,Aa=sa-ua*va+ta*wa,Ba=ra+ta*xa+ua*ya,Ca=sa-ua*xa+ta*ya;if(za>Ba){var Da=za;za=Ba,Ba=Da}for(Aa>Ca&&(Da=Aa,Aa=Ca,Ca=Da),V=Math.max(za/h|0,0),W=Math.min(Ba/h|0,i),X=Math.max(Aa/h|0,0),Y=Math.min(Ca/h|0,j),ha=V;ha<=W;++ha)for(ia=X;ia<=Y;++ia){var Ea=A[ha*k+ia],Fa=z[ha*k+ia];if(Ea!==-1&&v[Z]!==-1||Fa!==-1){_=!1,ha=W+1;break}}}if(!(V>W||X>Y))if(_){for(ha=V;ha<=W;++ha)for(ia=X;ia<=Y;++ia)z[ha*k+ia]=Z;B.setDepth(C[Z],c(b,F[Z])),B.setDepth(D[Z],c(b,F[Z])),b&&B.setDepth(E[Z],c(b,F[Z]))}else B.hide(C[Z]),B.hide(D[Z]),b&&B.hide(E[Z])}}}}function f(a){a._settings=a._ogma.settings.get("texts"),a._drawing.editLayer("floor",{nodeFontStyle:a._settings.nodeFontStyle,edgeFontStyle:a._settings.edgeFontStyle,nodeFontColor:a._settings.nodeFontColor,edgeFontColor:a._settings.edgeFontColor,nodeTextBackgroundColor:a._settings.nodeBackgroundColor,edgeTextBackgroundColor:a._settings.edgeBackgroundColor}),a._drawing.changeSubLayerThreshold("nodeTextBackground",a._settings.nodeSizeThreshold),a._drawing.changeSubLayerThreshold("nodeText",a._settings.nodeSizeThreshold),a._drawing.changeSubLayerThreshold("edgeTextBackground",a._settings.edgeSizeThreshold),a._drawing.changeSubLayerThreshold("edgeText",a._settings.edgeSizeThreshold),a._drawing.redrawEverything()}function g(b,c,d){for(var e=b._graph.attributes(c),f=e.textBoundingBox,g=d.length,h=0;h<g;++h)f[d[h].__index]=a;b._updateGrid()}function h(a,b,c){var d=a._graph.nodeAttributes,e=a._graph._elts.nodes,f=d.exists,g=e.totalSize,h=a._camera.zoom,i=a._camera.x-a._render.screen.width/2/h,j=a._camera.y-a._render.screen.height/2/h,k=a._settings.nodeBackgroundMargin,l=Math.cos(a._camera.angle),m=Math.sin(a._camera.angle),n=a._settings.nodeSizeThreshold,o="fixed"===a._settings.nodeFontSizeFunction,p=d.symbolicSize,q=d.textBoundingBox,r=d.hidden,s=-1;if(!a._nodeTextDrawingEnabled||!a._settings.nodes)return null;if(a._settings.preventOverlap){var t=b/a._cellSize|0,u=c/a._cellSize|0,v=a._nodeGrid[t*a._gridH+u];if(v===-1)return null;s=v}for(var w=0;w<g;++w){var x=w;if(!(s>-1&&x!==s)&&f[x]){var y=q[x],z=p[x];if(!(!y||r[x]||z!==-1&&z*h<n)){var A=y[0],B=y[1],C=y[2],D=(A.x-i)*h,E=(A.y-j)*h,F=l*D+m*E+A.zx*h+A.ox,G=-m*D+l*E+A.zy*h+A.oy;if(o||(B*=h,C*=h),b>=F-k&&b<=F+B+k&&c>=G-k&&c<=G+C+k)return d.ref[x]}}}return null}function i(a,b,c){var d=a._graph.edgeAttributes,e=d.exists,f=a._graph._elts.edges,g=a._graph.nodeAttributes,h=f.totalSize,i=a._camera.zoom,j=a._camera.x-a._render.screen.width/2/i,k=a._camera.y-a._render.screen.height/2/i,l=a._settings.edgeBackgroundMargin,m=a._camera.angle,o=Math.cos(a._camera.angle),p=Math.sin(a._camera.angle),r=a._settings.edgeSizeThreshold,s="fixed"===a._settings.edgeFontSizeFunction,t=d.symbolicSize,u=d.textBoundingBox,v=d.hidden,w=g.hidden,x=d.source,y=d.target,z=-1;if(!a._edgeTextDrawingEnabled||!a._settings.edges)return null;if(a._settings.preventOverlap){var A=b/a._cellSize|0,B=c/a._cellSize|0,C=a._edgeGrid[A*a._gridH+B];if(C===-1)return null;z=C}for(var D=0;D<h;++D){var E=D;if(!(z>-1&&E!==z)&&e[E]){var F=x[E],G=y[E],H=u[E],I=t[E];if(!(!H||v[E]||w[F]||w[G]||I!==-1&&I*i<r)){var J=H[0],K=H[1],L=K.textWidth,M=K.textHeight;s||(L*=i,M*=i);var N=0,O=0,P=K.size*i;if(K.length===-1||K.length*i>=L){O=m-K.angle;var Q=-1;O<-q?(O+=n,O<-q&&(O+=n)):O>q?(O-=n,O>q&&(O-=n)):Q=1,K.length!==-1&&(Q=-1),N=Q*((M+P)/2+K.strokeSize)}var R=(J.x-j)*i,S=(J.y-k)*i,T=o*R+p*S+J.zx*i+J.ox,U=-p*R+o*S+J.zy*i+J.oy,V=Math.cos(-O),W=Math.sin(-O),X=b-T,Y=c-U,Z=V*X+W*Y+T,$=-W*X+V*Y+U-N;if(Z>=T-L/2-l&&Z<=T+L/2+l&&$>=U-M/2-l&&$<=U+M/2+l)return d[E]}}}return null}function j(b,c,d){if(0!==c.length&&(!d||b._settings.nodes)&&(d||b._settings.edges)&&b._settings.enabled){b._updateGrid();for(var e=(Ogma.utils.pixelRatio(),b._settings),f=b._settings.preventOverlap,g=e.nodeTextAlignment,h=e[d?"nodeBackgroundMargin":"edgeBackgroundMargin"],i=e[d?"nodeMaxTextLength":"edgeMaxTextLength"],j=e[d?"nodeMaxTextLineLength":"edgeMaxTextLineLength"],l=b._shapesSettings.edgeStrokeWidth,m=e[d?"nodeFontSize":"edgeFontSize"],p=e.fontFamily,q="fixed"===e[d?"nodeFontSizeFunction":"edgeFontSizeFunction"],B=e[d?"nodeFontSizeRatio":"edgeFontSizeRatio"],C=b._graph.nodeAttributes,D=b._graph.edgeAttributes,E=d?C:D,F=d?h+e.nodeTextOffset+b._shapesSettings.nodeInnerStrokeWidth:h+e.edgeTextOffset+b._shapesSettings.edgeStrokeWidth,G=d?"nodeText":"edgeText",H=d?"nodeTextBackground":"edgeTextBackground",I=d?"left":"center",J=d?"top":"middle",K=d?"nodeFontColor":"edgeFontColor",L=d?"nodeFontStyle":"edgeFontStyle",M=d?"nodeTextBackgroundColor":"edgeTextBackgroundColor",N=e.backgroundArrowBase,O=b._drawing,P=b._renderer,Q=E.text,R=E.textBackgroundComponent,S=E.textComponent,T=E.textIndicatorComponent,U=E.textBoundingBox,V=C.x,W=C.y,X=C.size,Y=(D.size,0);Y<c.length;++Y){var Z=c[Y],$=Z.__index,_=Q[$],aa=E.depth[$];if(_){i!==a&&_.length>i&&(_=_.substr(0,i)+"…");var ba,ca=E.size[$],da=E.symbolicSize[$],ea=q?m:B*ca,fa=new Ogma.utils.Position,ga=O.getElementProperty(Z,M),ha=O.getElementProperty(Z,K),ia=O.getElementProperty(Z,L),ja=k(_,j),ka=ja?ja.length:1,la=ka*ea,ma=null;if(f&&da>0&&(aa=a),"inherit"===ga&&(ga=E.color[$]),"inherit"===ha&&(ha=E.color[$]),1===ka)ba=P.textWidth(_,p,ea,ia);else{ba=P.textWidth(ja[0],p,ea,ia);for(var na=0;na<ja.length;++na){var oa=P.textWidth(ja[na],p,ea,ia);oa>ba&&(ba=oa)}}if(d){var pa=g;"center"===pa&&(E["icon.content"][$]||E["image.url"][$])&&(pa="bottom"),fa.x=C.x[$],fa.y=C.y[$],fa.zx=r[pa]*ca,fa.zy=s[pa]*ca,fa.ox=r[pa]*(F+1),fa.oy=s[pa]*(F+1),q?(fa.ox+=t[pa]*ba,fa.oy+=u[pa]*la):(fa.zx+=t[pa]*ba,fa.zy+=u[pa]*la),U[$]=[fa,ba,la]}else{var qa,ra=D.source[$],sa=D.target[$],ta=D.curvature[$],ua=V[ra],va=W[ra],wa=V[sa],xa=W[sa],ya=X[ra],za=X[sa];ra===sa?(qa=n/4,Ogma.shapes.utils.getLoopControlPoints(ua,va,ta,ya,x),Ogma.geometry.getPointOnBezierCurve(.5,ua,va,wa,xa,x.x1,x.y1,x.x2,x.y2,fa)):0===ta?(qa=Ogma.geometry.lineAngle(ua,va,wa,xa),fa.x=(ua+wa+Math.cos(qa)*ya+Math.cos(qa+n)*za)/2,fa.y=(va+xa+Math.sin(qa)*ya+Math.sin(qa+n)*za)/2):(qa=Ogma.geometry.lineAngle(ua,va,wa,xa),Ogma.shapes.utils.getCurveControlPoint(ua,va,wa,xa,ta,x),Ogma.geometry.getPointOnQuadraticCurve(.5,ua,va,wa,xa,x.x,x.y,fa),fa.x+=(Math.cos(qa)*ya+Math.cos(qa+n)*za)/2,fa.y+=(Math.sin(qa)*ya+Math.sin(qa+n)*za)/2),fa.oy=-F;var Aa=ra===sa?-1e5:Ogma.geometry.distance(ua,va,wa,xa)-ya-za;ma={angle:qa,length:Aa,size:ca,strokeSize:l,textWidth:ba,textHeight:la,ratio:q?-1:B},U[$]=[fa,ma]}if(ga){if(w.reset(),q?w.setOXY(ba/2+h,la/2+h):(w.setZXY(ba/2,la/2),w.setOXY(h,h)),d)if(N&&"center"!==pa){var Ba=r[pa],Ca=s[pa];fa.ox+=Ba*N*o,fa.oy+=Ca*N*o,y.setXY(C.x[$],C.y[$]).setZXY(Ba*ca,Ca*ca).setOXY(Ba*F,Ca*F),z.set(y),A.set(y);var Da=q?h+ea/2:h+N/2;z.addOXY(Ba*N*o+Ca*Da,Ca*N*o+Ba*Da),A.addOXY(Ba*N*o-Ca*Da,Ca*N*o-Ba*Da),T[$]=P.triangle(T[$],y,z,A,ga,H,aa,da)}else T[$]=P.delete(T[$]);v.set(fa),d&&(q?(v.ox+=ba/2,v.oy+=la/2):(v.zx+=ba/2,v.zy+=la/2)),R[$]=P.rectangle(R[$],v,w,ga,H,aa,da,ma)}else R[$]=P.delete(R[$]),d&&(T[$]=P.delete(T[$]));var Ea,Fa;if(q?(Ea=ea,Fa=0):(Ea=0,Fa=ea),ja&&1!==ja.length){var Ga=P.updateComposite(S[$],ja.length);for(d||(q?fa.oy-=la/2-Ea/2:fa.zy-=la/2-Fa/2),na=0;na<ja.length;++na)Ga[na]=P.text(Ga[na],fa,ja[na],p,Fa,Ea,ha,ia,I,J,G,aa,da,ma),fa.oy+=Ea,fa.zy+=Fa;fa.oy-=Ea*ja.length,fa.zy-=Fa*ja.length,S[$]=P.composite(S[$],Ga)}else S[$]=P.text(S[$],fa,_,p,Fa,Ea,ha,ia,I,J,G,aa,da,ma)}else R[$]=P.delete(R[$]),S[$]=P.delete(S[$]),d&&(T[$]=P.delete(T[$])),U[$]=a}}}function k(a,b){for(var c=a.split("\n"),d=[],e=0;e<c.length;++e){var f=c[e];if(b<=1||f.length<b)d.push(f);else for(var g=l(c[e],b),h=0;h<g.length;++h)d.push(g[h])}return d}function l(a,b){for(var c=a.split(" "),d=[],e=0,f=-1,g=[],h=!0,i=0;i<c.length;++i)if(h){if(c[i].length>b){for(var j=m(c[i],b),k=0;k<j.length;++k)d.push([j[k]]),++f;e=j[j.length-1].length}else d.push([c[i]]),++f,e=c[i].length+1;h=!1}else e+c[i].length<=b?(d[f].push(c[i]),e+=c[i].length+1):(h=!0,--i);for(i=0;i<d.length;++i)g.push(d[i].join(" "));return g}function m(a,b){for(var c=[],d=0;d<a.length;d+=b-1)c.push(a.substr(d,b-1)+"-");var e=c[c.length-1].length;return c[c.length-1]=c[c.length-1].substr(0,e-1)+" ",c}var Ogma=$global.Ogma,n=Math.PI,o=2/3,p={nodes:{default:!0,type:"boolean"},nodeFontColor:{default:"black",type:"color",values:["inherit"]},nodeFontStyle:{default:"none",values:["none","italic","bold"]},nodeFontSizeFunction:{default:"fixed",values:["fixed","ratio"]},nodeFontSize:{default:12,type:"positive"},nodeFontSizeRatio:{default:.2,type:"positive"},nodeBackgroundColor:{default:"rgba(255,255,255,0.66)",type:"color",values:[null,"inherit"]},nodeTextAlignment:{default:"bottom",values:["right","left","top","bottom","center"]},nodeSizeThreshold:{default:12,type:"positive"},nodeMaxTextLength:{default:a,type:"positive",values:[a]},nodeBackgroundMargin:{default:1,type:"positive"},nodeTextOffset:{default:0,type:"positive"},nodeMaxTextLineLength:{default:15,type:"positive"},backgroundArrowBase:{default:10,type:"positive",values:[a]},edges:{default:!0,type:"boolean"},edgeFontColor:{default:"black",type:"color",values:["inherit"]},edgeFontStyle:{default:"none",values:["none","italic","bold"]},edgeFontSizeFunction:{default:"fixed",values:["fixed","ratio"]},edgeFontSize:{default:12,type:"positive"},edgeFontSizeRatio:{default:1,type:"positive"},edgeBackgroundColor:{default:"rgba(255,255,255,0.33)",type:"color",values:[null,"inherit"]},edgeSizeThreshold:{default:6,type:"positive"},edgeMaxTextLength:{default:a,type:"positive",values:[a]},edgeTextOffset:{default:4,type:"positive"},edgeBackgroundMargin:{default:2,type:"positive"},edgeMaxTextLineLength:{default:0,type:"positive"},fontFamily:{default:"Arial",type:"string"},preventOverlap:{default:!0,type:"boolean"},overlapNbBuckets:{default:7,type:"positive"},enabled:{default:!0,type:"boolean"}};b.dependencies=["graph","render","camera","drawing","shapes","pieCharts","partitions","batch","visibility"],b.settings=p,b.prototype.updateGrid=function(){this._updateGrid()},b.prototype.setNodeTextDrawing=function(a){this._renderer.setSubLayerEnabled("nodeText",a),this._renderer.setSubLayerEnabled("nodeTextBackground",a),this._nodeTextDrawingEnabled=a},b.prototype.setEdgeTextDrawing=function(a){this._renderer.setSubLayerEnabled("edgeText",a),this._renderer.setSubLayerEnabled("edgeTextBackground",a),this._edgeTextDrawingEnabled=a},b.prototype.setTextDrawing=function(a){this.setNodeTextDrawing(a),this.setEdgeTextDrawing(a)},b.prototype.isNodeTextDrawingEnabled=function(){return this._nodeTextDrawingEnabled},b.prototype.isEdgeTextDrawingEnabled=function(){return this._edgeTextDrawingEnabled},b.prototype.detectNodeText=function(a,b){return h(this,a,b)},b.prototype.detectEdgeText=function(a,b){return i(this,a,b)};var q=Math.PI/2,r={left:-1,right:1,top:0,bottom:0,center:0},s={left:0,right:0,top:-1,bottom:1,center:0},t={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},u={left:-.5,right:-.5,top:-1,bottom:0,center:-.5},v=new Ogma.utils.Position,w=new Ogma.utils.Position,x={},y=new Ogma.utils.Position,z=new Ogma.utils.Position,A=new Ogma.utils.Position;Ogma.modules.texts=b}.call(),function(a){function b(a){this._selection=a.selection,this._keyboard=a.keyboard,this._mouse=a.mouse,this._graph=a.graph,this._camera=a.camera,this._renderer=a.render,this._settings=a.settings.get("lasso"),this._ready=!1,this._active=!1,this._points=[],this._lines=[],this._index=0,this._addToSelection=!1;var b=this;a.exclusives.create({priority:$C("interaction","lasso"),evt:["captor.startDrag","captor.drag","captor.endDrag"],check:function(){return b._ready},onStart:function(a,d){return c(b,a,d,!1)},onProgress:function(a,d){return c(b,a,d,!0)},onStop:function(){var a=b._keyboard.isPressed(b._settings.addKey),c=!a&&b._keyboard.isPressed(b._settings.removeKey);a||c?b._selection.clear("edges"):b._selection.clear();for(var d=b._graph.nodes,e=b._graph.nodeAttributes.x,f=b._graph.nodeAttributes.y,g=[],h=0,i=d.length;h<i;++h){var j=d[h],k=j.__index,l=b._camera.getPositionOnScreen(e[k],f[k]);Ogma.geometry.isPointInPolygon(l.x,l.y,b._points)&&g.push(j)}for(c?b._selection.dropNodes(g):b._selection.addNodes(g),h=0;h<b._lines.length;++h)b._renderer.delete(b._lines[h]);b._lines=[],b._points=[]}})}function c(a,b,c,d){var e={x:b,y:c};if(d){var f=a._points[a._points.length-1];a._lines.push(a._renderer.line(-1,e,f,a._settings.strokeWidth,0,a._settings.strokeColor))}a._points.push(e)}var Ogma=$global.Ogma,d={strokeColor:{default:"black",type:"color"},strokeWidth:{default:1,type:"positive"},cursorStyle:{default:"cell",type:"string"},addKey:{default:"ctrl",type:"string",values:[null]},removeKey:{default:"alt",type:"string",values:[null]}};b.settings=d,b.dependencies=["selection","captor","graph","camera","render","exclusives"],b.prototype.start=function(){this._ready&&this.stop(),this._ready=!0,this._renderer.setCursorStyle(this._settings.cursorStyle)},b.prototype.stop=function(){this._ready&&(this._ready=!1,this._renderer.removeCursorStyle(this._settings.cursorStyle))},b.prototype.isActive=function(){return this._ready},Ogma.modules.lasso=b}.call(),function(a){function b(a){var b=this;this._render=a.render,this._settings=a.settings.get("mouse",!0),this._events=a.events.create("mouse.",["down","up","move","wheel","click","doubleClick","leave"]),this._domElt=this._render.getCanvas(),this._focus=!1,this._wheelEnabled=!0,this._enabled=!0,this._preventRightClick=null,this._binds=[],this._x=0,this._y=0,this._left=!1,this._middle=!1,this._right=!1,Ogma.utils.setReadOnly(this,{x:function(){return b._x},y:function(){return b._y},left:function(){return b._left},middle:function(){return b._middle},right:function(){return b._right}}),this._domElt&&d(this)}function c(a){document.removeEventListener("contextmenu",a._preventRightClick),a._preventRightClick=null,a._binds.forEach(function(a){return Ogma.utils.unbind(a)}),a._binds=[]}function d(a){function b(b){a._settings.wheelEnabled&&a._wheelEnabled&&(!a._settings.disableWheelUntilMouseDown||a._focus)&&(b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,p(b))}var c=a._events,d={left:0,middle:0,right:0},e=null,g=0,h=0,i=0,j=0,k={left:!1,middle:!1,right:!1},l=null;a._preventRightClick=function(b){a._focus&&b.preventDefault()},document.addEventListener("contextmenu",a._preventRightClick,!1);var m=function(a){e=null,a?d[a]=0:(d.left=0,d.middle=0,d.right=0)},n=function(b){i=g,j=h;var c=a._domElt.getBoundingClientRect();g=b.clientX-c.left,h=b.clientY-c.top,l=f[b.button],a._x=g,a._y=h,a._left=k.left,a._right=k.right,a._middle=k.middle},o=function(b,c,d){a._binds.push(Ogma.utils.bind(a._domElt,b,function(b){a._settings.enabled&&a._enabled&&c(b)},$or(d,a._settings.eventRate)))},p=Ogma.utils.throttle(function(a){var b=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));n(a),c.wheel(b)},a._settings.wheelDebounceTime);o("mousewheel",b,0),o("DOMMouseScroll",b,0),o("mousemove",function(a){n(a);var b=g-i,d=h-j;0===b&&0===d||(m("left"),m("right"),m("middle"),c.move(g,h,b,d))},0),o("mouseleave",function(){k.left&&(c.up("left"),k.left=!1),k.middle&&(c.up("middle"),k.middle=!1),k.right&&(c.up("right"),k.right=!1),m("left"),m("right"),m("middle"),a._focus=!1,c.leave()}),o("mousedown",function(b){n(b),a._focus=!0,k[l]=!0,d[l]+=1,setTimeout(m,a._settings.doubleClickTimer,l),c.down(g,h,l)}),o("mouseup",function(a){n(a),k[l]=!1,1===d[l]?c.click(g,h,l):d[l]>1&&(c.doubleClick(g,h,l),m(l)),c.up(g,h,l)})}var Ogma=$global.Ogma,e={enabled:{default:!0,type:"boolean"},wheelEnabled:{default:!0,type:"boolean"},eventRate:{default:15,type:"positive"},wheelDebounceTime:{default:60,type:"positive"},doubleClickTimer:{default:500,type:"positive"},disableWheelUntilMouseDown:{default:!1,type:"boolean"}};b.settings=e,b.dependencies=["render"];var f={0:"left",1:"middle",2:"right"};b.onKill=function(a){a._domElt&&c(a)},Ogma.modules.mouse=b}.call(),function(a){function b(a){this._ogma=a}function c(b,c,d,e){var f=b(c,d,e);return f===a&&(f=c),f}function d(a){if(!a||0===a.length)return"";for(var b=["var Ogma = {};"],c=0,d=a.length;c<d;c++){for(var e=a[c],f=e.split("."),g="",h=Ogma,i=f.length-1,j=1;j<i;j++)g+="."+f[j],h=h[f[j]],b.push("Ogma"+g+" = Ogma"+g+" || {};\n");if(h=h[f[i]],"function"!=typeof h)throw new Error('Asynchronous task: dependency "'+e+'" is not found');g+="."+f[i],b.push("Ogma"+g+" = "+h.toString()+";")}return b.join("\n")}function e(a,b,c){this._ogma=b,this._mainContext=c,this.configure(a)}function f(a,b,c){var f=this;e.call(this,a,b,c);var g=[d(a.dependencies),"","var __CONTEXT = ("+this._createContext.toString()+")(),","    __UPDATE_FUNC = "+this._update.toString()+",","    __IS_RUNNING_FUNC = "+this._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result = __UPDATE_FUNC(evt.data, __CONTEXT),","      isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");this._worker=Ogma.utils.createWorker(g),this._sync=function(a){f.sync(a)},this._worker.addEventListener("message",this._sync)}function g(a,b,c){e.call(this,a,b,c),this._stopped=!1,this._context=this._createContext()}var Ogma=$global.Ogma,h=function(){return{}},i=function(a){return a},j=function(){return a},k=function(){return!1},l=function(){},m=function(){},n=function(){};b.prototype.run=function(a,b,d){var e={},h=this._ogma,j=$or(d,!0),k=a.configure||i,l=c(k,b,h,e),m=new(j?f:g)(a,h,e);return m.onStart(),m.send(l)},e.prototype=Object.create(Ogma.utils.EventTarget.prototype),e.prototype.configure=function(a){this._onStart=a.onStart||m,this._onEnd=a.onEnd||n,this._update=a.update||j,this._onUpdate=a.onUpdate||l,this._createContext=a.context||h,this._isRunning=a.isRunning||k},e.prototype.onStart=function(){return this.fire("start",{target:this}),this._onStart.call(this),this},f.prototype=Object.create(e.prototype),f.prototype.sync=function(a){var b=a.data.isRunning,c=a.data.result,d=this._onUpdate.call(this,c,this._mainContext,this._ogma,b);this.fire("update",{target:this,isRunning:b}),b?this.send(d):this.stop(c)},f.prototype.stop=function(a){return this._onEnd.call(this,a,this._mainContext,this._ogma),this._worker.terminate(),this.fire("stop",{target:this})},f.prototype.send=function(a){return this._worker.postMessage(a),this},g.prototype=Object.create(e.prototype),g.prototype.sync=function(a){var b=this._update(a,this._context),c=this._isRunning(this._context,a);a=this._onUpdate.call(this,b,this._mainContext,this._ogma,c),this.fire("update",{target:this,isRunning:c}),c?this.send(a):this.stop(b)},g.prototype.send=function(a){var b=this;return this._stopped||setTimeout(function(){return b.sync(a)},0),this},g.prototype.stop=function(a){return this._onEnd(a,this._mainContext,this._ogma),this._stopped=!0,this},b.AsynchronousTask=f,b.SynchronousTask=g,Ogma.modules.tasks=b}.call(),function(a){function b(){this._events={}}function c(a,b,c,d){var e={};d=d||[];for(var f=0;f<c.length;++f){var g=b+c[f];e[c[f]]=a.create(g,!1)}for(f=0;f<d.length;++f)g=b+d[f],e[d[f]]=a.create(g,!0);return e}var Ogma=$global.Ogma;b.onKill=function(b){$iter(b._events,function(a){a.binds.splice(0,a.binds.length)}),b._events=a},b.prototype.bind=function(a,b){var c=this,d="undefined"==typeof a?"undefined":_typeof(a);if(("object"!==d||null===d)&&"string"!==d)throw new TypeError("first argument must be a string or object");if("object"===("undefined"==typeof a?"undefined":_typeof(a))){var e=this;Ogma.utils.forEach(a,function(a,b){e.bind(b,a)})}else{if("function"!=typeof b)throw new TypeError("second argument must be a function");if(a.indexOf(" ")!==-1){var f=a.split(" ").filter(function(a){return!!a});f.forEach(function(a){return c.bind(a,b)})}else{if(!this._events[a])throw new Error('event "'+a+'" does not exist');var g=this._events[a];g.reverse?g.binds.unshift(b):g.binds.push(b)}}},b.prototype.unbind=function(a,b){if(this._events){if(!this._events[a])throw new Error('event "'+a+'" does not exist');var c=this._events[a].binds.indexOf(b);return c!==-1&&(this._events[a].binds.splice(c,1),!0)}},b.prototype.create=function(a,b){if(b instanceof Array)return c(this,arguments[0],arguments[1],arguments[2]);if("string"!=typeof a)throw new TypeError(a+" is not a string");if(this._events[a])throw new Error("event "+a+" already exists");var d=[],e=!!b;return this._events[a]={binds:d,reverse:e},function(a,b,c,e,f,g){for(var h=0,i=d.length;h<i;++h)d[h](a,b,c,e,f,g)}},b.prototype.once=function(a,b){this.triggerAfter(a,b,1)},b.prototype.triggerAfter=function(a,b,c){var d=0,e=this,f=function f(g,h,i){++d===c&&(b(g,h,i),e.unbind(a,f))};this.bind(a,f)},Ogma.modules.events=b,Ogma.prototype.on=function(a,b){return this.events.bind(a,b)},Ogma.prototype.off=function(a,b){return this.events.unbind(a,b)}}.call(),function(a){function b(b){this._graph=b.graph,this._partitions=b.partitions,this._graph.addCommonAttributes({"filter.hidden":Int8Array}),this._nodeFilter=null,this._edgeFilter=null,b.dsl.registerOperator("filter.apply",function(b){return b===a?a:!b})}function c(b,c,d,e){"function"==typeof d?f(b,c,function(b){var c=d(b);return c===a?a:!c},e):f(b,c,[d,"filter.apply"],e)}function d(a,b,c,d){f(a,b,c,d)}function e(a,b){var c=b?"_nodeFilter":"_edgeFilter";a[c]&&(a[c].kill(),a[c]=null)}function f(a,b,c,d){e(a,b);var f=a._graph.attributes(b);a[b?"_nodeFilter":"_edgeFilter"]=a._partitions[b?"nodes":"edges"](c,{onAdd:function(a){f["filter.hidden"][a.__index]=a.hidden},onRemove:function(a){a.hidden=!!f["filter.hidden"][a.__index]},onPartitionChange:function(a,b){"undefined"!==b&&(a.hidden="true"===b)}},$or(d,!0))}var Ogma=$global.Ogma;b.dependencies=["graph","partitions","events"],b.onClear=function(a){a.reset()},b.prototype.showNodes=function(a,b){c(this,!0,a,b)},b.prototype.hideNodes=function(a,b){d(this,!0,a,b)},b.prototype.showEdges=function(a,b){c(this,!1,a,b)},b.prototype.hideEdges=function(a,b){d(this,!1,a,b)},b.prototype.removeNodeFilter=function(){e(this,!0)},b.prototype.removeEdgeFilter=function(){e(this,!1)},b.prototype.reset=function(){e(this,!0),e(this,!1)},Ogma.modules.filter=b}.call(),function(a){function b(a){this._ogma=a,this._graph=a.graph,this._drawing=a.drawing,this._renderer=a.render,this._settings=a.settings.get("images"),this._nodeAttributes=this._graph.nodeAttributes,this._enabled=!0,this._drawing.addNodeSubLayer("nodeImages",{level:$C("subLayer","nodeImages"),useClipSpace:!0}),this._drawing.addNodeVisualProperty("image.url",{type:"string"}),this._drawing.addNodeVisualProperty("image.scale",{
type:"number"}),this._drawing.addNodeVisualProperty("image.rescale",{values:[!0,!1]}),this._drawing.addNodeVisualProperty("image.duplicate",{values:[!0,!1]}),this._drawing.addNodeVisualComponent("imageComponent"),c(this);var b=this;a.events.bind({"drawing.nodes":function(a){return d(b,a)},"settings.images":function(){return c(b)}})}function c(a){a._settings=a._ogma.settings.get("images"),a._drawing.changeSubLayerThreshold("nodeImages",a._settings.threshold),a._drawing.redrawEverything()}function d(b,c){for(var d=b._nodeAttributes,g=b._renderer,h=d["image.url"],i=d["image.scale"],j=d["image.rescale"],k=d["image.duplicate"],l=0;l<c.length;++l){var m=c[l].__index,n=h[m];if(b._enabled&&n){var o=i[m]||b._settings.defaultScale,p=j[m],q=k[m],r=d.size[m]*o;p===a&&(p=b._settings.defaultRescale),q===a&&(q=b._settings.defaultDuplicate),e.x=d.x[m],e.y=d.y[m],f.zx=r,f.zy=r,d.imageComponent[m]=g.image(d.imageComponent[m],e,f,n,p,q,"nodeImages",d.depth[m],d.size[m])}else d.imageComponent[m]=g.delete(d.imageComponent[m])}}var Ogma=$global.Ogma;b.dependencies=["graph","drawing","render","settings","shapes"],b.settings={defaultScale:{default:1,type:"positive"},defaultRescale:{default:!0,type:"boolean"},defaultDuplicate:{default:!1,type:"boolean"},threshold:{default:10,type:"positive"}},b.prototype.setImagesEnabled=function(a){this._enabled=a};var e=new Ogma.utils.Position,f=new Ogma.utils.Position;Ogma.modules.images=b}.call(),function(a){function b(a){this._drawing=a.drawing,this._graph=a.graph,this._renderer=a.render,this._settings=a.settings.get("badges",!0),this._shapeSettings=a.settings.get("shapes",!0),this._drawing.addNodeSubLayer("nodeBadge",{level:$C("subLayer","nodeBadge"),defineClipSpace:!0}),this._drawing.addNodeSubLayer("nodeBadgeStroke",{level:$C("subLayer","nodeBadgeStroke")}),this._drawing.addNodeSubLayer("nodeBadgeImage",{level:$C("subLayer","nodeBadgeImage"),useClipSpace:!0}),this._drawing.addNodeSubLayer("nodeBadgeText",{level:$C("subLayer","nodeBadgeText")}),c(this),this._drawing.addNodeVisualProperty("badges",{properties:{bottomRight:f,bottomLeft:f,topRight:f,topLeft:f}}),this._drawing.addNodeVisualComponent("badgeComponent");var b=this;a.events.bind({"drawing.nodes":function(a){return d(b,a)},"settings.badges":function(){c(b),b._drawing.redrawEverything()}})}function c(a){a._drawing.changeSubLayerThreshold("nodeBadge",a._settings.threshold),a._drawing.changeSubLayerThreshold("nodeBadgeStroke",a._settings.hideStrokeOnHiddenContent?a._settings.textThreshold:a._settings.threshold),a._drawing.changeSubLayerThreshold("nodeBadgeImage",a._settings.threshold),a._drawing.changeSubLayerThreshold("nodeBadgeText",a._settings.threshold)}function d(a,b){if(a._settings.drawBadges)for(var c=a._graph.nodeAttributes,d=c.badgeComponent,e=c.badges,f=a._renderer,i=c.size,j=c.x,k=c.y,l=c.depth,m=c.color,n=c.colors,o=a._shapeSettings.defaultNodeColor,p=a._settings.scale,q=a._settings.positionScale/Math.SQRT2,r=a._settings.defaultColor,s=a._settings.defaultFont,t=a._settings.strokeWidth,u=a._settings.defaultStrokeColor,v=a._settings.fontScale,w=a._settings.defaultTextColor,x=a._settings.fontStyle,y=a._settings.hideStrokeOnHiddenContent,z=0;z<b.length;++z){var A=b[z].__index,B=e[A],C=d[A];if(B){for(var D=i[A],E=D*p,F=E*v,G=D*q,H=l[A],I=j[A],J=k[A],K=n[A],L=K&&K[0]||m[A]||o,M=Object.keys(B),N=f.updateComposite(C,M.length),O=0;O<M.length;++O){var P=f.updateComposite(N[O],4),Q=M[O],R=B[Q],S=R.content,T=R.image,U=R.font||s,V=R.color||r,W=R.strokeColor||u,X=R.textColor||w;"inherit"===V&&(V=L),"inherit"===W&&(W=L),"inherit"===X&&(X=L),"number"==typeof S&&(S=S.toString()),g.setXY(I,J),"topLeft"===Q?g.addXY(-G,-G):"topRight"===Q?g.addXY(G,-G):"bottomLeft"===Q?g.addXY(-G,G):"bottomRight"===Q&&g.addXY(G,G),V&&(P[0]=f.circle(P[0],g,E,0,V,"nodeBadge",H,D),W&&(P[1]=f.circle(P[1],g,E,t,W,"nodeBadgeStroke",H,y?E:D))),T?(h.zx=E,h.zy=E,P[2]=f.image(P[2],g,h,T,!0,!1,"nodeBadgeImage",H,D)):P[2]=f.delete(P[2]),S?P[3]=f.text(P[3],g,S,U,F,0,X,x,"center","middle","nodeBadgeText",H,E):P[3]=f.delete(P[3]),N[O]=f.composite(N[O],P)}d[A]=f.composite(C,N)}else d[A]=f.delete(C)}}var Ogma=$global.Ogma,e={scale:{default:.45,type:"positive"},positionScale:{default:.9,type:"positive"},defaultColor:{default:"white",type:"color",values:[a,"inherit"]},defaultTextColor:{default:"black",type:"color"},defaultStrokeColor:{default:"black",type:"color",values:[a,"inherit"]},strokeWidth:{default:2,type:"positive"},defaultFont:{default:"Arial",type:"string"},fontStyle:{default:"none",values:["none","italic","bold"]},fontScale:{default:1,type:"positive"},textThreshold:{default:6,type:"positive"},threshold:{default:1,type:"positive"},hideStrokeOnHiddenContent:{default:!1,type:"boolean"},drawBadges:{default:!0,type:"boolean"}},f={properties:{color:{type:"string"},strokeColor:{type:"string"},textColor:{type:"string"},content:{type:"stringOrNumber"},font:{type:"string"},image:{type:"string"}}};b.settings=e,b.dependencies=["drawing","graph","render","pieCharts","texts","images"];var g=new Ogma.utils.Position,h=new Ogma.utils.Position;Ogma.modules.badges=b}.call(),function(a){function b(a){var b=this;this._graph=a.graph,this._dsl=a.dsl,this._partitions=a.partitions,this._drawing=a.drawing,this._watcher=a.watcher,this._settingsModule=a.settings,this._settings=a.settings.get("design"),this._events=a.events.create("design.",["nodeStyleChange","edgeStyleChange"]),this._nodeVisualVars=[],this._edgeVisualVars=[];for(var c=Object.keys($global.design),d=0;d<c.length;++d){var e=c[d],f=$global.design[e];f.nodeAttributes&&(this._nodeVisualVars.push(e),f.nodeAttributes.forEach(function(a){return b._graph.addAttribute(!0,a)})),f.edgeAttributes&&(this._edgeVisualVars.push(e),f.edgeAttributes.forEach(function(a){return b._graph.addAttribute(!1,a)}))}this._styles={nodes:{},edges:{}},this._styleFunctions={nodes:{byList:[],byName:{}},edges:{byList:[],byName:{}}},this._nodeReserveColors=null,this._nodeColorScheme=null,this._edgeReserveColors=null,this._edgeColorScheme=null,a.events.bind({"graph.addNodes":function(a){return j(b,!0,a)},"graph.addEdges":function(a){return j(b,!1,a)},"graph.nodeDataChange":function(a){return j(b,!0,a)},"graph.edgeDataChange":function(a){return j(b,!1,a)}})}function c(a,b,c){d(a,c,b);var e=a._styles[b?"nodes":"edges"][c];return e?Ogma.utils.deepCopy(e):null}function d(a,b,c){if(c&&a._nodeVisualVars.indexOf(b)===-1)throw new Error("invalid node visual variable "+JSON.stringify(b)+": valid values are "+JSON.stringify(a._nodeVisualVars));if(!c&&a._edgeVisualVars.indexOf(b)===-1)throw new Error("invalid edge visual variable "+JSON.stringify(b)+": valid values are "+JSON.stringify(a._edgeVisualVars))}function e(b){return b===a||"string"==typeof b&&0!==Ogma.colors.getIndex(b)}function f(a,b,c){var d=b?"_nodeReserveColors":"_edgeReserveColors";if(null!==c){if(!(c instanceof Array)||0===c.length)throw new TypeError("invalid reserve colors "+JSON.stringify(c)+": expected non-empty array of colors");for(var f=0;f<c.length;++f)if(!e(c[f]))throw new TypeError("invalid reserve color: "+JSON.stringify(c[f])+" is not a color");a[d]=Ogma.utils.deepCopy(c)}}function g(a,b){return Ogma.utils.deepCopy(b?a._nodeColorScheme:a._edgeColorScheme)}function h(a){return"object"===("undefined"==typeof a?"undefined":_typeof(a))&&null!==a}function i(a,b,c,e){d(a,c,b),l(a,b,c,e),k(a,b,c,!0);var f=a._graph[b?"nodes":"edges"],g=$global.design[c],h="function"==typeof e?g.styleByFunction(a,b,e):g.styleByParameters(a,b,e,i);a._styles[b?"nodes":"edges"][c]=e,g.save(a,b,f),h(f),a._styleFunctions[b?"nodes":"edges"].byName[c]=h,a._styleFunctions[b?"nodes":"edges"].byList.push(h),a._drawing.redraw(f),a._events[b?"nodeStyleChange":"edgeStyleChange"](c)}function j(a,b,c){var d=a._styleFunctions[b?"nodes":"edges"].byList;d.forEach(function(a){return a(c)}),a._drawing.redraw(c)}function k(b,c,e,f){if(d(b,e,c),b._styles[c?"nodes":"edges"][e]){var g=b._graph[c?"nodes":"edges"],h=$global.design[e],i=b._styleFunctions[c?"nodes":"edges"];h.restore(b,c,g);var j=i.byName[e];i.byName[e]=a,$rm(i.byList,j),b._styles[c?"nodes":"edges"][e]=a,b._drawing.redrawEverything(),f||b._events[c?"nodeStyleChange":"edgeStyleChange"](e)}}function l(a,b,c,d){var e=$global.design[c];if("function"!=typeof d){if(!e.checkParameters)throw new TypeError(c+": invalid parameters "+JSON.stringify(d)+": must be a function");if(!h(d))throw new TypeError(c+": invalid parameters "+JSON.stringify(d)+": must be an object or a function.");m(c,d),e.checkParameters(d,a,b)}}function m(a,b){if("string"!=typeof b.variable)throw new TypeError(a+': property "variable" must be a string.')}var Ogma=$global.Ogma;$global.design={},$global.selectFromScheme=function(b,c){if(c instanceof Array){for(var d=a,e=0;e<c.length;++e){var f=b[c[e]];if(f){d=f;break}}return d}return b[c]},b.settings={defaultSizeBins:{default:7,type:"positive"}},b.dependencies=["graph","dsl","partitions","watcher","icons","images","pieCharts","shapes","texts"],b.onClear=function(a){a.reset()},b.prototype.setStyles=function(a){if(!h(a))throw new Error("setStyles: "+JSON.stringify(a)+" is not an object.");a.nodes&&Ogma.utils.forEach(a.nodes,function(a,b){this.setNodeStyle(b,a)},this),a.edges&&Ogma.utils.forEach(a.edges,function(a,b){this.setEdgeStyle(b,a)},this)},b.prototype.getStyles=function(){return Ogma.utils.deepCopy(this._styles)},b.prototype.reset=function(){for(var a=0;a<this._nodeVisualVars.length;++a)k(this,!0,this._nodeVisualVars[a]);for(a=0;a<this._edgeVisualVars.length;++a)k(this,!1,this._edgeVisualVars[a])},b.prototype.setNodeColor=function(a){i(this,!0,"color",a)},b.prototype.setEdgeColor=function(a){i(this,!1,"color",a)},b.prototype.setNodeShape=function(a){i(this,!0,"shape",a)},b.prototype.setEdgeShape=function(a){i(this,!1,"shape",a)},b.prototype.setNodeIcon=function(a){i(this,!0,"icon",a)},b.prototype.setNodeImage=function(a){i(this,!0,"image",a)},b.prototype.setNodeSize=function(a){i(this,!0,"size",a)},b.prototype.setEdgeSize=function(a){i(this,!1,"size",a)},b.prototype.setNodeText=function(a){i(this,!0,"text",a)},b.prototype.setEdgeText=function(a){i(this,!1,"text",a)},b.prototype.resetNodeColor=function(){k(this,!0,"color")},b.prototype.resetEdgeColor=function(){k(this,!1,"color")},b.prototype.resetNodeShape=function(){k(this,!0,"shape")},b.prototype.resetEdgeShape=function(){k(this,!1,"shape")},b.prototype.resetNodeIcon=function(){k(this,!0,"icon")},b.prototype.resetNodeImage=function(){k(this,!0,"image")},b.prototype.resetNodeSize=function(){k(this,!0,"size")},b.prototype.resetEdgeSize=function(){k(this,!1,"size")},b.prototype.resetNodeText=function(){k(this,!0,"text")},b.prototype.resetEdgeText=function(){k(this,!1,"text")},b.prototype.getNodeColor=function(){return c(this,!0,"color")},b.prototype.getEdgeColor=function(){return c(this,!1,"color")},b.prototype.getNodeShape=function(){return c(this,!0,"shape")},b.prototype.getEdgeShape=function(){return c(this,!1,"shape")},b.prototype.getNodeIcon=function(){return c(this,!0,"icon")},b.prototype.getNodeImage=function(){return c(this,!0,"image")},b.prototype.getNodeSize=function(){return c(this,!0,"size")},b.prototype.getEdgeSize=function(){return c(this,!1,"size")},b.prototype.getNodeText=function(){return c(this,!0,"text")},b.prototype.getEdgeText=function(){return c(this,!1,"text")},b.prototype.setNodeStyle=function(a,b){i(this,!0,a,b)},b.prototype.setEdgeStyle=function(a,b){i(this,!1,a,b)},b.prototype.getStyle=function(a,b){return c(this,a,b)},b.prototype.removeNodeStyle=function(a){k(this,!0,a)},b.prototype.removeEdgeStyle=function(a){k(this,!1,a)},b.prototype.getNodeStyle=function(a){return c(this,!0,a)},b.prototype.getEdgeStyle=function(a){return c(this,!1,a)},b.prototype.setNodeReserveColors=function(a){f(this,!0,a)},b.prototype.setEdgeReserveColors=function(a){f(this,!1,a)},b.prototype.getNodeColorMapping=function(){return g(this,!0)},b.prototype.getEdgeColorMapping=function(){return g(this,!1)},Ogma.modules.design=b}.call(),function(){function a(a,b){return b=b?Ogma.utils.deepCopy(b):{},b.easing=$or(b.easing,a._settings.defaultEasing),b.duration=$or(b.duration,0),b}function b(a,b){if(a.callback){var c=a.callback;a.callback=function(){b(),c()}}else a.callback=b}var Ogma=$global.Ogma,c={maxZoom:{default:1e3,type:"positive"},minZoom:{default:.01,type:"positive"},defaultZoomModifier:{default:1.8,type:"positive"},defaultEasing:{default:"linear",type:"string"}},d=function(){function c(a){var b=this;_classCallCheck(this,c),this._renderer=a.render,this._animations=a.animations,this._settings=a.settings.get("camera",!0),this._events=a.events.create("camera.",["move","zoom","rotate","startMove","startRotate","startZoom","endMove","endRotate","endZoom"]),this._screen=this._renderer.screen,this._zoomAnimation=null,this._moveAnimation=null,this._zoom=1,this._x=0,this._y=0,this._angle=0,Ogma.utils.setReadOnly(this,{width:function(){return b._screen.width},height:function(){return b._screen.height},x:function(){return b._x},y:function(){return b._y},zoom:function(){return b._zoom},angle:function(){return b._angle}});var d=this;a.events.bind({"render.setContainer":function(){d._zoom=1,d._x=0,d._y=0,d._angle=0,d._events.move()},"render.resize":function(a){a&&d.move(a.width/2,a.height/2)},"settings.camera":function(a){$has(a,"minZoom")&&d._zoom<d._settings.minZoom?(d._zoom=d._settings.minZoom,d._events.move()):$has(a,"maxZoom")&&d._zoom>d._settings.maxZoom&&(d._zoom=d._settings.maxZoom,d._events.move())}})}return _createClass(c,[{key:"setCenter",value:function(b,c,d){if("number"!=typeof b)throw new Error("camera.setCenter: invalid coordinate "+b);if("number"!=typeof c)throw new Error("camera.setCenter: invalid coordinate "+c);d=a(this,d);var e=this._x,f=this._y,g=b-this._x,h=c-this._y,i=!d.noEndOfAnimation,j=function(a){this._x=e+g*a,this._y=f+h*a,this._events.move(1===a&&i)}.bind(this);return this._animations.end(this._moveAnimation),this._moveAnimation=this._animations.play(j,d),this}},{key:"move",value:function(a,b,c){if("number"!=typeof a)throw new Error("camera.move: invalid argument "+JSON.stringify(a));if("number"!=typeof b)throw new Error("camera.move: invalid argument "+JSON.stringify(b));var d=$opt(c&&c.screenCoordinates,"bool",!0);if(d){a/=this._zoom,b/=this._zoom;var e=Math.cos(this._angle),f=Math.sin(this._angle),g=e*a-f*b,h=f*a+e*b;a=g,b=h}return this.setCenter(this._x+a,this._y+b,c)}},{key:"setZoom",value:function(c,d){var e=this;if("number"!=typeof c||c<=0||!isFinite(c))throw new Error("camera.setZoom: invalid zoom value "+JSON.stringify(c));d=a(this,d),c<this._settings.minZoom?c=this._settings.minZoom:c>this._settings.maxZoom&&(c=this._settings.maxZoom);var f=this,g=this._screen.width/2,h=this._screen.height/2,i=this._zoom,j=g/i-g/c,k=d.refX,l=d.refY,m=!d.noEndOfAnimation,n=d.duration;b(d,function(){return e._events.endZoom(i,c,n)});var o=function(a){var b=j*a;f._zoom=g/(g/i-b),f._events.zoom(1===a&&m),f._events.move(1===a&&m)};if(void 0!==k&&void 0!==l){var p=d.callback;d.callback=void 0,d.screenCoordinates=!1;var q=(k-g)/i-(k-g)/c,r=(l-h)/i-(l-h)/c;this.move(q,r,d),d.callback=p,d.screenCoordinates=void 0}return this._animations.end(this._zoomAnimation),this._events.startZoom(i,c,n),this._zoomAnimation=this._animations.play(o,d),this}},{key:"zoomIn",value:function(a){return this.setZoom(this._zoom*(a&&a.zoomModifier||this._settings.defaultZoomModifier),a)}},{key:"zoomOut",value:function(a){return this.setZoom(this._zoom*(1/(a&&a.zoomModifier||this._settings.defaultZoomModifier)),a)}},{key:"setAngle",value:function(b,c){if("number"!=typeof b)throw new Error("camera.setAngle: invalid angle "+JSON.stringify(b));c=a(this,c);var d=this._angle,e=b-d,f=!c.noEndOfAnimation,g=function(a){this._angle=d+e*a,this._angle>Math.PI&&(this._angle-=2*Math.PI),this._angle<-Math.PI&&(this._angle+=2*Math.PI),this._events.rotate(1===a&&f),this._events.move(1===a&&f)}.bind(this);return this._animations.end(this._rotateAnimation),this._rotateAnimation=this._animations.play(g,c),this}},{key:"rotate",value:function(a,b){if("number"!=typeof a)throw new Error("camera.rotate: invalid angle "+JSON.stringify(a));return this.setAngle(this._angle+a,b)}},{key:"animationInProgress",value:function(){var a=this._moveAnimation,b=this._zoomAnimation;return a&&!a.done||b&&!b.done}},{key:"getAbsolutePosition",value:function(a,b){var c=this._x+(a-this._screen.width/2)/this._zoom,d=this._y+(b-this._screen.height/2)/this._zoom;return Ogma.geometry.rotate(c,d,this._x,this._y,this._angle)}},{key:"getPositionOnScreen",value:function(a,b){var c=this._screen.width/2,d=this._screen.height/2,e=(a-this._x)*this._zoom+c,f=(b-this._y)*this._zoom+d,g={};return 0!==this._angle?Ogma.geometry.rotate(e,f,c,d,this._angle*-1,g):(g.x=e,g.y=f),g}},{key:"getSizeOnScreen",value:function(a){return a*this._zoom}},{key:"saveConfig",value:function(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle}}},{key:"loadConfig",value:function(a){$isDef(a.x)&&(this._x=a.x),$isDef(a.y)&&(this._y=a.y),$isDef(a.zoom)&&(this._zoom=a.zoom),$isDef(a.angle)&&(this._angle=a.angle),this._events.move(!0)}}]),c}();d.settings=c,d.dependencies=["render","animations"],d.onClear=function(a){a._zoom=1,a._x=0,a._y=0,a._angle=0},Ogma.modules.camera=d}(),function(a){function b(a){this._graph=a.graph,this._renderer=a.render,this._design=a.design,this._batch=a.batch,this._watcher=a.watcher,this._settingModule=a.settings,this._settings=a.settings.get("legend",!0),this._renderer.addSubLayer("legendBorders",{level:$C("subLayer","legendBorders")}),this._renderer.addSubLayer("legendBackground",{level:$C("subLayer","legendBackground")}),this._renderer.addSubLayer("legendContent",{level:$C("subLayer","legendContent")}),this._iconSettings=this._settingModule.get("icons"),this._widgets=[],this._position="bottom",this._active=!1,this._visible=!0,this._titleFunction=null;var b=this,e=function(){d(b)};a.events.bind({"design.nodeStyleChange design.edgeStyleChange":e,"graph.addNodes graph.addEdges":e,"graph.nodeDataChange graph.edgeDataChange":e,"render.resize":e,"graph.clear":e,"render.export":e,"settings.legend":e}),c(this,"nodes","color"),c(this,"nodes","size"),c(this,"nodes","shape"),c(this,"nodes","icon"),c(this,"nodes","image"),c(this,"edges","color"),c(this,"edges","shape"),c(this,"edges","size")}function c(a,b,c){a._widgets.push(new k(a,b,c))}function d(a){var b=a._renderer,c=a._design,d=a._settings,f=b.screen;if(a._widgets.forEach(function(a){return a.clear()}),a._styles=null,d.enabled){a._styles=c.getStyles();var g=a._widgets.filter(function(a){return a.reload()}),i=!1;i="top"===a._position||"bottom"===a._position?h(f,d,g.slice(),"bottom"===a._position):e(f,d,g.slice(),"left"===a._position),i&&g.forEach(function(a){return a.draw()})}}function e(a,b,c,d){var e,f=b.widgetWidth+b.outerMargin,g=Math.floor((a.width-b.outerMargin)/f),h=a.height,i=b.outerMargin,j=1;e=d?b.outerMargin:a.width-f;for(var k=0;k<c.length;++k){var l=c[k];if(i+l.height>h){if(i===b.outerMargin)return!1;i=b.outerMargin,j+=1,d?e+=f:e-=f}l.setPosition(e,i),i+=l.height}return j<=g}function f(a,b){return a.height-b.height}function g(a,b){return a.type!==b.type?"nodes"===a.type?a:b:a.height>b.height?-1:1}function h(a,b,c,d){var e=b.widgetWidth+b.outerMargin,h=Math.floor((a.width-b.outerMargin)/e),k=a.height-b.outerMargin,l=new Array(Math.min(h,c.length)),m=c.length,n=0,o=0,p=0,q=0;for(w=0;w<m;++w)C=c[w],"nodes"===C.type?(n+=1,o+=C.height):(p+=1,q+=C.height);var r=o+q,s=o/r,t=q/r,u=Math.round(s*h),v=Math.round(t*h);if(u>n?u=n:v>p&&(u=h-p),0===h)return!1;for(var w=0;w<l.length;++w)l[w]={content:[],height:0,type:w<u?"nodes":"edges"};for(w=0;w<m;++w){var x=i(c);j(c[x],l),c.splice(x,1)}l.sort(g);var y=b.outerMargin;for(w=0;w<l.length;++w){var z=l[w];if(z.height>k)return!1;z.content.sort(f);for(var A=0,B=0;B<z.content.length;++B){var C=z.content[B];C.setPosition(y,d?a.height-A-C.height:A+b.outerMargin),A+=C.height}y+=e}return!0}function i(a){for(var b=0,c=1;c<a.length;++c)a[c].height>a[b].height&&(b=c);return b}function j(a,b){for(var c=null,d=0;d<b.length;++d){var e=b[d];e.type!==a.type&&1!==b.length||!(null===c||e.height<b[c].height)||(c=d)}e=b[c],e.content.push(a),e.height+=a.height}function k(a,b,c){this.type=b,this.visualVar=c,this._settings=a._settings,this.legend=a,this.renderer=a._renderer,this.iconSettings=a._iconSettings,this.watcher=a._watcher,this.components=-1,this.disabled=!1}function l(a){return a}function m(a,b){return parseFloat(b)-parseFloat(a)}function n(a){return a.innerMargin+(a.titleFontSize+a.fontSize)*A}function o(a,b){return b?a.fontSize:a.fontSize*B}function p(a,b,c,d,e,f,g,h,i){var j=h.getPropertyBoundaries(f,g),k=j.min%2===0||j.max%2===0,l=z(j.min,k),m=z(j.max,k),n=z((j.min+j.max)/2,k);if(f){var o=.7*c.fontSize,p=3*o,q=(o+p)/2;b.push(Ogma.utils.circleStroke(a,-1,d+c.innerMargin+p,e+2*p-o,o,c.circleStrokeWidth,c.shapeColor,"legendContent")),b.push(Ogma.utils.circleStroke(a,-1,d+c.innerMargin+p,e+2*p-q,q,c.circleStrokeWidth,c.shapeColor,"legendContent")),b.push(Ogma.utils.circleStroke(a,-1,d+c.innerMargin+p,e+p,p,c.circleStrokeWidth,c.shapeColor,"legendContent")),b.push(a.text(-1,{x:d+c.innerMargin+2*p+c.fontSize,y:e+2*p-o},l,c.fontFamily,c.fontSize,0,c.fontColor,"none","left","middle","legendContent")),b.push(a.text(-1,{x:d+c.innerMargin+2*p+c.fontSize,y:e+2*p-1.5*q},n,c.fontFamily,c.fontSize,0,c.fontColor,"none","left","middle","legendContent")),b.push(a.text(-1,{x:d+c.innerMargin+2*p+c.fontSize,y:e+o},m,c.fontFamily,c.fontSize,0,c.fontColor,"none","left","middle","legendContent"))}else{var r=(c.widgetWidth-2*c.innerMargin)/3,s=c.fontSize;b.push(a.line(-1,{x:d+c.innerMargin,y:e+s/2},{x:d+c.innerMargin+r,y:e+s/2},s,0,c.shapeColor,"legendContent")),b.push(a.line(-1,{x:d+c.innerMargin+r,y:e+s/2},{x:d+c.innerMargin+2*r,y:e+s/2},s/1.5,0,c.shapeColor,"legendContent")),b.push(a.line(-1,{x:d+c.innerMargin+2*r,y:e+s/2},{x:d+c.innerMargin+3*r,y:e+s/2},s/3,0,c.shapeColor,"legendContent")),b.push(a.text(-1,{x:d+c.innerMargin+.5*r,y:e+2.5*s},m,c.fontFamily,c.fontSize,0,c.fontColor,"none","center","middle","legendContent")),b.push(a.text(-1,{x:d+c.innerMargin+1.5*r,y:e+2.5*s},n,c.fontFamily,c.fontSize,0,c.fontColor,"none","center","middle","legendContent")),b.push(a.text(-1,{x:d+c.innerMargin+2.5*r,y:e+2.5*s},l,c.fontFamily,c.fontSize,0,c.fontColor,"none","center","middle","legendContent"))}}function q(a,b,c,d,e,f,g){var h=o(c,!0);b.push(a.text(-1,{x:d+c.innerMargin+h/2,y:e},f.content,f.font||g.defaultFont,0,c.fontSize*A,c.fontColor,"none","center","middle","legendContent"))}function r(a,b,c,d,e,f){var g=o(c,!0),h=c.fontSize/2*A*C;b.push(a.image(-1,{x:d+c.innerMargin+g/2,y:e},{x:h,y:h},f.url,!0,!1,"legendContent"))}function s(a,b,c,d,e,f,g){var h=Ogma.shapes[g?"nodes":"edges"][f],i=o(c,g);g?b.push(h.draw(a,-1,d+c.innerMargin+i/2,e,c.fontSize/2*A*C,0,c.shapeColor,"legendContent")):b.push(h.drawStraight(a,-1,d+c.innerMargin,e,d+c.innerMargin+c.fontSize*B,e,c.fontSize/3,0,c.fontSize/4,c.fontSize/4,c.shapeColor,"legendContent"))}function t(a,b,c,d,e,f,g){var h=o(c,g),i={x:d+c.innerMargin+h/2,y:e};g?b.push(a.circle(-1,i,0,c.fontSize/2*A*C,f,"legendContent")):b.push(a.rectangle(-1,i,{x:c.fontSize*B/2,y:c.fontSize/2},f,"legendContent"))}function u(a,b,c,d,e,f,g,h){var i=o(c,f);h&&(g=z(g)),b.push(a.text(-1,{x:d+i+1.6*c.innerMargin,y:e},g,c.fontFamily,0,c.fontSize,c.fontColor,"none","left","middle","legendContent"))}function v(a,b,c,d,e,f){b.push(Ogma.utils.roundedRect(a,-1,d,e,c.widgetWidth,f-c.outerMargin,c.borderRadius,c.backgroundColor,"legendBackground"));var g=0===c.borderRadius?0:c.borderRadius+c.borderWidth;b.push(Ogma.utils.roundedRect(a,-1,d-c.borderWidth,e-c.borderWidth,c.widgetWidth+2*c.borderWidth,f-c.outerMargin+2*c.borderWidth,g,c.borderColor,"legendBorders"))}function w(a,b,c,d,e,f){var g="center"===c.titleTextAlign,h={x:d+(g?c.widgetWidth/2:c.innerMargin),y:e+c.titleFontSize/2+c.innerMargin},i=a.textWidth(f,c.fontFamily,c.titleFontSize,"none"),j=c.widgetWidth;if(i>j){var k=j/i,l=(f.length*k|0)-2;f=f.substr(0,l)+"…"}b.push(a.text(-1,h,f,c.fontFamily,0,c.titleFontSize,c.titleFontColor,"none",c.titleTextAlign,"middle","legendContent"))}function x(a){a.existingValues=null;var b=a._settings,c=a.type,d=a.visualVar,e=b.outerMargin+n(b),f=e,g=b.fontSize*A;if("size"===d)f+="nodes"===c?3*g:2*g;else if(a.params.scheme instanceof Array)f+=Object.keys(a.scheme).length*g;else{var h=[],i=Object.keys(a.scheme);i.forEach(function(b){y(a.legend,"nodes"===c,a.params.variable,b)&&h.push(b)}),f+=h.length*g,a.existingValues=h}return f===e?(a.height=0,!1):(a.height=f,!0)}function y(a,b,c,d){for(var e=a._graph[b?"nodes":"edges"],f=e.length,g=0;g<f;++g){var h=e[g],i=Ogma.utils.strToObjectRef(h,c);if(i==d)return!0;if(Array.isArray(i)&&i.indexOf(d)!==-1)return!0}return!1}function z(a,b){var c=["K","M","G","T","P","E","Z","Y"];if(a>9999){for(var d=0;d<c.length&&a>999;)a/=1e3,++d;return Math.ceil(a)+c[d-1]}return b?Math.round(a).toString():a<10?(Math.round(1e3*a)/1e3).toString():a<100?(Math.round(100*a)/100).toString():a<1e3?(Math.round(10*a)/10).toString():Math.round(a).toString()}var Ogma=$global.Ogma,A=1.5,B=3,C=.8;b.settings={enabled:{default:!1,type:"boolean"},widgetWidth:{default:130,type:"positive"},fontFamily:{default:"Arial",type:"string"},fontSize:{default:10,type:"positive"},fontColor:{default:"black",type:"color"},titleFontSize:{default:12,type:"positive"},titleFontColor:{default:"black",type:"color"},titleMaxLength:{default:20,type:"positive"},titleTextAlign:{default:"left",values:["left","center"]},shapeColor:{default:"grey",type:"color"},backgroundColor:{default:"white",type:"color"},borderColor:{default:"black",type:"color"},borderRadius:{default:0,type:"positive"},borderWidth:{default:1,type:"positive"},innerMargin:{default:10,type:"positive"},outerMargin:{default:5,type:"positive"},circleStrokeWidth:{default:5,type:"positive"}},b.dependencies=["render","design","batch","settings","icons","watcher","exports"];var D=["top","right","left","bottom"];b.prototype.reload=function(){d(this)},b.prototype.setPosition=function(a){if(D.indexOf(a)===-1)throw new Error("invalid position "+JSON.stringify(a)+": expected one of the following values: "+JSON.stringify(D));this._position=a,d(this)},b.prototype.setTitleFunction=function(a){this._titleFunction=a,d(this)},b.prototype.setVisible=function(a){this._visible=!!a,this._renderer.setSubLayersEnabled(["legendBackground","legendBorders","legendContent"],a)},b.prototype.isVisible=function(){return this._visible},k.prototype.reload=function(){var a=this.type,b=this.visualVar,c=this.legend;return this.params=c._design.getStyle("nodes"===a,b),!!$isObj(this.params)&&("color"===b?this.scheme=c._design["nodes"===a?"getNodeColorMapping":"getEdgeColorMapping"]():this.params&&"size"!==b&&(this.scheme=this.params.scheme),this.scheme&&(this.schemeKeys=Object.keys(this.scheme)),x(this))},k.prototype.setPosition=function(a,b){this.x=a,this.y=b},k.prototype.draw=function(){var a=[],b=this._settings,c=this.renderer,d=this.x,e=this.y,f="nodes"===this.type,g=this.visualVar,h=this.legend._titleFunction||function(a){return a.split(".").pop()},i=h(this.params.variable,f?"node":"edge");if("string"!=typeof i)throw new TypeError(i+" is not a valid widget title.");if(v(this.renderer,a,this._settings,this.x,this.y,this.height),w(this.renderer,a,this._settings,this.x,this.y,i),this.scheme){var j=Object.keys(this.scheme),k=n(b),o=this.params.scheme instanceof Array;o&&j.sort(m);for(var x=0;x<j.length;++x){var y=j[x],z=this.scheme[y];this.existingValues&&this.existingValues.indexOf(y)===-1||(u(this.renderer,a,this._settings,this.x,this.y+k,f,y,o),"icon"===this.visualVar?q(c,a,b,d,e+k,z,this.iconSettings):"color"===g?t(c,a,b,d,e+k,z,f):"shape"===g?s(c,a,b,d,e+k,z,f):"image"===g&&r(c,a,b,d,e+k,z),k+=this._settings.fontSize*A)}}else"size"===g&&p(c,a,b,d,e+n(b)-b.fontSize,f,this.params.variable,this.watcher,this.params.transformation||l);this.components=this.renderer.composite(-1,a)},k.prototype.clear=function(){this.components=this.renderer.delete(this.components)},Ogma.modules.legend=b}.call(),function(a){function b(a,b,f,g){"number"==typeof g&&(g={duration:g}),g=g||{};var h,i,j=f?a._graph.getElementList(b,f):a._graph[b?"nodes":"edges"],k=g.padding||{},l=a._camera,m=g.callback,n=g.easing||a._settings.defaultEasing,o=g.duration||0,p=g.finalZoom;if(0===j.length)return e(m,o);var q=a[b?"nodesBoundingBox":"edgesBoundingBox"](j);if(p)h=q.cx,i=q.cy;else{var r=c(a,q,k);h=r.x,i=r.y,p=r.zoom}var s=p/l.zoom;return d(l,h,i,p,o,n,m,s),!0}function c(a,b,c){var d=c.left||a._settings.defaultLeftPadding,e=c.right||a._settings.defaultRightPadding,f=c.top||a._settings.defaultTopPadding,g=c.bottom||a._settings.defaultBottomPadding,h=(a._screen.width-d-e)/(b.maxX-b.minX),i=(a._screen.height-f-g)/(b.maxY-b.minY),j=h<i?h:i;return a._settings.maxNodeSizeOnScreen&&b.maxSize*j>a._settings.maxNodeSizeOnScreen&&(j=a._settings.maxNodeSizeOnScreen/b.maxSize),j>a._cameraSettings.maxZoom?j=a._cameraSettings.maxZoom:j<a._cameraSettings.minZoom&&(j=a._cameraSettings.minZoom),{x:b.cx+(e-d)/(2*j),y:b.cy+(g-f)/(2*j),zoom:j}}function d(a,b,c,d,e,f,g,h){h>1.01?(a.setCenter(b,c,{duration:e,easing:f,callback:g}),a.setZoom(d,{duration:e,easing:f,startAfter:.5})):h<.99?(a.setCenter(b,c,{duration:e,easing:f,callback:g,startAfter:.5}),a.setZoom(d,{duration:e,easing:f})):a.setCenter(b,c,{duration:e,easing:f,callback:g})}function e(a,b){return a&&(b?setTimeout(a,b):a()),!1}var Ogma=$global.Ogma,f=function(){function d(a){_classCallCheck(this,d),this._camera=a.camera,this._graph=a.graph,this._screen=a.render.screen,this._settings=a.settings.get("locate"),this._cameraSettings=a.settings.get("camera");var b=this;a.events.bind({"render.resize":function(a,c){!c&&b._settings.centerOnResize?b.center():c&&b._settings.centerAtInit&&b.center()},"render.setContainer":function(a){a&&b._settings.centerAtInit&&b.center()}})}return _createClass(d,[{key:"center",value:function(b){return this.nodes(a,b)}},{key:"nodes",value:function(a,c){return b(this,!0,a,c)}},{key:"edges",value:function(a,c){return b(this,!1,a,c)}},{key:"computeCameraConfig",value:function(a,b){return c(this,this.nodesBoundingBox(a),b||{})}},{key:"nodesBoundingBox",value:function(a){a||(a=this._graph.nodes);for(var b=1/0,c=1/0,d=-(1/0),e=-(1/0),f=0,g=a.length,h=this._graph.nodeAttributes,i=h.size,j=h.x,k=h.y,l=h.hidden,m=h["groups.parent"],n=0,o=0,p=0,q=0,r=0;r<g;++r){var s=a[r],t=s.__index,u=i[t],v=j[t],w=k[t];l[t]||m[t]||(f=Math.max(f,u),b=Math.min(b,v-u),c=Math.min(c,w-u),d=Math.max(d,v+u),e=Math.max(e,w+u))}return g>0&&(n=b+(d-b)/2,o=c+(e-c)/2,p=d-b,q=e-c),{minX:b,minY:c,maxX:d,maxY:e,cx:n,cy:o,width:p,height:q,maxSize:f}}},{key:"edgesBoundingBox",value:function(a){for(var b=Ogma.geometry.SELF_LOOP_SIZE_MULTIPLIER,c=1/0,d=1/0,e=-(1/0),f=-(1/0),g=0,h=this._graph.nodeAttributes,i=h.hidden,j=h["groups.parent"],k=Math.min,l=Math.max,m=0;m<a.length;++m){var n=a[m],o=n.__source,p=n.__target,q=o.size,r=o.x,s=o.y,t=p.size,u=p.x,v=p.y,w=n.curvature,x=i[o.__index]||j[o.__index],y=i[p.__index]||j[p.__index];if(!x&&!y)if(g=l(g,l(q,t)),o===p){var z=q+w;c=k(c,r-b*z),d=k(d,s-q),e=l(e,r+q),f=l(f,s+b*z)}else c=k(c,r-q,u-t),d=k(d,s-q,v-t),e=l(e,r+q,u+t),f=l(f,s+q,v+t)}return{minX:c,minY:d,maxX:e,maxY:f,cx:c+(e-c)/2,cy:d+(f-d)/2,width:e-c,height:f-d,maxSize:g}}},{key:"graphInCamera",value:function(){var a=this.nodesBoundingBox(),b=this._camera,c=this._screen,d=c.width/b.zoom/2,e=c.height/b.zoom/2,f=b.x-d,g=b.y-e,h=b.x+d,i=b.y+e,j=a.minX,k=a.minY,l=a.maxX,m=a.maxY;return(f<j&&j<h||j<f&&f<l)&&(g<k&&k<i||k<g&&g<m)}}]),d}();f.settings={centerOnResize:{default:!1,type:"boolean"},centerAtInit:{default:!0,type:"boolean"},defaultLeftPadding:{default:40,type:"number"},defaultRightPadding:{default:40,type:"number"},defaultTopPadding:{default:40,type:"number"},defaultBottomPadding:{default:40,type:"number"},defaultEasing:{default:"quadraticInOut",type:"string"},maxNodeSizeOnScreen:{default:100,type:"positive",values:[null]}},f.dependencies=["graph","camera","render"],Ogma.modules.locate=f}.call(),function(){function a(a,b,c){for(var d=a._graph.attributes(b),e=d["groups.children"],f=d["groups.parent"],g=0,h=c.length;g<h;++g){
var i=c[g].__index;e[i]=null,f[i]=null}}function b(a,b,d){for(var e=a._graph.attributes(b),f=e["groups.children"],g=e["groups.parent"],h=e.id,i=a._metaElts.fetch(b),j=[],k=new Ogma.utils.Set,l=d.length,m=0;m<l;++m){var n=d[m].__index,o=f[n],p=g[n];if(o){for(var q=0;q<o.length;++q)j.push(h[o[q].__index]);i[h[n]]=void 0}else p&&(g[n]=null,k.add(h[p.__index]))}j.length&&a._graph.removeElements(b,j),c(a,b,k.values())}function c(a,b,c){for(var e=a._graph.attributes(b),f=e["groups.children"],g=e["groups.parent"],h=a._metaElts.fetch(b),i=[],k=[],l=0;l<c.length;++l){var m=c[l],n=h[m];if(n){for(var o=n.elt,p=o.__index,q=n.method,r=f[p],s=[],t=0;t<r.length;++t){var u=r[t];g[u.__index]===o&&s.push(u)}if(f[p]=s,s.length>0){var v=q(s);a._graph.updateElement(b,o,v),k.push(o)}else b&&d(a,b,o)&&j(o,a._graph,a._topology),i.push(o.id)}}a._graph.removeElements(b,i),a._drawing.redraw(k)}function d(a,b,c){return a._metaElts.fetch(b)[c.id]}function e(a,b){var c=[];return $iter(a._metaElts.fetch(b),function(a){a&&a.elt&&c.push(a.elt)}),c}function f(a,b){for(var c=a._graph.attributes(b),d=a._graph._elts.fetch(b).totalSize,e=c.exists,f=c["groups.children"],g=c.ref,h=[],i=0;i<d;++i)e[i]&&!f[i]&&h.push(g[i]);return h}function g(a,b,d,e,f){function g(){for(var c=0;c<u.length;++c){var d=u[c];if(a._drawing.updateVisibility(d),a._selection.drop(b,d),b)for(var e=0;e<d.length;++e){var f=d[e],g=f.parent;f.x=g.x,f.y=g.y}else{for(e=0;e<d.length;++e){var h=d[e].__index,i=q[h];r[h]=1,0!==i&&(i=.1*Math.sign(i),q[h]=i)}a._drawing.redraw(d)}}}function i(){for(var c=0;c<I.length;++c){var d=I[c],e=m[d.__index];n[d.__index]=!1,a._drawing.updateVisibility(e),b&&h(d,e,a._graph,a._topology)}a._drawing.updateVisibility(I),a._drawing.redraw(I),f&&f()}for(var j=a._graph.attributes(b),k=a._metaElts.fetch(b),l=j["groups.parent"],m=j["groups.children"],n=j["groups.building"],o=j["groups.prevX"],p=j["groups.prevY"],q=j.curvature,r=j.manualCurvature,s=j.x,t=j.y,u=[],v=[],w=0;w<d.length;++w){var x=d[w],y=x.method||a[b?"_defNodeMethod":"_defEdgeMethod"],z=a._graph.getElementList(b,x[b?"nodes":"edges"]),A=[];if(!b&&z.length){var B=a._topology.edgeDirection(z[0]);for(D=1;D<z.length;++D){var C=a._topology.edgeDirection(z[D]);if(C!==B)throw new Error("edges "+z[0].id+" and "+z[D].id+" do not have the same source and target")}}for(var D=0;D<z.length;++D){var E=z[D],F=E.__index,G=m[F];G?A.push.apply(A,G):A.push(E)}var H=y(A);H.id=$or(H.id,a._graph.unusedId(b)),b||(H.source=$source(A[0]).id,H.target=$target(A[0]).id),u.push(A),v.push(H),a._graph.getElement(b,H.id)||(k[H.id]=!0)}var I=a._graph.addElements(b,v),J=new Ogma.utils.Set;for(w=0;w<I.length;++w)E=I[w],k[E.id]={elt:E,method:d[w].method||a[b?"_defNodeMethod":"_defEdgeMethod"]};for(w=0;w<u.length;++w){A=u[w];var K=I[w],L=K.__index,M=K.x,N=K.y;for(m[L]=A,n[L]=!0,D=0;D<A.length;++D){E=A[D],F=E.__index;var O=l[F];O?J.add(O.id):b&&(o[F]=s[F]-M,p[F]=t[F]-N),l[F]=K}}return c(a,b,J.values()),a._drawing.updateVisibility(I),void 0===e?(g(),i()):a._drawing.animate(g,e,i),I}function h(a,b,c,d){var e={},f=void 0,g=void 0;for(f=0,g=b.length;f<g;f++)e[b[f].id]=!0;var h=d.getAdjacentEdges(b),i=c.edgeAttributes,j=i.source,k=i.target,l=i.sourceId,m=i.targetId,n=i["groups.prevSource"],o=i["groups.prevTarget"],p=[];for(f=0,g=h.length;f<g;f++){var q=h[f];e[q.source]^e[q.target]&&p.push(q)}for(d.onEdgesRemoved(p,!0),f=0,g=p.length;f<g;f++){var r=p[f],s=r.__index,t=a.__index;e[r.target]?(o[s]=r.__targetIndex,k[s]=t,r.__target=a,r.__targetIndex=t,m[s]=a.id):(n[s]=r.__sourceIndex,j[s]=t,r.__source=a,r.__sourceIndex=t,l[s]=a.id)}d.onEdgesAdded(p,!0)}function i(a,b,d,f,g){function h(){if(b)for(var c=0;c<i.length;++c){var d=i[c],e=d.__index;o[e]=q[e],p[e]=r[e]}else for(var f=0;f<i.length;++f)n[i[f].__index]=0;a._drawing.redraw(i),a._drawing.updateVisibility(i)}void 0===d&&(d=e(a,b));for(var i=k(a,b,a._graph.getElementList(b,d)),l=a._graph.attributes(b),m=l["groups.parent"],n=l.manualCurvature,o=l.x,p=l.y,q=l["groups.prevX"],r=l["groups.prevY"],s=new Ogma.utils.Set,t={},u=0;u<i.length;++u){var v=i[u],w=v.__index,x=m[w];if(x){if(t[x.id]||(b&&j(x,a._graph,a._topology),t[x.id]=!0,s.add(x.id)),b){var y=x.x,z=x.y;q[w]+=y,r[w]+=z,o[w]=y,p[w]=z}m[w]=null}}a._drawing.redraw(i),c(a,b,s.values()),void 0===f?(h(),g&&g()):a._drawing.animate(h,f,g)}function j(a,b,c){var d=c.getAdjacentEdges(a),e=b.edgeAttributes,f=b.nodeAttributes.id,g=e.source,h=e.target,i=e.sourceId,j=e.targetId,k=e["groups.prevSource"],l=e["groups.prevTarget"];c.onEdgesRemoved(d,!0);for(var m=0,n=d.length;m<n;m++){var o=d[m],p=o.__index,q=void 0;o.source===a.id?(q=k[p],g[p]=q,i[p]=f[q],o.__sourceIndex=q,o.__source=b.getNode(f[q])):(q=l[p],h[p]=q,j[p]=f[q],o.__targetIndex=q,o.__target=b.getNode(f[q]))}c.onEdgesAdded(d,!0)}function k(a,b,c){for(var d=a._graph.attributes(b),e=d["groups.children"],f=d["groups.parent"],g=[],h=0;h<c.length;++h){var i=c[h],j=i.__index,k=e[j],l=f[j];k?g.push.apply(g,k):l&&g.push(i)}return g}var Ogma=$global.Ogma,l=function(){function c(d){_classCallCheck(this,c),this._graph=d.graph,this._batch=d.batch,this._topology=d.topology,this._selection=d.selection,this._drawing=d.drawing,this._dsl=d.dsl,this._partitions=d.partitions,this._renderer=d.render,this._graph.addCommonAttributes({"groups.children":Array,"groups.parent":Array,"groups.building":Int8Array}),this._graph.addNodeAttributes({"groups.prevX":Float32Array,"groups.prevY":Float32Array}),this._graph.addEdgeAttributes({"groups.prevSource":Int8Array,"groups.prevTarget":Int8Array}),this._metaElts=$dual();var e=this,f=this._graph.nodeAttributes,g=this._graph.edgeAttributes;this._drawing.addNodeVisibilityCondition(function(a){var b=f["groups.parent"][a.__index],c=f["groups.children"][a.__index];return c?!f["groups.building"][a.__index]:!b||f["groups.building"][b.__index]}),this._drawing.addEdgeVisibilityCondition(function(a){var b=g["groups.parent"][a.__index],c=g["groups.children"][a.__index],d=f["groups.parent"][a.__sourceIndex],e=f["groups.parent"][a.__targetIndex];return c?!g["groups.building"][a.__index]:!(b&&!g["groups.building"][b.__index])&&(!d||!e||d!==e)}),this._graph.addNodeReadOnlyProperty("parent",function(a){return f["groups.parent"][a.__index]},!1),this._graph.addEdgeReadOnlyProperty("parent",function(a){return g["groups.parent"][a.__index]},!1),this._graph.addNodeReadOnlyProperty("children",function(a){return f["groups.children"][a.__index]},!1),this._graph.addEdgeReadOnlyProperty("children",function(a){return g["groups.children"][a.__index]},!1),d.events.bind({"graph.addNodes":function(b){return a(e,!0,b)},"graph.removeNodes":function(a){return b(e,!0,a)},"graph.addEdges":function(b){return a(e,!1,b)},"graph.removeEdges":function(a){return b(e,!1,a)},"drag.progress":function(a){for(var b=0;b<a.length;++b){var c=a[b],d=c.children;d&&d.forEach(function(a){a.x=c.x,a.y=c.y})}}})}return _createClass(c,[{key:"setNodeDefaultMethod",value:function(a){this._defNodeMethod=a}},{key:"setEdgeDefaultMethod",value:function(a){this._defEdgeMethod=a}},{key:"getMetaNodes",value:function(){return e(this,!0)}},{key:"getMetaEdges",value:function(){return e(this,!1)}},{key:"getNonMetaNodes",value:function(){return f(this,!0)}},{key:"getNonMetaEdges",value:function(){return f(this,!1)}},{key:"isMetaNode",value:function(a){return d(this,!0,a)}},{key:"isMetaEdge",value:function(a){return d(this,!1,a)}},{key:"groupMultipleNodes",value:function(a,b,c){return g(this,!0,a,b,c)}},{key:"groupMultipleEdges",value:function(a,b,c){return g(this,!1,a,b,c)}},{key:"groupNodes",value:function(a,b,c,d){return g(this,!0,[{nodes:a,method:b}],c,d)[0]}},{key:"groupEdges",value:function(a,b,c,d){return g(this,!1,[{edges:a,method:b}],c,d)[0]}},{key:"ungroupNodes",value:function(a,b,c){return i(this,!0,a,b,c)}},{key:"ungroupEdges",value:function(a,b,c){return i(this,!1,a,b,c)}},{key:"reset",value:function(a,b){this.ungroupEdges(this.metaEdges(),a,b),this.ungroupNodes(this.metaNodes(),a,b)}}]),c}();l.dependencies=["graph","topology","drawing","dsl","partitions","render","batch","drag","selection"],Ogma.modules.groups=l}(),function(){function a(a){var k=this;this._shapes=a.shapes,this._texts=a.texts,this._mouse=a.mouse,this._touch=a.touch,this._settings=a.settings.get("captor",!0),this._events=a.events.create(["captor."],["move","down","up","click","rightDown","rightUp","rightClick","doubleClick","startDrag","drag","endDrag","startRightDrag","rightDrag","endRightDrag","hoverNode","unhoverNode","clickNode","doubleClickNode","rightClickNode","dragNode","startDragNode","endDragNode","rightDragNode","startRightDragNode","endRightDragNode","hoverEdge","unhoverEdge","clickEdge","doubleClickEdge","rightClickEdge","dragEdge","startDragEdge","endDragEdge","rightDragEdge","startRightDragEdge","endRightDragEdge","clickBackground","doubleClickBackground","rightClickBackground","dragBackground","startDragBackground","endDragBackground","rightDragBackground","startRightDragBackground","endRightDragBackground"]),this._elt=null,this._draggedElt=null,this._enabled=!0,this._leftPressed=!1,this._rightPressed=!1,this._leftDrag=!1,this._rightDrag=!1,this._isNode=!0,this._init=!1,this._hover=!1,this._timeout=null;var l=this._touch,m=this._mouse;a.events.bind({"settings.captor":function(){return j(k,m.x,m.y)},"graph.clear graph.removeNodes graph.removeEdges":function(){j(k,m.x,m.y),k._timeout||(k._timeout=setTimeout(function(){d(k,m.x,m.y,0,0),k._timeout=null},0))},"mouse.move":function(a,b,c,e){return d(k,m.x,m.y,c,e)},"touch.move":function(a,b,c,e){return d(k,l.x,l.y,c,e)},"mouse.down":function(a,d,e){"left"===e?b(k,a,d):"right"===e&&c(k,a,d)},"touch.down":function(a,c){return b(k,a,c)},"mouse.up":function(a,b,c){"left"===c?e(k,m.x,m.y,!0):"right"===c&&f(k,m.x,m.y,!0)},"touch.up":function(){return e(k,l.x,l.y)},"mouse.click touch.tap":function(a,b,c){c&&"left"!==c?"right"===c&&i(k,a,b):g(k,a,b)},"mouse.doubleClick touch.doubleTap":function(a,b,c){c&&"left"!==c||h(k,a,b)}})}function b(a,b,c){var d=k(a,b,c);d!==a._elt&&j(a,b,c),a._elt=d,a._leftPressed=!0,a._events.down(b,c)}function c(a,b,c){var d=k(a,b,c);d!==a._elt&&j(a,b,c),a._elt=d,a._rightPressed=!0,a._events.rightDown(b,c)}function d(a,b,c,d,e){a._events.move(b,c);var f=a._elt&&a._elt.isNode;a._leftPressed&&(a._leftDrag||(a._leftDrag=!0,a._draggedElt=a._elt,a._events.startDrag(b,c,d,e),a._elt?(a._hover&&(a._events[f?"unhoverNode":"unhoverEdge"](a._elt,b,c),a._hover=!1),a._events[f?"startDragNode":"startDragEdge"](a._elt,b,c,d,e)):a._events.startDragBackground(b,c,d,e)),a._events.drag(b,c,d,e),a._draggedElt?a._events[a._draggedElt.isNode?"dragNode":"dragEdge"](a._draggedElt,b,c,d,e):a._events.dragBackground(b,c,d,e)),a._rightPressed&&(a._rightDrag||(a._rightDrag=!0,a._draggedElt=a._elt,a._events.startRightDrag(b,c,d,e),a._elt?(a._hover&&(a._events[f?"unhoverNode":"unhoverEdge"](a._elt,b,c),a._hover=!1),a._events[f?"startRightDragNode":"startRightDragEdge"](a._elt,b,c,d,e)):a._events.startRightDragBackground(b,c,d,e)),a._events.rightDrag(b,c,d,e),a._draggedElt?a._events[a._draggedElt.isNode?"rightDragNode":"rightDragEdge"](a._draggedElt,b,c,d,e):a._events.rightDragBackground(b,c,d,e));var g=k(a,b,c);a._leftPressed||a._rightPressed||g!==a._elt&&(a._elt&&a._hover&&(a._hover=!0,a._events[f?"unhoverNode":"unhoverEdge"](a._elt,b,c)),g&&(a._hover=!0,a._events[g.isNode?"hoverNode":"hoverEdge"](g,b,c))),a._elt=g}function e(a,b,c,d){a._leftPressed&&(a._leftDrag&&(a._events.endDrag(b,c),a._draggedElt?a._events[a._draggedElt.isNode?"endDragNode":"endDragEdge"](a._draggedElt,b,c):a._events.endDragBackground(b,c),a._rightDrag||(a._draggedElt=null)),a._rightPressed||a._hover||!d||(a._elt=k(a,b,c),a._elt&&(a._events[a._elt.isNode?"hoverNode":"hoverEdge"](a._elt,b,c),a._hover=!0)),a._leftPressed=!1,a._leftDrag=!1,a._events.up(b,c))}function f(a,b,c,d){a._rightPressed&&(a._rightDrag&&(a._events.endRightDrag(b,c),a._draggedElt?a._events[a._draggedElt.isNode?"endRightDragNode":"endRightDragEdge"](a._draggedElt,b,c):a._events.endRightDragBackground(b,c),a._leftDrag||(a._draggedElt=null)),a._leftPressed||a._hover||!d||(a._elt=k(a,b,c),a._elt&&(a._events[a._elt.isNode?"hoverNode":"hoverEdge"](a._elt,b,c),a._hover=!0)),a._rightPressed=!1,a._rightDrag=!1,a._events.rightUp(b,c))}function g(a,b,c){a._events.click(b,c),a._elt?a._events[a._elt.isNode?"clickNode":"clickEdge"](a._elt,b,c):a._events.clickBackground(b,c)}function h(a,b,c){a._events.doubleClick(b,c),a._elt?a._events[a._elt.isNode?"doubleClickNode":"doubleClickEdge"](a._elt,b,c):a._events.doubleClickBackground(b,c)}function i(a,b,c){a._events.rightClick(b,c),a._elt?a._events[a._elt.isNode?"rightClickNode":"rightClickEdge"](a._elt,b,c):a._events.rightClickBackground(b,c)}function j(a,b,c){var d=a._draggedElt&&a._draggedElt.isNode;a._leftDrag&&(a._draggedElt?a._events[d?"endDragNode":"endDragEdge"](a._draggedElt,b,c):a._events.endDragBackground(b,c)),a._rightDrag&&(a._draggedElt?a._events[d?"endRightDragNode":"endRightDragEdge"](a._draggedElt,b,c):a._events.endRightDragBackground(b,c)),a._hover&&a._elt&&a._events[a._elt.isNode?"unhoverNode":"unhoverEdge"](a._elt,b,c),a._hover=!1,a._leftPressed=!1,a._rigthPressed=!1,a._leftDrag=!1,a._rightDrag=!1,a._elt=null,a._draggedElt=null}function k(a,b,c){var d=null;return a._settings.nodes&&(d=a._shapes.detectNodeShape(b,c,a._settings.nodeErrorMargin)),!d&&a._settings.nodes&&a._settings.nodeTexts&&(d=a._texts.detectNodeText(b,c)),!d&&a._settings.edges&&(d=a._shapes.detectEdgeShape(b,c,a._settings.edgeErrorMargin)),!d&&a._settings.edges&&a._settings.edgeTexts&&(d=a._texts.detectEdgeText(b,c)),d}var Ogma=$global.Ogma,l={nodes:{default:!0,type:"boolean"},edges:{default:!0,type:"boolean"},nodeTexts:{default:!0,type:"boolean"},edgeTexts:{default:!0,type:"boolean"},nodeErrorMargin:{default:5,type:"positive"},edgeErrorMargin:{default:7,type:"positive"}};a.dependencies=["settings","graph","camera","shapes","texts","mouse","touch"],a.settings=l,a.prototype.pointedElement=function(){return this._elt},a.prototype.draggedElement=function(){return this._draggedElt},Ogma.modules.captor=a}.call(),function(){function a(a,b){a.on({"graph.addNodes":function(a){}})}$global.Ogma,{color:Int16Array,float:Float32Array,size:Float32Array,byte:Int8Array,scale:Float32Array,image:Int16Array,text:Array};a.prototype.getScheme=function(){},a.prototype.addRule=function(a,b){},a.prototype.addProperty=function(){}}(),function(a){function b(b){this._ogma=b,this._graph=b.graph,this._renderer=b.render,this._camera=b.camera,this._drawing=b.drawing,this._topology=b.topology,this._settings=b.settings.get("shapes",!0),this._graph.addEdgeAttributes({curvature:Float32Array,manualCurvature:Int8Array}),this._directedEdges=this._settings.directedEdges,this._nodeAttributes=this._graph.nodeAttributes,this._edgeAttributes=this._graph.edgeAttributes,this._drawing.addEdgeSubLayer("edgeShapes",$C("subLayer","edgeShapes")),this._drawing.addEdgeSubLayer("edgeOuterStrokes",$C("subLayer","edgeOuterStrokes")),this._drawing.addNodeSubLayer("nodeOuterStrokes",$C("subLayer","nodeOuterStrokes")),this._drawing.addNodeSubLayer("nodeInnerStrokes",$C("subLayer","nodeInnerStrokes")),this._drawing.addNodeSubLayer("nodeShapes",{level:$C("subLayer","nodeShapes"),defineClipSpace:!0}),this._drawing.addNodeVisualProperty("shape",{values:Object.keys(Ogma.shapes.nodes).concat([a])}),this._drawing.addEdgeVisualProperty("shape",{values:Object.keys(Ogma.shapes.edges).concat([a])}),this._drawing.addCommonVisualProperty("shapeParameters",{type:"object"}),this._drawing.addCommonVisualProperty("color",{type:"string"});var e=this._edgeAttributes;this._graph.addEdgeReadOnlyProperty("curvature",function(a){return e.curvature[a.__index]}),this._drawing.addCommonVisualComponent("fillComponent"),this._drawing.addCommonVisualComponent("outerStrokeComponent"),this._drawing.addNodeVisualComponent("innerStrokeComponent"),this._curvaturesToUpdate=new Ogma.utils.Set;var f=this;g(f),b.events.bind({"graph.addEdges":function(a){return c(f,a)},"graph.removeEdges":function(a){return c(f,a)},"graph.startInit":function(){f._firstUpdate=!0},"graph.endInit":function(){f._curvaturesToUpdate=f._topology.getAllEdgeDirections()},"drawing.before":function(){d(f)},"drawing.nodes":function(a){return h(f,a)},"drawing.edges":function(a){return i(f,a)},"drawing.edgesVisibilityChange":function(a){if(!f._firstUpdate)for(var b=0;b<a.length;++b)f._curvaturesToUpdate.add(f._topology.edgeBiDirection(a[b]))},"settings.shapes":function(){return g(f)}})}function c(a,b){if(!a._firstUpdate)for(var c=a._curvaturesToUpdate,d=a._topology,e=b.length,f=0;f<e;++f)c.add(d.edgeBiDirection(b[f]))}function d(a){a._curvaturesToUpdate.forEach(function(b){e(a,b)}),a._firstUpdate?(a._curvaturesToUpdate=new Ogma.utils.Set,a._firstUpdate=!1):a._curvaturesToUpdate.clear()}function e(a,b){var c=a._graph.edgeAttributes,d=a._settings.edgesAlwaysCurvy,e=0,g=0,h=a._topology.getEdgesMatchingDirection(b,function(a){return c.visible[a.__index]&&!c.manualCurvature[a.__index]}),i=[];h.sort(function(a,b){return c.insertionOrder[a.__index]-c.insertionOrder[b.__index]});for(var j=h[0],k=0;k<h.length;++k){var l=h[k];l.__source===j.__source?e+=1:g+=1}var m=0,n=0,o=0,p=0;for(k=0;k<h.length;++k){l=h[k];var q=l.__index,r=l.__source===j.__source,s=l.__source===l.__target;a._directedEdges?c.curvature[q]=f(r?o:p,e,g,(r?m:n)+l.size/2,s,!1,!0,d):c.curvature[q]=f(o+p,h.length,0,m+n+l.size/2,s,!r,!1,d),r?(m+=l.size,o+=1):(n+=l.size,p+=1),i.push(l)}a._drawing.redraw(i)}function f(a,b,c,d,e,f,g,h){var i;return i=e?d:g?1!==b||0!==c||h?a+1:0:b%2!==1||h?((a/2|0)+1)*(a%2===0?1:-1)*(f?-1:1):0===a?0:((a+1)/2|0)*(a%2===0?1:-1)*(f?-1:1)}function g(a){a._drawing.changeSubLayerThreshold("nodeInnerStrokes",a._settings.nodeInnerStrokeThreshold),a._drawing.changeSubLayerThreshold("edgeShapes",a._settings.edgeThreshold),a._drawing.redrawEverything()}function h(a,b){for(var c=a._nodeAttributes,d=Ogma.shapes.nodes,e=c.fillComponent,f=c.innerStrokeComponent,g=c.outerStrokeComponent,h=c.size,i=c.x,j=c.y,k=c.color,l=c.shape,m=c.depth,o=c.shapeParameters,p=a._renderer,q=a._settings.defaultNodeShape,r=a._settings.defaultNodeColor,s=a._settings.nodeInnerStrokeWidth,t=a._settings.nodeOuterStrokeWidth,u=a._settings.nodeInnerStrokeColor,v=b.length,w=0;w<v;++w){var x=b[w],y=x.__index,z=d[l[y]||q],A=a._drawing.getElementProperty(x,"nodeOuterStrokeColor"),B="nodeShapes";if(z){var C=o[y]||n,D=k[y]||r;e[y]=z.draw(p,e[y],i[y],j[y],h[y],0,D,B,m[y],h[y],C),f[y]=z.draw(p,f[y],i[y],j[y],h[y],s,u,"nodeInnerStrokes",m[y],h[y],C),"inherit"===A&&(A=D),A?g[y]=z.draw(p,g[y],i[y],j[y],h[y],t+s,A,"nodeOuterStrokes",m[y],h[y],C):g[y]=p.delete(g[y])}}}function i(a,b){var c=a._ogma.badges?a._ogma.settings.get("badges"):{scale:1,positionScale:0},d=a._edgeAttributes,e=a._nodeAttributes,f=d.shape,g=Ogma.shapes.edges,h=e.x,i=e.y,k=e.size,l=e.badges||[],m=e.color,n=d.source,o=d.target,p=d.size,q=d.depth,r=d.curvature,s=d.shapeParameters,t=d.color,u=d.fillComponent,v=d.outerStrokeComponent,w=a._renderer,x=a._settings.edgeStrokeWidth,y=a._settings.defaultEdgeColor,z=a._settings.overrideEdgeColor,A=a._settings.defaultEdgeShape,B=c.scale+c.positionScale-.95,C={x:0,y:0};B<0&&(B=0);for(var D=0;D<b.length;++D){var E,F=b[D],G=F.__index,H=n[G],I=o[G],J=a._drawing.getElementProperty(F,"edgeOuterStrokeColor");E="source"===z?m[H]:"target"===z?m[I]:t[G]||y;var K=g[f[G]||A],L=h[H],M=i[H],N=k[H],O=h[I],P=i[I],Q=k[I],R=l[I],S=r[G];if(R){var T,U,V;if(0===S?(T=L-O,U=M-P):H!==I&&(Ogma.shapes.utils.getCurveControlPoint(L,M,O,P,S,C),T=C.x-O,U=C.y-P),V=T>0?R[U>0?"bottomRight":"topRight"]:R[U>0?"bottomLeft":"topLeft"]){var W=Math.sqrt(T*T+U*U),X=Math.abs(T/W)+Math.abs(U/W),Y=(X-1)/(Math.SQRT2-1);Q*=1+Y*B}}K&&(u[G]=j(w,u[G],K,H,I,L,M,O,P,p[G],0,S,N,Q,E,"edgeShapes",q[G],p[G],s[G]),"inherit"===J&&(J=E),J?v[G]=j(w,v[G],K,H,I,L,M,O,P,p[G],x,S,N,Q,J,"edgeOuterStrokes",q[G],p[G],s[G]):v[G]=w.delete(v[G]))}}function j(a,b,c,d,e,f,g,h,i,j,k,l,m,n,p,q,r,s,t){return t=t||o,b=d===e?c.drawLoop(a,b,f,g,j,k,l,m,p,q,r,s,t):0===l?c.drawStraight(a,b,f,g,h,i,j,k,m,n,p,q,r,s,t):c.drawCurved(a,b,f,g,h,i,j,k,l,m,n,p,q,r,s,t)}function k(a,b,c,d){var e=a._graph._elts.nodes,f=e.attributes,g=e.totalSize,h=f.exists,i=Ogma.shapes.nodes,j=f.shape,k=f.shapeParameters,l=f.x,m=f.y,n=f.size,o=f.visibleOnScreen,q=a._settings.defaultNodeShape,r=null;d/=a._camera.zoom;for(var s=a._camera.getAbsolutePosition(b,c),t=s.x,u=s.y,v=0;v<g;++v){var w=v;h[w]&&o[w]&&i[j[w]||q].detect(l[w],m[w],n[w]+d,t,u,k[w]||p)&&(r=f.ref[w])}return r}function l(a,b,c,d){for(var e=a._graph.nodeAttributes,f=a._graph.edgeAttributes,g=a._graph._elts.edges,h=f.exists,i=g.totalSize,j=Ogma.shapes.edges,k=f.curvature,l=f.shape,m=f.shapeParameters,n=e.x,o=e.y,q=e.size,r=f.source,s=f.target,t=f.size,u=f.visibleOnScreen,v=a._settings.defaultEdgeShape,w=d/a._camera.zoom*2,x=a._camera.getAbsolutePosition(b,c),y=x.x,z=x.y,A=0;A<i;++A){var B=A;if(h[B]&&u[B]){var C,D=r[B],E=s[B],F=l[B]||v,G=j[F],H=t[B]+w,I=k[B],J=m[B]||p,K=n[D],L=o[D],M=n[E],N=o[E],O=q[D],P=q[E];if(C=D===E?G.detectLoop(y,z,K,L,H,I,O,J):0===I?G.detectStraight(y,z,K,L,M,N,H,O,P,J):G.detectCurved(y,z,K,L,M,N,H,I,O,P,J))return f.ref[B]}}return null}var Ogma=$global.Ogma,m={defaultNodeShape:{default:"circle",values:Object.keys(Ogma.shapes.nodes)},defaultEdgeShape:{default:"line",values:Object.keys(Ogma.shapes.edges)},defaultNodeColor:{default:"grey",type:"color"},nodeInnerStrokeColor:{default:"white",type:"color"},nodeInnerStrokeWidth:{default:2,type:"positive"},nodeOuterStrokeWidth:{default:5,type:"positive"},nodeInnerStrokeThreshold:{default:5,type:"positive",values:[a]},defaultEdgeColor:{default:"grey",type:"color"},overrideEdgeColor:{default:a,values:[a,"source","target"]},edgeStrokeWidth:{default:0,type:"positive"},edgesAlwaysCurvy:{default:!1,type:"boolean"},directedEdges:{default:!1,type:"boolean"},edgeThreshold:{default:a,type:"positive",values:[a]}};b.settings=m,b.dependencies=["graph","render","camera","drawing","topology"];var n={},o={};b.prototype.drawEdgeShape=j,b.prototype.nbCurvedEdges=function(){for(var a=this._edgeAttributes.curvature,b=this._graph.edges.list,c=0,d=0;d<this._graph.edges.size;++d)0!==a[b[d]]&&(c+=1);return c},b.prototype.detectNodeShape=function(a,b,c){return k(this,a,b,c||0)},b.prototype.detectEdgeShape=function(a,b,c){return l(this,a,b,c||0)};var p={};Ogma.modules.shapes=b}.call(),function(a){function b(a){this._graph=a.graph,this._renderer=a.render,this._drawing=a.drawing,this._shapes=a.shapes,this._camera=a.camera,this._shapeSettings=a.settings.get("shapes"),this._settings=a.settings.get("pulses"),this._graph.addCommonAttributes({highlightComponents:Array,highlightTimeouts:Array}),this._edgeHighlightZ=this._drawing.MAX_EDGE_Z,this._drawing.addEdgeSubLayer("edgeHighlights",$C("subLayer","edgePulses")),this._drawing.addNodeSubLayer("nodeHighlights",$C("subLayer","nodePulses")),this._drawing.addLayer("pulse",$C("layer","pulse"));var b=this;a.events.bind({"graph.addNodes":function(a){return c(b,!0,a)},"graph.addEdges":function(a){return c(b,!1,a)},"graph.removeNodes":function(a){return d(b,!0,a)},"graph.removeEdges":function(a){return d(b,!0,a)},"graph.clear":function(){}})}function c(b,c,d){for(var e=b._graph._elts.fetch(c).attributes.highlightComponents,f=d.length,g=0;g<f;++g)e[d[g].__index]=a}function d(a,b,c){for(var d=c.length,e=0;e<d;++e)f(a,b,c[e])}function e(a,b,c,d,e,i,j,k){function l(){for(var b=0;o[b]===-1&&b<o.length;)++b;a._renderer.delete(o[b]),o[b]=-1}d=d||a._settings.numberOfPulses,e=e||a._settings.pulseDuration,i=i||a._settings.pulseInterval,j=j||a._settings[b?"nodePulseStartColor":"edgePulseStartColor"],k=k||a._settings[b?"nodePulseEndColor":"edgePulseEndColor"],"inherit"===j&&(j=c.color),"inherit"===k&&(k=c.color),f(a,b,c),a._drawing.putElementOnLayer(c,"pulse");var m=c.__index,n=a._graph.attributes(b),o=[],p=[],q=a._settings[b?"nodePulseWidth":"edgePulseWidth"],r=a._settings[b?"nodePulseStartRatio":"edgePulseStartRatio"],s=a._settings[b?"nodePulseEndRatio":"edgePulseEndRatio"];if(n.highlightComponents[m]=o,n.highlightTimeouts[m]=p,b)for(var t=function(){var b=g(a._renderer,c.x,c.y,c.size*r,c.size*s,q,j,k,e);o.push(b)},u=0;u<d;++u)p.push(setTimeout(t,u*i)),p.push(setTimeout(l,u*i+e));else{var v=function(){var b=h(a,c,j,k,c.size*r,c.size*s,q,e);o.push(b)};for(u=0;u<d;++u)p.push(setTimeout(v,u*i)),p.push(setTimeout(l,u*i+e))}p.push(setTimeout(function(){f(a,b,c)},(d-1)*i+e))}function f(b,c,d){var e=d.__index,f=b._graph.attributes(c),g=f.highlightComponents[e],h=f.highlightTimeouts[e];if(g){for(var i=0;i<g.length;++i)b._renderer.delete(g[i]);for(i=0;i<h.length;++i)clearTimeout(h[i]);f.highlightComponents[e]=a,f.highlightTimeouts[e]=a}b._drawing.removeElementFromLayer(d,"pulse")}function g(a,b,c,d,e,f,g,h,i){var j=Ogma.utils.circleStroke(a,-1,b,c,d,f,g,"nodeHighlights");return a.animate(i,function(){Ogma.utils.circleStroke(a,j,b,c,e,f,h,"nodeHighlights")}),j}function h(a,b,c,d,e,f,g,h){var i,j,k=Ogma.shapes.edges.line,l=a._shapes,m=b.__source,n=b.__target;if(m===n)j=Ogma.geometry.normalize(m.x,m.y,m.x+1,m.y-1,1),i=k.drawLoop(a._renderer,-1,m.x+j.x*e,m.y+j.y*e,0,g,b.curvature,m.size+e/2,c,"edgeHighlights",a._edgeHighlightZ),a._renderer.animate(h,function(){k.drawLoop(a._renderer,i,m.x+j.x*f,m.y+j.y*f,0,g,b.curvature,m.size+f/2,d,"edgeHighlights",a._edgeHighlightZ)});else{j=Ogma.geometry.normalize(m.x,m.y,n.x,n.y,1);var o=j.y,p=-j.x,q=l.drawEdgeShape(a._renderer,-1,k,m,n,m.x+o*e,m.y+p*e,n.x+o*e,n.y+p*e,0,g,b.curvature,m.size,n.size,c,"edgeHighlights",a._edgeHighlightZ),r=l.drawEdgeShape(a._renderer,-1,k,m,n,m.x-o*e,m.y-p*e,n.x-o*e,n.y-p*e,0,g,b.curvature,m.size,n.size,c,"edgeHighlights",a._edgeHighlightZ);a._renderer.animate(h,function(){l.drawEdgeShape(a._renderer,q,k,m,n,m.x+o*f,m.y+p*f,n.x+o*f,n.y+p*f,0,g,b.curvature,m.size,n.size,d,"edgeHighlights",a._edgeHighlightZ),l.drawEdgeShape(a._renderer,r,k,m,n,m.x-o*f,m.y-p*f,n.x-o*f,n.y-p*f,0,g,b.curvature,m.size,n.size,d,"edgeHighlights",a._edgeHighlightZ)}),i=a._renderer.composite(-1,[q,r])}return a._renderer.setDepth(i,a._edgeHighlightZ),i}function i(a,b,c,d){d=d||{};for(var f=a._graph.getElementList(b,c),g=0;g<f.length;++g)e(a,b,f[g],d.nbPulses,d.pulseDuration,d.pulseInterval,d.startColor,d.endColor)}var Ogma=$global.Ogma;b.settings={pulseDuration:{default:1e3,type:"positive"},pulseInterval:{default:300,type:"positive"},numberOfPulses:{default:1,type:"positive"},nodePulseWidth:{default:50,type:"positive"},nodePulseStartRatio:{default:1,type:"positive"},nodePulseEndRatio:{default:2,type:"positive"},nodePulseStartColor:{default:"rgb(0,0,0,0.6)",type:"color",values:["inherit"]},nodePulseEndColor:{default:"rgb(0,0,0,0.0)",type:"color",values:["inherit"]},edgePulseWidth:{default:10,type:"positive"},edgePulseStartRatio:{default:1,type:"positive"},edgePulseEndRatio:{default:2,type:"positive"},edgePulseStartColor:{default:"rgb(0,0,0,0.6)",type:"color",values:["inherit"]},edgePulseEndColor:{default:"rgb(0,0,0,0.0)",type:"color",values:["inherit"]}},b.dependencies=["graph","drawing","shapes"],b.prototype.nodes=function(a,b){i(this,!0,a,b)},b.prototype.edges=function(a,b){i(this,!1,a,b)},Ogma.modules.pulses=b}.call(),function(a){function b(b,f){this._events=b.events.create("render.",["beforeNewFrame","newFrame","setContainer","resize","reload","export"]),this._settings=b.settings.get("render"),this._frameCount=0,this.screen={width:0,height:0},this._windowEvtListeners={resize:function(){e(this)}.bind(this),mediaChange:function(a){d(a,this)}.bind(this)},"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("resize",this._windowEvtListeners.resize),window.matchMedia("screen and (min-resolution: 2dppx)").addListener(this._windowEvtListeners.mediaChange)),this._container=null,this._renderer=null,this._exportedRenderer=null,this._backgroundColor=this._settings.backgroundColor,this._subLayers={},this._cursorStyles=[],this._isFullScreen=!1;var g=f.dimensions||{width:800,height:600},h=$or(f.render,["webgl","canvas"]);if("string"==typeof h&&(h=[h]),this._renderType="dummy",("undefined"==typeof window||window.__OGMA_HEADLESS)&&(h=null),h)for(var i=0;i<h.length;++i){var j=Ogma.renderers[h[i]];if(j===a)$warn("The renderer "+h[i]+" does not exist.");else{if(j.available){this._renderType=h[i];break}$info(i<h.length-1?"The "+(j.infoName||h[i])+" renderer is not available, fallbacking on "+h[i+1]+".":"The "+(j.infoName||h[i])+" renderer is not available.")}"dummy"===this._renderType&&$warn("No valid renderer could be found, rendering will be disabled.")}this.screen.width=g.width,this.screen.height=g.height,this._visibilityConditionTolerance=0,c(this)}function c(a){var b=a._events.newFrame,c=a._events.beforeNewFrame;a._renderer=new Ogma.renderers[a._renderType](a.screen.width,a.screen.height,a._subLayers,{onRender:function(d){a._frameCount+=1,c(d),b(d)},imgCrossOrigin:a._settings.imgCrossOrigin,backgroundColor:a._backgroundColor,antialias:a._settings.webGLAntiAliasing,fontSamplingSize:a._settings.webGLFontSamplingSize,minSvgSize:a._settings.webGLMinimumSVGSize,defaultFont:a._settings.defaultFont}),a._events.reload()}function d(a,b){e(b)}function e(a){if(a._container){var b=!1,c=a._container.clientWidth,d=a._container.clientHeight;c&&d?(a._noDimensions&&(b=!0),a._noDimensions=!1):a._noDimensions=!0;var e=c-a.screen.width,f=d-a.screen.height;a.screen.width=c||1,a.screen.height=d||1,a._renderer.resize(c,d),a._events.resize({width:e,height:f},b)}}function f(a){a._renderer&&a._renderer.refresh()}function g(a,b){var c=a._subLayers[b];if(!c)throw new Error('sub-layer "'+b+'" does not exist.');return c}function h(b){b.x===a&&(b.x=0),b.y===a&&(b.y=0),b.zx===a&&(b.zx=0),b.zy===a&&(b.zy=0),b.ax===a&&(b.ax=0),b.ay===a&&(b.ay=0),b.ox===a&&(b.ox=0),b.oy===a&&(b.oy=0)}function i(a,b){h(a),h(b)}function j(a,b,c){h(a),h(b),h(c)}function k(a,b,c,d){h(a),h(b),h(c),h(d)}function l(a){var b=0===a._cursorStyles.length?a._settings.defaultCursorStyle:a._cursorStyles[a._cursorStyles.length-1];a._container&&(a._container.style.cursor=b)}function m(a){for(var b=0;b<q.length;++b){var c=q[b];if(a[c])return c}return null}function n(){for(var a=0;a<r.length;++a){var b=r[a];if(document[b])return b}return null}var Ogma=$global.Ogma,o={imgCrossOrigin:{default:"anonymous",values:[null,"anonymous","use-credentials"]},backgroundColor:{default:"white",type:"color",values:[null]},defaultCursorStyle:{default:"default",type:"string"},defaultFont:{default:"Arial",type:"string"},webGLAntiAliasing:{default:"super-sampling",values:["super-sampling","native","none"]},webGLFontSamplingSize:{default:32,type:"positive"},webGLMinimumSVGSize:{default:null,type:"positive",values:[null]}};b.settings=o,b.dependencies=["settings","events"],b.onStart=function(a,b){b.container?a.setContainer(b.container):a.container=null},b.onKill=function(a){var b=a._renderer.domElement();a._container&&(b&&a._container.removeChild(b),"undefined"!=typeof window&&window.removeEventListener&&(window.removeEventListener("resize",a._windowEvtListeners.resize),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(a._windowEvtListeners.mediaChange)),a._windowEvtListeners=null)},b.prototype.setContainer=function(a){if("string"==typeof a&&(a=document.getElementById(a)),a!==this._container){var b=this._container,c=this._renderer.domElement();c&&(this._container&&this._container.removeChild(c),a&&a.appendChild(c)),this._container=a,this._container&&(e(this),l(this)),this._events.setContainer(a,b)}},b.prototype.getContainer=function(){return this._container},b.prototype.getCanvas=function(){return this._renderer.domElement()},b.prototype.resize=function(){this._container&&e(this)};var p={x:0,y:0,zoom:1,angle:0};b.prototype.addSubLayer=function(a,b){if(this._subLayers[a])throw new Error("sub-layer "+a+" already exists");b=b||{},this._subLayers[a]={name:a,level:b.level,defineClipSpace:!!b.defineClipSpace,useClipSpace:!!b.useClipSpace,symbolicSizeThreshold:b.symbolicSizeThreshold||0,camera:b.camera||p,disabled:!1,transparency:b.transparency||!1}},b.prototype.type=function(){return this._renderType},b.prototype.changeSubLayerThreshold=function(a,b){
var c=g(this,a);c.symbolicSizeThreshold=b||0,f(this)},b.prototype.getSubLayers=function(){return Ogma.utils.deepCopy(this._subLayers)},b.prototype.atNextFrame=function(a){return this._renderer.atNextFrame(a)},b.prototype.setSubLayerEnabled=function(a,b){var c=g(this,a);c.disabled=!b,f(this)},b.prototype.setSubLayersEnabled=function(a,b){for(var c=0;c<a.length;++c){var d=g(this,a[c]);d.disabled=!b}f(this)},b.prototype.animate=function(a,b){this._renderer.animate(a,b)},b.prototype.stopAnimations=function(){this._renderer.stopAnimations()},b.prototype.setAnimationsEnabled=function(a){this._renderer.setAnimationsEnabled(a)},b.prototype.setOffset=function(a){a&&h(a),this._renderer.setOffset(a)},b.prototype.refresh=function(){this._renderer.refresh()},b.prototype.delete=function(a){return this._exportedRenderer?a:this._renderer.delete(a)},b.prototype.setDepth=function(a,b){this._renderer.setDepth(a,b)},b.prototype.hide=function(a){this._renderer.hide?this._renderer.hide(a):this._renderer.setDepth(a,0)},b.prototype.setSymbolicSize=function(a,b){this._renderer.setSymbolicSize(a,b)},b.prototype.setColor=function(a,b){this._renderer.setColor(a,b)},b.prototype.setVisibilityCondition1=function(a,b,c,d,e){this._renderer.setVisibilityCondition1(a,b,c,d,e)},b.prototype.setVisibilityCondition2=function(a,b,c,d,e){this._renderer.setVisibilityCondition2(a,b,c,d,e)},b.prototype.wrappedUpdate=function(a,b,c){return this._exportedRenderer?this._exportedRenderer.wrappedUpdate(-1,b,c):this._renderer.wrappedUpdate(a,b,c)},b.prototype.updateComposite=function(a,b){return this._exportedRenderer?this._exportedRenderer.updateComposite(-1,b):this._renderer.updateComposite(a,b)},b.prototype.composite=function(a,b){return this._exportedRenderer?(this._renderer.composite(-1,b),a):this._renderer.composite(a,b)},b.prototype.circle=function(a,b,c,d,e,f,g,i){return h(b),this._exportedRenderer?(this._exportedRenderer.circle(-1,b,c,d,e,f,g,i),a):this._renderer.circle(a,b,c,d,e,f,g,i)},b.prototype.triangle=function(a,b,c,d,e,f,g,h){return j(b,c,d),this._exportedRenderer?(this._exportedRenderer.triangle(-1,b,c,d,e,f,g,h),a):this._renderer.triangle(a,b,c,d,e,f,g,h)},b.prototype.rectangle=function(a,b,c,d,e,f,g,h){return i(b,c),this._exportedRenderer?(this._exportedRenderer.rectangle(-1,b,c,d,e,f,g,h),a):this._renderer.rectangle(a,b,c,d,e,f,g,h)},b.prototype.quadrilateral=function(a,b,c,d,e,f,g,h,i,j){return k(b,c,d,e),this._exportedRenderer?(this._exportedRenderer.quadrilateral(-1,b,c,d,e,f,g,h,i,j),a):this._renderer.quadrilateral(a,b,c,d,e,f,g,h,i,j)},b.prototype.polygon=function(a,b,c,d,e,f){return this._exportedRenderer?(this._exportedRenderer.polygon(-1,b,c,d,e,f),a):this._renderer.polygon(a,b,c,d,e,f)},b.prototype.line=function(a,b,c,d,e,f,g,h,j){return i(b,c),this._exportedRenderer?(this._exportedRenderer.line(-1,b,c,d,e,f,g,h,j),a):this._renderer.line(a,b,c,d,e,f,g,h,j)},b.prototype.quadraticCurve=function(a,b,c,d,e,f,g,h,i,k){return j(b,c,d),this._exportedRenderer?(this._exportedRenderer.quadraticCurve(-1,b,c,d,e,f,g,h,i,k),a):this._renderer.quadraticCurve(a,b,c,d,e,f,g,h,i,k)},b.prototype.cubicCurve=function(a,b,c,d,e,f,g,h,i,j,l){return k(b,c,d,e),this._exportedRenderer?(this._exportedRenderer.cubicCurve(-1,b,c,d,e,f,g,h,i,j,l),a):this._renderer.cubicCurve(a,b,c,d,e,f,g,h,i,j,l)},b.prototype.image=function(a,b,c,d,e,f,g,h,j){return i(b,c),this._exportedRenderer?(this._exportedRenderer.image(-1,b,c,d,e,f,g,h,j),a):this._renderer.image(a,b,c,d,e,f,g,h,j)},b.prototype.text=function(a,b,c,d,e,f,g,i,j,k,l,m,n,o){return h(b),this._exportedRenderer?(this._exportedRenderer.text(-1,b,c,d,e,f,g,i,j,k,l,m,n,o),a):this._renderer.text(a,b,c,d,e,f,g,i,j,k,l,m,n,o)},b.prototype.textWidth=function(a,b,c,d){return this._exportedRenderer?this._exportedRenderer.textWidth(a,b,c,d):this._renderer.textWidth(a,b,c,d)},b.prototype.enableShadows=function(a,b,c){return this._exportedRenderer?this._exportedRenderer.enableShadows(a,b,c):this._renderer.enableShadows(a,b,c)},b.prototype.disableShadows=function(){return this._exportedRenderer?this._exportedRenderer.disableShadows():this._renderer.disableShadows()},b.prototype.reloadFonts=function(){this._renderer.reloadFonts&&this._renderer.reloadFonts(),this._events.reload()},b.prototype.setCursorStyle=function(a){this._cursorStyles.push(a),l(this)},b.prototype.removeCursorStyle=function(a){var b=this._cursorStyles.lastIndexOf(a);b!==-1&&(this._cursorStyles.splice(b,1),l(this))};var q=["requestFullScreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],r=["cancelFullScreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"];b.prototype.fullScreen=function(b){if(b===a&&(b=!this._isFullScreen),this._container)if(b){var c=m(this._container);c&&this._container[c]()}else this._isFullScreen&&(c=n(),document[c]());this._isFullScreen=b},b.prototype.setVisibilityConditionTolerance=function(a){this._visibilityConditionTolerance=a,this._renderer.setVisibilityConditionTolerance(a)},b.prototype.clear=function(){this._renderer.clear(),this._renderer.refresh()},b.prototype.isFullScreen=function(){return this._isFullScreen},b.prototype.export=function(b,c,d,e,f){var g=new b(c,d,this._subLayers,{noRefresh:!0,backgroundColor:e}),h=this.screen.width,i=this.screen.height;return g.setVisibilityConditionTolerance=this._visibilityConditionTolerance,this._exportedRenderer=g,this.screen.width=c,this.screen.height=d,this._events.export(),f&&f(),g.render(),this._exportedRenderer=a,this.screen.width=h,this.screen.height=i,0===this._frameCount&&this._events.reload(),g},b.prototype.setBackgroundColor=function(a){var b=this._backgroundColor;return this._backgroundColor=a,this._renderer.setBackgroundColor(a),this.refresh(),b},b.prototype.getbackgroundColor=function(){return this._backgroundColor},Ogma.modules.render=b}.call(),function(a){function b(a){this._ogma=a}var Ogma=$global.Ogma;b.prototype.to=function(a,b){var c=this._ogma;return new Promise(function(d,e){var f=Ogma.exports[a];if(!f)throw new Error(a+" is not a valid exporter.");b=b?"function"==typeof b?{callback:b}:Ogma.utils.deepCopy(b):{};var g=function(c,e){if(!c)throw new Error("exporting to "+a+" gave empty result");var f="undefined"!=typeof window&&$or(b.download,!b.callback),g=b.filename||"graph."+a;e=e||"text",f&&Ogma.utils.download(c,g,e),b.callback&&b.callback(c,e),d(c,e)};c.geo.isEnabled()?c.geo.whenReady(function(){f(c,g,b)}):setTimeout(function(){return f(c,g,b)})})},Ogma.modules.exports=b}.call(),function(){function a(a){var b=this;this._ogma=a,this._drawing=a.drawing,this._texts=a.texts,this._tasks=a.tasks,this._settings=a.settings.get("layouts",!0),this._events=a.events.create("layout.",["start","end"]),this._currentLayout=null,a.events.bind({"graph.clear":function(){return b.stop()}})}function b(a,b){var c=a.length,d=new Float32Array(c),e=new Float32Array(c),f=new Uint32Array(c),g=new Uint8Array(c),h=b.nodeAttributes,i=h.x,j=h.y,k=h.pinned,l=b._maps.nodes;return a.forEach(function(a,b){var c=l.get(a),h=c.__index;f[b]=h,d[b]=i[h],e[b]=j[h],g[b]=k[h]}),{x:d,y:e,indexes:f,ids:a,pinned:g,size:c}}var Ogma=$global.Ogma,c=40;a.settings={defaultSyncDuration:{default:500,type:"positive"},skipTextDrawing:{default:!0,type:"boolean"},useWebWorker:{default:!0,type:"boolean"}},a.dependencies=["graph","render","animations","drawing","texts","tasks"],a.layouts=Object.create(null),a.prototype.start=function(a,b,d){var e=this,f=Ogma.layouts[a],g=this._settings,h=this;return new Promise(function(i){if(!f)throw new Error("layout "+a+" does not exist");e._currentLayout&&e._currentLayout.stop(),b=$or(b,{}),d="function"==typeof d?{onEnd:d}:$or(d,{});var j="number"==typeof d.duration?d.duration:g.defaultSyncDuration,k=f.onSync,l=d.onSync,m=0;b.nodeTextsWereEnabled=e._texts.isNodeTextDrawingEnabled(),b.edgeTextsWereEnabled=e._texts.isEdgeTextDrawingEnabled(),b.name=a;var n={update:f.update,isRunning:f.isRunning,configure:f.configure,context:f.context,dependencies:f.dependencies,onStart:function(){h.onStart(f,b,this)},onUpdate:function(a,b,d,e){var f=this,i=Ogma.utils.now();e&&i-m<c||(m=i,l&&setTimeout(function(){return l(a,d,e)},j),g.skipTextDrawing&&h._texts.setTextDrawing(!1),k?h._drawing.animate(function(){h._drawing.redrawEverything(),k(a,b,d,e)},j,function(){e||f.fire("complete")}):e||this.fire("complete"))},onEnd:function(a,c){this.once("complete",function(){h.onComplete(a,f,b,c,i,d.onEnd)})}};e._currentLayout=e._tasks.run(n,b,$or(d.useWebWorker,e._settings.useWebWorker))})},a.prototype.onComplete=function(a,c,d,e,f,g){var h=this._settings;c.onEnd&&(c.onEnd(a,e,this._ogma,!1),this._drawing.redrawEverything()),h.skipTextDrawing&&(d.nodeTextsWereEnabled&&this._texts.setNodeTextDrawing(!0),d.edgeTextsWereEnabled&&this._texts.setEdgeTextDrawing(!0)),this._currentLayout=null;var i=d.nodeData.ids,j=b(i,this._ogma.graph),k=d.nodeData;this._events.end(d.name,{x:j.x,y:j.y},{x:k.x,y:k.y},i,k.indexes),setTimeout(function(){g&&g(a),f()})},a.prototype.onStart=function(a,c,d){var e=this._ogma.graph,f=e.getNodeIdList(c.nodes||this._ogma.nodes),g=b(f,e);c.nodeData=g,this._events.start(c.name,f,d,g.indexes)},a.prototype.stop=function(){this._currentLayout&&(this._currentLayout.stop(),this._currentLayout=null)},a.prototype.isRunning=function(){return!!this._currentLayout},Ogma.modules.layouts=a}(),function(a){function b(a){var b=this;this._settings=a.settings.get("drawing",!0),this._events=a.events.create("drawing.",["nodes","edges","nodesVisibilityChange","edgesVisibilityChange","everything","before","after"]),this._renderer=a.render,this._camera=a.camera,this._topology=a.topology,this._graph=a.graph,this._graph.addCommonAttributes({baseDepth:Float32Array,depth:Float32Array,symbolicSize:Float32Array,layers:Array,visible:Int8Array,toDraw:Int8Array,visibilityChanged:Int8Array}),this.EPSILON=u;var i=this._graph.nodeAttributes,j=this._graph.edgeAttributes;this._graph.addNodeReadOnlyProperty("layers",function(a){return i.layers[a.__index]},!1),this._graph.addEdgeReadOnlyProperty("layers",function(a){return j.layers[a.__index]},!1),this.MIN_DEPTH=u,this.MAX_EDGE_Z=w,this._nodeSubLayers={},this._edgeSubLayers={},this._nextEdgeZ=4*u,this._nextNodeZ=v/2*u+u,this._nodeVisibilityConditions=[],this._edgeVisibilityConditions=[],this._animations=[],this._animationsToProcess=[],this._layers={},this._defaultCamera={x:0,y:0,angle:0,zoom:1},this._sortLayerFunction=function(a,c){return b._layers[c].value-b._layers[a].value},this._nodeComponentAttributes=[],this._edgeComponentAttributes=[],this._nodeComponentFixedDepths={},this._edgeComponentFixedDepths={},this._nodeComponentExceptions={},this._edgeComponentExceptions={},this._redrawElementFunction=function(a,c,d){d&&b.redraw(a)},this._eltsToDraw=$dual(Array),this._visibilityChanged=$dual(Array),this._drawEverything=!1,this._updateAllVisibility=!1,this._renderer.setVisibilityConditionTolerance(this._settings.edgeClippingPadding),this.addLayer("floor",$C("layer","floor")),this._draw=function(){d(b)},this.addNodeVisualProperty("x",{type:"number"},0),this.addNodeVisualProperty("y",{type:"number"},0),this.addNodeVisualProperty("size",{type:"number"},this._settings.defaultNodeSize,function(a){h(b,a)}),this.addEdgeVisualProperty("size",{type:"number"},this._settings.defaultEdgeSize,function(a){h(b,a)}),this.addCommonVisualProperty("hidden",{values:[!0,!1]},!1,function(a){g(b,a)}),this._graph.addEdgeReadOnlyProperty("visible",function(a){return!!j.visible[a.__index]},!1),this._graph.addNodeReadOnlyProperty("visible",function(a){return!!i.visible[a.__index]},!1),a.events.bind({"graph.addNodes":function(a){e(b,!0,a)},"graph.addEdges":function(a){e(b,!1,a)},"graph.removeNodes":function(a){f(b,!0,a)},"graph.removeEdges":function(a){f(b,!1,a)},"graph.startInit":function(){b._drawEverything=!0},"graph.clear":function(){b._visibilityChanged=$dual(Array),b._eltsToDraw=$dual(Array),b._nextEdgeZ=u,b._nextNodeZ=v/2*u+u,b._renderer.clear()},"camera.move":function(){var a={x:b._renderer.screen.width/2/b._camera.zoom,y:b._renderer.screen.height/2/b._camera.zoom};Ogma.geometry.rotate(a.x,a.y,0,0,b._camera.angle,a),b._defaultCamera.x=b._camera.x-a.x,b._defaultCamera.y=b._camera.y-a.y,b._defaultCamera.angle=b._camera.angle,b._defaultCamera.zoom=b._camera.zoom,b._renderer.refresh()},"render.newFrame":function(){if(d(b),b._animationsToProcess.length){var a=b._animationsToProcess.slice();b._animationsToProcess=[];for(var e=0;e<a.length;++e){var f=a[e];b._animations.push(f),f.timeout=setTimeout(c(b,f),f.duration),f.func(),b._renderer.animate(f.duration,b._draw)}}},"render.reload":function(){b.redrawEverything()},"render.export":function(){b.redrawEverything(!0)}}),this.addNodeVisibilityCondition(function(a){return!i.hidden[a.__index]}),this.addEdgeVisibilityCondition(function(a){return!j.hidden[a.__index]}),this.addEdgeVisibilityCondition(function(a){return!a.__source.hidden&&!a.__target.hidden}),this._renderer.refresh()}function c(a,b){return function(){var c=a._animations.indexOf(b);c!==-1&&a._animations.splice(c,1),b.callback&&b.callback()}}function d(a){i(a,!0),i(a,!1);var b=a._drawEverything||a._eltsToDraw.nodes.length||a._eltsToDraw.edges.length,c=a._graph._elts.nodes.attributes.toDraw,d=a._graph._elts.edges.attributes.toDraw,e=a._eltsToDraw.nodes,f=a._eltsToDraw.edges;if(a._events.before(),a._visibilityChanged=$dual(Array),a._eltsToDraw=$dual(Array),a._drawEverything)c.fill(0),d.fill(0),l(a,a._graph.getNodeList()),m(a,a._graph.getEdgeList()),a._events.everything();else{for(var g=0;g<e.length;++g)c[e[g].__index]=0;for(g=0;g<f.length;++g)d[f[g].__index]=0;l(a,e),m(a,f)}a._updateAllVisibility||a._drawEverything?(k(a,!0,a._graph.nodes),k(a,!1,a._graph.edges)):(k(a,!0,e),k(a,!1,f)),a._updateAllVisibility=!1,a._drawEverything=!1,b&&a._events.after()}function e(a,b,c){for(var d=a._graph.attributes(b),e=a[b?"_nextNodeZ":"_nextEdgeZ"],f=a[b?"_nodeComponentAttributes":"_edgeComponentAttributes"],g=d.layers,h=d.baseDepth,i=d.depth,j=d.visible,k=d.symbolicSize,l=d.size,m=d.toDraw,n=d.visibilityChanged,o=b?x:w,p=f.map(function(a){return d[a]}),q=p.length,r=c.length,s=0;s<r;++s){var t=c[s],v=t.__index;g[v]=["floor"],h[v]=e,i[v]=e,j[v]=!0,k[v]=l[v],m[v]=0,n[v]=0,e<o&&(e+=u);for(var y=0;y<q;++y)p[y][v]=-1}a[b?"_nextNodeZ":"_nextEdgeZ"]=e,a.redraw(c)}function f(b,c,d){for(var e=b._graph.attributes(c),f=b._renderer,g=b[c?"_nodeComponentAttributes":"_edgeComponentAttributes"],h=e.layers,i=e.toDraw,j=e.visibilityChanged,k=g.map(function(a){return e[a]}),l=k.length,m=b._eltsToDraw.fetch(c),n=b._visibilityChanged.fetch(c),o=0,p=d.length;o<p;++o){var q=d[o],r=q.__index;i[r]&&$rm(m,q),n[r]&&$rm(n,q),h[r]=a,i[r]=0,j[r]=0;for(var s=0;s<l;++s)k[s][r]=f.delete(k[s][r])}b._renderer.refresh()}function g(a,b){if(!a._drawEverything&&!a._updateAllVisibility){if(!(b instanceof Array))return g(a,[b]);if(b.length){for(var c=b[0].isNode,d=a._graph._elts.fetch(c),e=d.attributes.visibilityChanged,f=d.attributes.edges,h=a._visibilityChanged.fetch(c),i=b.length,j=0;j<i;++j){var k=b[j],l=k.__index;if(!e[l]&&(e[l]=1,h.push(k),c)){var m=f[l];m.length&&g(a,m)}}a.redraw(b)}}}function h(a,b){p(a,b),a.redraw(b)}function i(a,b){var c=a._graph.attributes(b).visibilityChanged,d=a._graph.attributes(b).visible;if(a._drawEverything||a._updateAllVisibility){for(var e=a._graph[b?"getNodeList":"getEdgeList"](),f=0,g=e.length;f<g;++f){var h=e[f];d[h.__index]=o(a,h)}return a._events[b?"nodesVisibilityChange":"edgesVisibilityChange"](e),c.fill(0),!0}if(e=a._visibilityChanged.fetch(b),e.length){for(f=0,g=e.length;f<g;++f){h=e[f];var i=h.__index;d[i]=o(a,h),c[i]=0}return a._events[b?"nodesVisibilityChange":"edgesVisibilityChange"](e),!0}return!1}function j(a,b){var c=a?x:w;return b-b%c+c}function k(a,b,c){if(c.length)for(var d=a._graph.attributes(b),e=a[b?"_nodeComponentAttributes":"_edgeComponentAttributes"],f=a[b?"_nodeComponentFixedDepths":"_edgeComponentFixedDepths"],g=a[b?"_nodeComponentExceptions":"_edgeComponentExceptions"],h=d.visible,i=d.baseDepth,k=d.layers,l=a._layers,m=d.depth,n=a._renderer,o=e.map(function(a){return d[a]}),p=o.length,q=0,r=c.length;q<r;++q){var s=c[q],t=s.__index,u=h[t],v=k[t][0],w=l[v],x=i[t]+w.value;m[t]=u?x:-1;for(var y=0;y<p;++y){var z=e[y];if(u){if(!g[z]||"floor"!==v){var A=f[z]||x;"top-layer"===A&&(A=j(b,x)),n.setDepth(o[y][t],A)}}else n.hide(o[y][t])}}}function l(a,b){b.length&&a._events.nodes(b)}function m(a,b){if(b.length){a._events.edges(b);var c=a._graph.edgeAttributes,d=a._graph.nodeAttributes,e=d.x,f=d.y,g=d.size,h=a._edgeComponentAttributes.map(function(a){return c[a]});if(a._settings.edgeClipping)for(var i=0,j=b.length;i<j;++i)for(var k=b[i],l=k.__index,m=k.__sourceIndex,n=k.__targetIndex,o=e[m],p=f[m],q=g[m],r=e[n],s=f[n],t=g[n],u=0,v=h.length;u<v;++u){var w=h[u][l];a._renderer.setVisibilityCondition1(w,!0,o,p,q),a._renderer.setVisibilityCondition2(w,!0,r,s,t)}}}function n(a,b){var c=a._layers[b];if(!c)throw new Error("Layer "+b+" does not exist.");return c}function o(a,b){for(var c=a[b.isNode?"_nodeVisibilityConditions":"_edgeVisibilityConditions"],d=0;d<c.length;++d)if(!c[d](b))return!1;return!0}function p(a,b){var c=b.isNode,d=b.__index,e=a._graph.attributes(c),f=r(a,b),g=f.disableThreshold?-1:e.size[d];e.symbolicSize[d]=g}function q(a,b){p(a,b),a.redraw(b)}function r(a,b){return a._layers[b.layers[0]]}function s(a,b,c){for(var d=a[b?"_nodeSubLayers":"_edgeSubLayers"],e=Object.keys(d),f=0;f<e.length;++f)a._renderer.setSubLayerEnabled(e[f],c)}var Ogma=$global.Ogma,t={defaultNodeSize:{default:5,type:"positive"},defaultEdgeSize:{default:1,type:"positive"},edgeClipping:{default:!0,type:"boolean"},edgeClippingPadding:{default:100,type:"positive"}},u=Ogma.constants.EPSILON,v=Math.pow(2,18),w=(Math.pow(2,Ogma.constants.MAX_POW-18),v/2*u),x=v*u,y=v*u;b.settings=t,b.dependencies=["render","camera","graph"],b.prototype.animate=function(a,b,c){if("function"!=typeof a)throw new TypeError(a+" is not a function");if("number"!=typeof b)throw new TypeError(b+" is not a number");this._animationsToProcess.push({duration:b,func:a,callback:c}),this._renderer.refresh()},b.prototype.stopAnimations=function(a){a=$or(a,!0),this._renderer.stopAnimations();var b=this._animations.slice();this._animations=[];for(var c=0;c<b.length;++c){var d=b[c];d.callback&&a&&d.callback(),d.timeout&&clearTimeout(d.timeout)}},b.prototype.isAnimating=function(){return this._animations.length>0},b.prototype.redrawEverything=function(a){this._drawEverything=!0,a?d(this):this._renderer.refresh()},b.prototype.updateAllVisibility=function(){this._updateAllVisibility=!0,this._renderer.refresh()},b.prototype.redraw=function(a){if(!this._drawEverything){if(a instanceof Array){if(!a.length)return;for(var b=a[0].isNode,c=this._graph._elts.fetch(b),d=c.attributes.toDraw,e=c.attributes.edges,f=this._eltsToDraw.fetch(b),g=a.length,h=0;h<g;++h){var i=a[h],j=i.__index;if(!d[j]&&(f.push(i),d[j]=1,b)){var k=e[j];k.length&&this.redraw(k)}}}else this.redraw([a]);this._renderer.refresh()}},b.prototype.topOfLayer=j,b.prototype.addVisibilityCondition=function(a,b){a?this._nodeVisibilityConditions.push(b):this._edgeVisibilityConditions.push(b)},b.prototype.addCommonVisibilityCondition=function(a){this._nodeVisibilityConditions.push(a),this._edgeVisibilityConditions.push(a)},b.prototype.addNodeVisibilityCondition=function(a){this._nodeVisibilityConditions.push(a)},b.prototype.addEdgeVisibilityCondition=function(a){this._edgeVisibilityConditions.push(a)},b.prototype.addVisualProperty=function(a,b,c,d,e){e=e||this._redrawElementFunction,this._graph.addProperty(a,b,c,d,e)},b.prototype.addNodeVisualProperty=function(a,b,c,d){this.addVisualProperty(!0,a,b,c,d)},b.prototype.addEdgeVisualProperty=function(a,b,c,d){this.addVisualProperty(!1,a,b,c,d)},b.prototype.addCommonVisualProperty=function(a,b,c,d){this.addVisualProperty(!0,a,b,c,d),this.addVisualProperty(!1,a,b,c,d)},b.prototype.addVisualComponent=function(a,b,c,d){this._graph._elts.fetch(a).addAttribute(b,Int32Array),this[a?"_nodeComponentAttributes":"_edgeComponentAttributes"].push(b),this[a?"_nodeComponentFixedDepths":"_edgeComponentFixedDepths"][b]=c,this[a?"_nodeComponentExceptions":"_edgeComponentExceptions"][b]=d},b.prototype.addNodeVisualComponent=function(a,b,c){this.addVisualComponent(!0,a,b,c)},b.prototype.addEdgeVisualComponent=function(a,b,c){this.addVisualComponent(!1,a,b,c)},b.prototype.addCommonVisualComponent=function(a,b,c){this.addVisualComponent(!0,a,b,c),this.addVisualComponent(!1,a,b,c)},b.prototype.isVisible=function(a){return o(this,a)},b.prototype.updateVisibility=function(a){g(this,a)},b.prototype.addSubLayer=function(a,b,c){"number"==typeof c&&(c={level:c}),c.camera=$or(c.camera,this._defaultCamera),this[a?"_nodeSubLayers":"_edgeSubLayers"][b]=c,this._renderer.addSubLayer(b,c)},b.prototype.addNodeSubLayer=function(a,b){this.addSubLayer(!0,a,b)},b.prototype.addEdgeSubLayer=function(a,b){this.addSubLayer(!1,a,b)},b.prototype.changeSubLayerThreshold=function(a,b){this._renderer.changeSubLayerThreshold(a,b)},b.prototype.addLayer=function(a,b,c){if(this._layers[a])throw new Error("layer "+a+" already exists.");b=$or(b,{}),c=$or(c,{}),"number"==typeof b&&(b={level:b}),this._layers[a]={value:y*b.level,disableThreshold:$or(b.disableThreshold,!1),data:c}},b.prototype.editLayer=function(a,b){var c=n(this,a);b=b||{},Ogma.utils.forEach(b,function(a,b){c.data[b]=a})},b.prototype.bindValueToLayer=function(a,b,c){n(this,a).data[b]=c},b.prototype.getElementProperty=function(b,c){var d=b.__index,e=b.isNode,f=this._graph.attributes(e);if(f[c]&&f[c][d]!==a)return f[c][d];for(var g=f.layers[d],h=0;h<g.length;++h){var i=this._layers[g[h]],j=i.data[c];if(j!==a)return j}return a},b.prototype.putElementOnLayer=function(a,b){if(!this._layers[b])throw new Error("layer "+b+" does not exist");var c=a.layers;return!(!c||c.indexOf(b)!==-1)&&(c.push(b),c.sort(this._sortLayerFunction),q(this,a),!0)},b.prototype.removeElementFromLayer=function(a,b){var c=a.layers;if(c){var d=c.indexOf(b);return d!==-1&&(c.splice(d,1),q(this,a),!0)}},b.prototype.removeFromLayer=b.prototype.removeElementFromLayer,b.prototype.putNodeOnLayer=function(a,b){this.putElementOnLayer(a,b)},b.prototype.putEdgeOnLayer=function(a,b){this.putElementOnLayer(a,b)},b.prototype.removeNodeFromLayer=function(a,b){this.removeElementFromLayer(a,b)},b.prototype.removeEdgeFromLayer=function(a,b){this.removeElementFromLayer(a,b)},b.prototype.setNodeDrawing=function(a){s(this,!0,a)},b.prototype.setEdgeDrawing=function(a){s(this,!1,a)},Ogma.modules.drawing=b}.call(),function(a){function b(a){var b=this;this._graph=a.graph,this._graph.addNodeProperty("pinned",{values:[!0,!1]},!1,function(a,d){return c(b,a,d)}),this._pinnedNodes=[],a.events.bind({"graph.clear":function(){b.pinnedNodes=[]}})}function c(a,b,c){var d=a._pinnedNodes.indexOf(b);c&&d===-1?a._pinnedNodes.push(b):c||d===-1||a._pinnedNodes.splice(d,1)}var Ogma=$global.Ogma;b.dependencies=["graph"],b.prototype.getPinnedNodes=function(){return this._pinnedNodes.slice()},b.prototype.getUnpinnedNodes=function(){for(var a=this._graph.attributes(!0).pinned,b=this._graph.nodes,c=[],d=0,e=b.length;d<e;++d){var f=b[d];a[f.__index]||c.push(f)}return c},Ogma.modules.pinning=b}.call(),function(a){function b(a){this._graph=a.graph,this._locate=a.locate,this._camera=a.camera,this._render=a.render,this._settings=a.settings.get("imports",!0)}function c(a){if(0===a.indexOf("http://")||0===a.indexOf("https://"))return a;var b=window.location.origin,c=window.location.pathname,d=c.lastIndexOf("/");return b+=d===-1?"/"+a:c.substr(0,d)+"/"+a}function d(a,b,d,e,g,h){var i=["var importer = "+b.toString()+";",'var file = "'+c(d)+'";',"var xhr = new XMLHttpRequest();",'xhr.open("GET", file, true);',"xhr.onreadystatechange = function () {",'  if (xhr.readyState === 4 && xhr.responseText !== "") {',"    var graph = importer(xhr.responseText, function () {});","    self.postMessage(graph);","  }","}","xhr.send();"].join("\n"),j=Ogma.utils.createWorker(i);j.addEventListener("message",function(b){f(a,b.data,e,g,h)})}function e(a,b,c,d,e,g){var h=new XMLHttpRequest;h.open("GET",c,!0),h.onreadystatechange=function(){if(4===h.readyState&&200===h.status){$log("Parsing "+c+"...");var i=b(h.responseText);$log("Processing graph ("+i.nodes.length+" nodes & "+i.edges.length+" edges)..."),f(a,i,d,e,g)}},h.onerror=function(){onRetrieval(!1)},h.send()}function f(a,b,c,d,e){if(b){c(b);var f=b.nodes,h=b.edges;if(a._graph.clear(),e){var i=0,j=e,k=0,l=e,m=g(b);a._camera.loadConfig({x:m.cx,y:m.cy,zoom:Math.min(a._camera.width/m.width,a._camera.height/m.height),angle:0});var n=function b(){i<f.length?(a._graph.addNodes(f.slice(i,j)),i=j,j+=e,a._render.atNextFrame(b)):k<h.length?(a._graph.addEdges(h.slice(k,l)),k=l,l+=e,a._render.atNextFrame(b)):(a._render.atNextFrame(function(){return $log("Done.")}),d(!0))};n()}else a._graph.init(f,h),a._render.atNextFrame(function(){return $log("Done.")}),a._locate.center(),d(!0)}else d&&d(!1)}function g(a){for(var b=a.nodes,c=1/0,d=1/0,e=-(1/0),f=-(1/0),g=0;g<b.length;++g){var h=b[g],i=h.x,j=h.y,k=h.size;c=Math.min(c,i-k),d=Math.min(d,j-k),e=Math.max(e,i+k),f=Math.max(f,j+k)}return{minX:c,minY:d,maxX:e,maxY:f,cx:c+(e-c)/2,cy:d+(f-d)/2,width:e-c,height:f-d}}var Ogma=$global.Ogma;b.dependencies=["graph","locate","drawing"],b.settings={webWorker:{default:!0,type:"boolean"},defaultBatchSize:{default:0,type:"positive"}};var h=function(){},i={};b.onStart=function(a,b){"string"==typeof b.graph&&(b.graph.search(".gexf")!==-1?a.from("gexf",b.graph):b.graph.search(".json")!==-1&&a.from("json",b.graph))},b.prototype.from=function(a,b,c){var f=this;c="function"==typeof c?{onEnd:c}:c||i;var g=this,j=c.onEnd||h,k=c.preProcess||h,l=$or(c.batchSize,g._settings.defaultBatchSize);return new Promise(function(c,h){var i=Ogma.imports[a];if(!i)throw new Error(a+" is not a valid importer.");var m=function(a){j(a),a?c():h()};f._settings.webWorker&&i.webWorkerCompatible?d(g,i,b,k,m,l):e(g,i,b,k,m,l)})},b.prototype.parseFile=function(a,b,c){var d=Ogma.imports[a];if(!d)throw new Error(a+" is not a valid importer.");var e=new XMLHttpRequest;e.open("GET",b,!0),e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){var a=d(e.responseText);c(a)}},e.onerror=function(){c(null)},e.send()},Ogma.modules.imports=b}.call(),function(a){function b(a){this._graph=a.graph,this._nodeProps=Object.create(null),this._edgeProps=Object.create(null);var b=this;a.events.bind({"graph.addNodes":function(a){c(b,!0,a)},"graph.addEdges":function(a){c(b,!1,a)},"graph.nodeDataChange":function(a){c(b,!0,a)},"graph.edgeDataChange":function(a){c(b,!1,a)},"graph.clear":function(){c(b,!0),c(b,!1)}})}function c(a,b,c){for(var e=a[b?"_nodeProps":"_edgeProps"],f=Object.keys(e),g=0;g<f.length;++g){var h=f[g],i=e[h];i&&d(i,h,c)}}function d(b,c,d,e){var f=d?b.min:a,g=d?b.max:a;if(d)for(var h=d.length,i=0;i<h;++i){var j=d[i],k=+Ogma.utils.strToObjectRef(j,c);isNaN(k)||((f===a||k<f)&&(f=k),(g===a||k>g)&&(g=k))}if(!e&&(f!==b.min||g!==b.max))for(var l=b.watchers.slice(),m=0;m<l.length;++m)l[m](f,g);b.min=f,b.max=g}function e(a,b,c,e){var f=a[b?"_nodeProps":"_edgeProps"],g=a._graph[b?"nodes":"edges"],h=f[c];return f[c]||(h={watchers:[]},f[c]=h),h.watchers.push(e),d(h,c,g,!0),{min:h.min,max:h.max,kill:function(){return a.stopWatchProperty(b,c,e),null}}}var Ogma=$global.Ogma;b.dependencies=["graph"],b.prototype.watchNodeProperty=function(a,b){return this.watchProperty(!0,a,b)},b.prototype.watchEdgeProperty=function(a,b){return this.watchProperty(!1,a,b)},b.prototype.watchProperty=function(a,b,c){return e(this,a,b,c)},b.prototype.stopWatchNodeProperty=function(a,b){return this.stopWatchProperty(!0,a,b)},b.prototype.stopWatchEdgeProperty=function(a,b){return this.stopWatchProperty(!1,a,b)},b.prototype.getPropertyBoundaries=function(a,b){var c=this[a?"_nodeProps":"_edgeProps"][b]||{};return{min:c.min||0,max:c.max||0}},b.prototype.stopWatchProperty=function(b,c,d){var e=this[b?"_nodeProps":"_edgeProps"][c];if(e){var f=e.watchers.indexOf(d);f!==-1&&(e.watchers.splice(f,1),0===e.watchers.length&&(this[b?"_nodeProps":"_edgeProps"][c]=a))}},Ogma.modules.watcher=b}.call(),function(a){function b(b){var e=this,f=this;this._render=b.render,this._mouse=b.mouse,this._camera=b.camera,this._exclusives=b.exclusives,this._events=b.events.create("tooltip.",["show","hide"]),this._settings=b.settings.get("tooltip",!0),this.position={x:0,y:0},this._screen=this._render.screen,this._container=null,this._tooltip=null,this._elt=a,this._hover=!1,this._handlers={};var g=Ogma.utils.createDelayer();this._show=this._exclusives.create({priority:$C("interaction","showTooltip"),check:function(b,c,d,e,g){return f._handlers[b]?!(f._elt===c&&!g)||(f._elt=a,!1):(g||(f._elt=a),!1)},handler:function(b,d,e,h,i){g.fire(function(){var g=f._handlers[b],j=d?g(d,e,h):g(e,h);c(f,j,e,h),f._hover=i,f._elt=i?a:d},i?f._settings.hoverDelay:0)}});var h=function(){return f._elt=a,!1},i=function(a){g.stop(),f._tooltip&&f._hover===a&&d(f)};b.events.bind({"render.setContainer":function(a){h(),f._container=a},"captor.clickNode":function(a,b,c){return e._show("clickNode",a,b,c,!1)},"captor.rightClickNode":function(a,b,c){return e._show("rightClickNode",a,b,c,!1)},"captor.doubleClickNode":function(a,b,c){return e._show("doubleClickNode",a,b,c,!1)},"captor.hoverNode":function(a,b,c){return e._show("hoverNode",a,b,c,!0)},"captor.clickEdge":function(a,b,c){return e._show("clickEdge",a,b,c,!1)},"captor.rightClickEdge":function(a,b,c){return e._show("rightClickEdge",a,b,c,!1)},"captor.doubleClickEdge":function(a,b,c){return e._show("doubleClickEdge",a,b,c,!1)},"captor.hoverEdge":function(a,b,c){return e._show("hoverEdge",a,b,c,!0)},"captor.clickBackground":function(a,b){return e._show("clickBackground",null,a,b,!1)},"captor.rightClickBackground":function(a,b){return e._show("rightClickBackground",null,a,b,!1)},"captor.doubleClickBackground":function(a,b){return e._show("doubleClickBackground",null,a,b,!1)},"captor.down captor.rightDown":function(){return i(!1)},"captor.unhoverNode captor.unhoverEdge":function(){return i(!0)},"captor.startDrag":h,"captor.startRightDrag":h,"graph.clear":h})}function c(a,b,c,e){d(a);var g=a._settings.className,h=a._settings.position,i=f[h];"string"==typeof b?(a._tooltip=document.createElement("div"),a._tooltip.innerHTML=b):a._tooltip=b,a._container.appendChild(a._tooltip),a._tooltip.style.position="absolute",a._tooltip.style.visibility="hidden",g&&(a._tooltip.className+=a._tooltip.className?" "+g:g),a._tooltip.addEventListener("mousemove",function(a){return a.stopPropagation()}),a._tooltip.addEventListener("mousedown",function(a){return a.stopPropagation()}),a._tooltip.addEventListener("mouseup",function(a){return a.stopPropagation()}),a._tooltip.addEventListener("touchstart",function(a){return a.stopPropagation()}),a._tooltip.addEventListener("touchend",function(a){return a.stopPropagation()}),a._timeout=setTimeout(function(){var b=a._tooltip.offsetWidth,d=a._tooltip.offsetHeight,f=c+i.x*b,g=e+i.y*d;if(a._settings.autoAdjust){var j=0;f<0?f=0:f+b>a._screen.width?f=a._screen.width-b:j+=1,g<0?g=0:g+d>a._screen.height?g=a._screen.height-d:j+=1,2===j&&(a._tooltip.className+=a._tooltip.className?" "+h:h)}else a._tooltip.className+=a._tooltip.className?" "+h:h;a.position.x=f,a.position.y=g,a._tooltip.style.visibility="visible",a._tooltip.style.left=f+"px",a._tooltip.style.top=g+"px",a._timeout=null,a._events.show(a._tooltip)},0)}function d(a,b){b=b||0,a._timeout&&(clearTimeout(a._timeout),a._timeout=null);var c=function(){if(a._tooltip&&a._container){try{a._container.removeChild(a._tooltip)}catch(a){}a._events.hide(a._tooltip)}a._tooltip=null};0===b?c():setTimeout(c,b)}function e(a,b,c){a._handlers[b]=c}var Ogma=$global.Ogma,f={top:{x:-.5,y:-1},bottom:{x:-.5,y:0},left:{x:-1,y:-.5},right:{x:0,y:-.5},center:{x:-.5,y:-.5}},g=Object.keys(f);b.settings={position:{default:"top",values:g},autoAdjust:{default:!0,type:"boolean"},hoverDelay:{default:100,type:"positive"},className:{default:null,type:"string",values:[null]}},b.dependencies=["render","mouse","camera","captor"];b.prototype.onNodeHover=function(a){
e(this,"hoverNode",a)},b.prototype.onEdgeHover=function(a){e(this,"hoverEdge",a)},b.prototype.onNodeClick=function(a){e(this,"clickNode",a)},b.prototype.onEdgeClick=function(a){e(this,"clickEdge",a)},b.prototype.onBackgroundClick=function(a){e(this,"clickBackground",a)},b.prototype.onNodeRightClick=function(a){e(this,"rightClickNode",a)},b.prototype.onEdgeRightClick=function(a){e(this,"rightClickEdge",a)},b.prototype.onBackgroundRightClick=function(a){e(this,"rightClickBackground",a)},b.prototype.onNodeDoubleClick=function(a){e(this,"doubleClickNode",a)},b.prototype.onEdgeDoubleClick=function(a){e(this,"doubleClickEdge",a)},b.prototype.onBackgroundDoubleClick=function(a){e(this,"doubleClickBackground",a)},b.prototype.hide=function(){d(this)},b.prototype.isShown=function(){return!!this._tooltip},Ogma.modules.tooltip=b}.call(),function(){function a(a,e){var f=this;this._moduleList=a.modules.slice(),this._events=a.events.create("settings.",this._moduleList),this._settings=Object.create(null),this._toUpdate=Object.create(null);var g=e.settings||{};Ogma.utils.forEach(g,function(a,c){return b(f,c,k)},this),this._moduleList.forEach(function(a){var b=g[a];c(a,b,k),this._settings[a]=d(a,b,null,k)},this)}function b(a,b,c){if(c=c||"",a._moduleList.indexOf(b)===-1)throw new Error(c+'unknown module name "'+b+'". List of available modules:\n* '+a._moduleList.join("\n* "))}function c(a,b,c){if(b){c=c||"";var d=Object.keys(Ogma.modules[a].settings||{});Ogma.utils.forEach(b,function(b,e){if(d.indexOf(e)===-1)throw new Error(c+'unknown setting name "'+e+'" for module "'+a+'". List of available settings:\n* '+d.join("\n* "))})}}function d(a,b,c,d){var f=Ogma.modules[a].settings;return b=b||{},c=c||{},d=d||"",f&&Ogma.utils.forEach(f,function(b,d){if(!$isObj(b))throw new TypeError("setting definition "+b+" (setting "+d+", module "+a+") should be an object");c[d]=b.default}),Ogma.utils.forEach(b,function(a,b){c[b]=a}),Ogma.utils.forEach(c,function(b,c){e(a,c,b,d)}),c}function e(a,b,c,d){var e=Ogma.modules[a].settings[b],f=Ogma.types.check(c,e);if(f)throw new TypeError(d+'module "'+a+'": setting "'+b+'": invalid value '+c+", "+f+".")}function f(a,b,c){c=c||{},i(a,b,c);var d={},f=[],g=a._settings[b];return Ogma.utils.forEach(c,function(a,c){e(b,c,a);var h=g[c];d[c]=h,g[c]=a,h!==a&&f.push(c)}),j(a,b),a._events[b](f),d}function g(a,b,c){c=c||{},i(a,b,c);for(var d=Ogma.utils.shallowCopy(c),e=Ogma.modules[b].settings||{},g=Object.keys(e),j=0;j<g.length;++j){var k=g[j];d.hasOwnProperty(k)||(d[k]=h(b,k))}f(a,b,d)}function h(a,b){var c=Ogma.modules[a].settings[b];return $isObj(c)?c.default:c}function i(a,d,e){b(a,d),c(d,e)}function j(a,b){var c=a._toUpdate[b];if(c){var d=a._settings[b],e=Object.keys(d);c.forEach(function(a){for(var b=0,c=e.length;b<c;++b){var f=e[b];a[f]=d[f]}})}}var Ogma=$global.Ogma,k="at settings declaration: ";a.dependencies=["events"],a.onClear=function(a){a._toUpdate=Object.create(null)},a.prototype.get=function(a,b){if(!this._settings[a])throw new Error("module "+a+" does not exist");var c=Ogma.utils.deepCopy(this._settings[a]||{});return b&&(this._toUpdate[a]||(this._toUpdate[a]=[]),this._toUpdate[a].push(c)),c},a.prototype.update=function(a,b){b=b||{},"object"===("undefined"==typeof a?"undefined":_typeof(a))?Ogma.utils.forEach(a,function(a,b){f(this,b,a)},this):f(this,a,b)},a.prototype.reset=function(a,b){b=b||{},"object"===("undefined"==typeof a?"undefined":_typeof(a))?Ogma.utils.forEach(a,function(a,b){g(this,b,a)},this):g(this,a,b)},Ogma.modules.settings=a}.call(),function(){function a(a){for(var b=a._nodeAttributes.degreeChanged,c=a._nodeAttributes.ref,d=b.length,e=[],f=0;f<d;++f)b[f]&&(e.push(c[f]),b[f]=0);a._events.change(e)}function b(a,b,c){var d=a._parallelEdges[b];d?d.push(c):a._parallelEdges[b]=[c]}function c(a,b,c){var d=a._parallelEdges[b];1===d.length?a._parallelEdges[b]=void 0:d.splice(d.indexOf(c),1)}function d(a,b){return a.__index+"->"+b.__index}function e(a,b){var c,d;return a.__index<b.__index?(c=a.__index,d=b.__index):(c=b.__index,d=a.__index),c+"<->"+d}function f(a,b,c,d,e){var g=a._graph.nodeAttributes,h=g[o[d]][b.__index];if(1===e)for(var i=0;i<h._indexSet.size;++i)c.add(h._elementAttributes.ref[h._indexSet.array[i]]);else for(i=0;i<h._indexSet.size;++i){var j=h._elementAttributes.ref[h._indexSet.array[i]];if(c.add(j)){var k=j.__source===b?j.__target:j.__source;f(a,k,c,d,e-1)}}}function g(a,b,c,d,e){var f=a._graph.nodeAttributes,h=f[p[d]][b.__index];if(1===e)for(var i=0;i<h._indexSet.size;++i)c.add(h._elementAttributes.ref[h._indexSet.array[i]]);else for(i=0;i<h._indexSet.size;++i){var j=h._elementAttributes.ref[h._indexSet.array[i]];j!==b&&c.add(j)&&g(a,j,c,d,e-1)}}function h(a,b,c,d){var e,f=b?a.nodeAttributes.adjacentOutEdges:a.nodeAttributes.adjacentEdges,g=a.nodeAttributes.exists,h=new Array,i=1,j=!1,k=!1;"number"==typeof d?(j=!0,i=d):"function"==typeof d?k=!0:"string"!=typeof d&&(d=d?"size":null);for(var l=0,m=f.length;l<m;l++){var n,o,p,q,r,s=f[l],t=a._elts.nodes.attributes.ref;if(s&&g[l]){r=s._indexSet.size,n=c?new Array(r):new Uint32Array(r),o=new Array(r);for(var u=0;u<r;u++)q=s._elementAttributes.ref[s._indexSet.array[u]],p=c?b?q.target:l===q.__sourceIndex?q.target:q.source:b?q.__targetIndex:l===q.__sourceIndex?q.__targetIndex:q.__sourceIndex,n[u]=p,d&&(j?o[u]=i:k?o[u]=d(t[q.__sourceIndex],t[q.__targetIndex]):o[u]=q[d]||i)}else n=[],o=[];e=Object.create(null),e.nodes=n,d&&(e.weights=o),!g[l]&&c||h.push(e)}return h}function i(a,b,c,d){for(var e=a.getAdjacencyTable(!0,!0,null),f=a._graph,g=f.nodeAttributes,h=g.exists,i=f._elts.nodes.getIndexList(),j=i.length,k=new Int8Array(j),l=[],m=0;m<j;m++){var n=i[m];if(!k[m]&&h[m]){for(var o=n,p=[n],q=[],r=!1;0!==p.length;)o=p.pop(),!k[o]&&h[o]&&(p.push.apply(p,e[o].nodes),k[o]=1,q.push(o),o===c&&(r=!0));if(q.length>0){if(b?d&&(q=q.map(function(a){return g.id[a]})):q=q.map(function(a){return g.ref[a]}),r)return q;l.push(q)}}}return l}var Ogma=$global.Ogma,j=[],k=["both","out","in"],l=["nodes","edges"],m={type:"nodes"},n={type:"edges"},o={both:"adjacentEdges",in:"adjacentInEdges",out:"adjacentOutEdges"},p={both:"adjacentNodes",in:"adjacentInNodes",out:"adjacentOutNodes"},q=function(){function o(a){_classCallCheck(this,o),this._graph=a.graph,this._events=a.events.create("topology.",["change"]),this._nodeAttributes=this._graph.nodeAttributes,this._edgeAttributes=this._graph.edgeAttributes,this._graph.addNodeAttributes({adjacentNodes:Array,adjacentInNodes:Array,adjacentOutNodes:Array,adjacentEdges:Array,adjacentInEdges:Array,adjacentOutEdges:Array,degreeChanged:Int8Array}),this._parallelEdges={};var b=this._nodeAttributes,c=this;this._graph.addNodeReadOnlyProperty("degree",function(a){return b.adjacentNodes[a.__index]._indexSet.size}),this._graph.addNodeReadOnlyProperty("inDegree",function(a){return b.adjacentInNodes[a.__index]._indexSet.size}),this._graph.addNodeReadOnlyProperty("outDegree",function(a){return b.adjacentOutNodes[a.__index]._indexSet.size}),a.events.bind({"graph.clear":function(){c._parallelEdges={}},"graph.addNodes":function(a){for(var b=c._graph,d=c._nodeAttributes,e=d.degreeChanged,f=d.adjacentNodes,g=d.adjacentInNodes,h=d.adjacentOutNodes,i=d.adjacentEdges,j=d.adjacentInEdges,k=d.adjacentOutEdges,l=a.length,m=0;m<l;++m){var n=a[m],o=n.__index;f[o]=b.createNodeSet(),g[o]=b.createNodeSet(),h[o]=b.createNodeSet(),i[o]=b.createEdgeSet(),j[o]=b.createEdgeSet(),k[o]=b.createEdgeSet(),e[o]=0}},"graph.addEdges":function(a){c.onEdgesAdded(a)},"graph.removeEdges":function(a){c.onEdgesRemoved(a)}})}return _createClass(o,[{key:"onEdgesAdded",value:function(c,f){for(var g=this._nodeAttributes,h=g.adjacentNodes,i=g.adjacentInNodes,j=g.adjacentOutNodes,k=g.adjacentEdges,l=g.adjacentInEdges,m=g.adjacentOutEdges,n=g.degreeChanged,o=!1,p=c.length,q=0;q<p;++q){var r=c[q],s=r.__source,t=r.__target,u=s.__index,v=t.__index,w=h[u],x=h[v],y=k[u],z=k[v];y.add(r),z.add(r),w.add(t)&&(x.add(s),n[u]=1,n[v]=1,o=!0),i[v].add(s),j[u].add(t),l[v].add(r),m[u].add(r);var A=d(s,t),B=e(s,t);b(this,A,r),b(this,B,r)}o&&!f&&a(this)}},{key:"onEdgesRemoved",value:function(b,f){for(var g=this._nodeAttributes,h=g.adjacentNodes,i=g.adjacentInNodes,j=g.adjacentOutNodes,k=g.adjacentEdges,l=g.adjacentInEdges,m=g.adjacentOutEdges,n=g.degreeChanged,o=!1,p=b.length,q=0;q<p;++q){var r=b[q],s=r.__source,t=r.__target,u=s.__index,v=t.__index,w=h[u],x=h[v],y=k[u],z=k[v];y.remove(r),z.remove(r),l[v].remove(r),m[u].remove(r);var A=d(s,t),B=e(s,t);c(this,A,r),c(this,B,r),this._parallelEdges[A]||(i[v].remove(s),j[u].remove(t)),this._parallelEdges[B]||(w.remove(t),x.remove(s),o=!0,n[u]=1,n[v]=1)}o&&!f&&a(this)}},{key:"edgeDirection",value:function(a){return d(a.__source,a.__target)}},{key:"edgeBiDirection",value:function(a){return e(a.__source,a.__target)}},{key:"getEdgesMatchingDirection",value:function(a,b){var c=this._parallelEdges[a]||j;if(b){for(var d=[],e=0;e<c.length;++e){var f=c[e];b(f)&&d.push(f)}return d}return c.slice()}},{key:"getAllEdgeDirections",value:function(){return Object.keys(this._parallelEdges)}},{key:"getAdjacentNodes",value:function(a,b){return b?(m.depth=b.depth,m.direction=b.direction,m.includeSources=b.includeSources):(m.depth=void 0,m.direction=void 0,m.includeSources=void 0),this.getAdjacentElements(a,m)}},{key:"getAdjacentEdges",value:function(a,b){return b?(n.depth=b.depth,n.direction=b.direction):(n.depth=void 0,n.direction=void 0),this.getAdjacentElements(a,n)}},{key:"getAdjacentElements",value:function(a,b){if("undefined"==typeof a)throw new Error('topology.getAdjacentElements: argument "sourceNodes" must not be undefined');b=b||{};var c=b.type,d=b.direction,e=b.includeSources,h=b.depth;if(void 0===c&&(c="nodes"),void 0===d&&(d="both"),void 0===h&&(h=1),void 0===e&&(e=!1),l.indexOf(c)===-1)throw new Error("topology.getAdjacentElements: invalid type "+JSON.stringify(c)+", expected one of the following values: "+JSON.stringify(l));if(k.indexOf(d)===-1)throw new Error("topology.getAdjacentElements: invalid direction "+JSON.stringify(d)+", expected one of the following values: "+JSON.stringify(k));if("number"!=typeof h||h<1||h%1!==0)throw new Error("topology.getAdjacentElements: invalid depth "+JSON.stringify(h)+", expected a integer > 1");if("boolean"!=typeof e)throw new Error("topology.getAdjacentElements: invalid includeSources option "+JSON.stringify(e)+", expected a boolean");a instanceof Array||(a=[a]),a=a.map(function(a){return void 0!==a.id?a.id:a}),a=this._graph.getNodeList(a);var i=this._graph.createElementSet("nodes"===c);if("nodes"===c)for(var j=0;j<a.length;++j)g(this,a[j],i,d,h);else for(j=0;j<a.length;++j)f(this,a[j],i,d,h);if("nodes"===c)if(e)for(j=0;j<a.length;++j)i.add(a[j]);else for(j=0;j<a.length;++j)i.remove(a[j]);return i.slice()}},{key:"getAdjacencyTable",value:function(a,b,c){return h(this._graph,!a,!b,c)}},{key:"getConnectedComponents",value:function(a,b){return i(this,a,-1,!b)}},{key:"getConnectedComponentByNode",value:function(a,b,c){if(void 0===a)throw new Error("topology.getConnectedComponentByNode: Node has to be defined");var d=void 0===a.id?a:a.id;if(a=this._graph.getNode(d),!a)throw new Error('topology.getConnectedComponentByNode: Cannot find node "'+d+'"');return i(this,b,a.__index,!c)}}]),o}();q.prototype.directionId=d,q.prototype.biDirectionId=e,q.dependencies=["graph","events"],Ogma.modules.topology=q}(),function(a){function b(b){this._graph=b.graph,this._renderer=b.render,this._drawing=b.drawing,this._shapes=b.shapes,this._settings=b.settings.get("outlines"),this._shapeSettings=b.settings.get("shapes"),this._drawing.addEdgeSubLayer("edgeOutlines",{transparency:!0,level:$C("subLayer","edgeOutlines"),symbolicSizeThreshold:this._settings.edgeThreshold}),this._drawing.addNodeSubLayer("nodeOutlines",{transparency:!0,level:$C("subLayer","nodeOutlines"),symbolicSizeThreshold:this._settings.nodeThreshold===a?this._shapeSettings.nodeInnerStrokeThreshold:this._settings.nodeThreshold}),this._drawing.addCommonVisualProperty("outline",{type:"boolean"}),this._drawing.addCommonVisualComponent("outlineComponent");var e=this;b.events.bind({"drawing.nodes":function(a){return c(e,a)},"drawing.edges":function(a){return d(e,a)},"settings.shapes":function(){e._shapeSettings=b.settings.get("shapes"),e._drawing.redrawEverything()},"settings.outlines":function(){e._settings=b.settings.get("outlines"),e._drawing.redrawEverything()}})}function c(a,b){var c=b.length,d=a._renderer,f=a._drawing,g=a._graph.nodeAttributes,h=g.shape,i=Ogma.shapes.nodes,j=a._shapeSettings.defaultNodeShape,k=g.outlineComponent,l=g.size,m=g.x,n=g.y,o=a._settings.nodeRelativeOffsetY,p=a._settings.nodeAbsoluteOffsetY,q=a._settings.nodeRelativeSize,r=a._settings.nodeAbsoluteSize,s=a._settings.color,t=g.depth,u=a._shapeSettings.nodeOuterStrokeWidth/2;e.oy=p+u;for(var v=0;v<c;++v){var w=b[v],x=w.__index,y=h[x]||j,z=i[y],A=f.getElementProperty(w,"outline"),B=!!f.getElementProperty(w,"nodeOuterStrokeColor");if(A){var C=l[x],D=B?u:0;e.zy=o*C,e.oy=p+D,d.setOffset(e),k[x]=z.draw(d,k[x],m[x],n[x],C*q,r+D,s,"nodeOutlines",t[x],C)}else k[x]=d.delete(k[x])}d.setOffset(null)}function d(a,b){var c=b.length,d=a._renderer,f=a._drawing,g=a._graph.edgeAttributes,h=a._graph.nodeAttributes,i=g.shape,j=Ogma.shapes.edges,k=a._shapeSettings.defaultEdgeShape,l=g.outlineComponent,m=g.size,n=h.x,o=h.y,p=h.size,q=g.source,r=g.target,s=g.curvature,t=a._settings.edgeRelativeOffsetY,u=a._settings.edgeAbsoluteOffsetY,v=a._settings.edgeRelativeSize,w=a._settings.edgeAbsoluteSize,x=a._settings.color,y=g.depth;e.oy=u;for(var z=0;z<c;++z){var A=b[z],B=A.__index,C=i[B]||k,D=j[C],E=f.getElementProperty(A,"outline");if(E){var F=q[B],G=r[B],H=m[B];e.zy=t*H,d.setOffset(e),l[B]=a._shapes.drawEdgeShape(d,l[B],D,F,G,n[F],o[F],n[G],o[G],H*v,w,s[B],p[F],p[G],x,"edgeOutlines",y[B],H)}else l[B]=d.delete(l[B])}d.setOffset(null)}var Ogma=$global.Ogma;b.settings={nodeThreshold:{default:a,type:"positive",values:[a]},edgeThreshold:{default:5,type:"positive"},nodeRelativeSize:{default:1.1,type:"positive"},nodeAbsoluteSize:{default:0,type:"positive"},nodeRelativeOffsetY:{default:.15,type:"positive"},nodeAbsoluteOffsetY:{default:1,type:"positive"},edgeRelativeSize:{default:1.1,type:"positive"},edgeAbsoluteSize:{default:2,type:"positive"},edgeRelativeOffsetY:{default:.15,type:"positive"},edgeAbsoluteOffsetY:{default:1,type:"positive"},color:{default:"rgba(0, 0, 0, 0.36)",type:"color"}},b.dependencies=["graph","render","shapes","drawing","icons"];var e=new Ogma.utils.Position;Ogma.modules.outlines=b}.call(),function(a){function b(a){var b=this;this._events=a.events.create("keyboard.",["keyUp","keyDown"]),this._binds=[],this._pressed=[],this._onKeyDown=function(a){var d=a.keyCode||a.which,e=b._binds[d];if(b._pressed[d]=!0,e)for(var f=0;f<e.length;++f){for(var g=e[f],h=!0,i=0;i<g.keys.length;++i){for(var j=!1,k=g.keys[i],l=0;l<k.length;++l)b._pressed[k[l]]&&(j=!0);j||(h=!1)}h&&g.handler()}b._events.keyDown(c[d],d)},this._onKeyUp=function(a){var d=a.keyCode||a.which;b._pressed[d]=!1,b._events.keyDown(c[d],d)},"undefined"!=typeof window&&(window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp))}var Ogma=$global.Ogma,c={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",16:"shift",17:"ctrl",18:"alt",32:"space",224:"ctrl",91:"ctrl",93:"ctrl"},d={};!function(){var a=Object.keys(c);a.forEach(function(a){var b=c[a];d[b]||(d[b]=[]),d[b].push(a)})}(),b.dependencies=["render"],b.onKill=function(a){"undefined"!=typeof window&&(window.removeEventListener("keydown",a._onKeyDown),window.removeEventListener("keyup",a._onKeyUp))},b.prototype.bind=function(a,b){var c=this;if("number"==typeof a)a=[a];else if("string"==typeof a)a=a.split(" ");else{if(!Array.isArray(a))throw new TypeError(a+" is not a number, string or array");if(0===a.length)throw new Error("the array should contain at least one element")}var e=[];a.forEach(function(a){if("number"==typeof a)e.push([a]);else{if("string"!=typeof a)throw new TypeError(a+" is not a valid key identifier");var b=d[a];if(!b)throw new Error(a+" is not a valid key identifier");e.push(b)}});var f=e.pop(),g={keys:e,handler:b};f.forEach(function(a){c._binds[a]||(c._binds[a]=[]),c._binds[a].push(g)})},b.prototype.isPressed=function(a){if("number"==typeof a)return this._pressed[a];if("string"==typeof a){var b=d[a];if(b)for(var c=0;c<b.length;++c)if(this._pressed[b[c]])return!0}return!1},Ogma.modules.keyboard=b}.call(),function(a){function b(a){this._keyboard=a.keyboard,this._camera=a.camera,this._mouse=a.mouse,this._graph=a.graph,this._drawing=a.drawing,this._shapes=a.shapes,this._render=a.render,this._hover=a.hover,this._texts=a.texts,this._settings=a.settings.get("selection",!0);var b=this;this._selectedNodes=[],this._selectedEdges=[],this._events=a.events.create("selection.",["nodesSelected","nodesUnselected","edgesSelected","edgesUnselected"]),this._graph.addNodeAttributes({highlightCount:Int16Array}),this._graph.addCommonProperty("active",{values:[!0,!1]},!1,function(a,c,d){d&&i(b,a,c,!0)}),this._nodeAttributes=this._graph.nodeAttributes,this._edgeAttributes=this._graph.edgeAttributes,this._drawing.addLayer("active",{level:$C("layer","active"),disableThreshold:!0},c(this)),this._drawing.addLayer("highlight",{level:$C("layer","highlight"),disableThreshold:!0},c(this)),this._selectElement=a.exclusives.create({priority:$C("interaction","selection"),check:function(){return b._settings.manual},handler:function(a){var c=a,d=c.isNode,e=d?b._selectedNodes:b._selectedEdges,i=b._settings.multiSelectionKey&&b._keyboard.isPressed(b._settings.multiSelectionKey);f(b,!d),i?e.indexOf(c)===-1?g(b,c):h(b,c):1!==e.length||e.indexOf(c)===-1?(f(b,d),g(b,c)):f(b,d)}}),a.events.bind({"settings.selection":function(){b._drawing.editLayer("active",c(b)),b._drawing.editLayer("highlight",c(b)),b._drawing.redraw(b._selectedNodes),b._drawing.redraw(b._selectedEdges)},"graph.clear":function(){b._selectedNodes=[],b._selectedEdges=[]},"graph.addNodes":function(a){for(var c=b._nodeAttributes.highlightCount,d=b._nodeAttributes.active,e=a.length,f=0;f<e;++f){var g=a[f].__index;c[g]=0,d[g]=!1}},"graph.addEdges":function(a){for(var c=b._edgeAttributes.active,d=a.length,e=0;e<d;++e){var f=a[e].__index;c[f]=!1}},"graph.removeNodes":function(a){for(var c=b._nodeAttributes.active,d=a.length,e=0;e<d;++e){var f=a[e];c[f.__index]&&$rm(b._selectedNodes,f)}},"graph.removeEdges":function(a){for(var c=b._edgeAttributes.active,d=a.length,f=0;f<d;++f){var g=a[f],h=g.__index;c[h]&&($rm(b._selectedEdges,g),e(b,g.__source),e(b,g.__target))}},"captor.clickNode":function(a){return b._selectElement(a)},"captor.clickEdge":function(a){return b._selectElement(a)}})}function c(a){return{nodeFontStyle:a._settings.nodeTextFontStyle,nodeFontColor:a._settings.nodeTextFontColor,nodeTextBackgroundColor:a._settings.nodeTextBackgroundColor,edgeFontStyle:a._settings.edgeTextFontStyle,edgeFontColor:a._settings.edgeTextFontColor,edgeTextBackgroundColor:a._settings.edgeTextBackgroundColor,nodeOuterStrokeColor:a._settings.nodeOuterStrokeColor,edgeOuterStrokeColor:a._settings.edgeColor,outline:a._settings.outline}}function d(a,b){var c=b.__index;a._nodeAttributes.highlightCount[c]+=1,1===a._nodeAttributes.highlightCount[c]&&a._drawing.putNodeOnLayer(b,"highlight")}function e(a,b){var c=b.__index,d=a._nodeAttributes.highlightCount[c];d>0&&(a._nodeAttributes.highlightCount[c]-=1,1===d&&a._drawing.removeNodeFromLayer(b,"highlight"))}function f(a,b){var c=b?"_selectedNodes":"_selectedEdges";h(a,a[c]),a[c]=[]}function g(a,b,c){if(!(b instanceof Array))return g(a,[b],c);if(b.length){for(var e=b[0].isNode,f=e?a._selectedNodes:a._selectedEdges,h=a[e?"_nodeAttributes":"_edgeAttributes"],i=h.active,j=[],k=b.length,l=0;l<k;++l){var m=b[l],n=m.__index;i[n]&&!c||(f.push(m),i[n]=!0,a._drawing.putElementOnLayer(m,"active"),j.push(m),e||(d(a,$source(m)),d(a,$target(m))))}j.length&&a._events[e?"nodesSelected":"edgesSelected"](j)}}function h(a,b,c,d){if(!(b instanceof Array))return h(a,[b],c,d);if(b.length){for(var f=b[0].isNode,g=f?a._selectedNodes:a._selectedEdges,i=a[f?"_nodeAttributes":"_edgeAttributes"],j=i.active,k=[],l=0,m=b.length;l<m;++l){var n=b[l],o=n.__index;(j[o]||d)&&(j[o]=!1,k.push(n),a._drawing.removeElementFromLayer(n,"active"),f||(e(a,$source(n)),e(a,$target(n))))}if(!c)for(l=0,m=k.length;l<m;++l)g.splice(g.indexOf(k[l]),1);k.length&&a._events[f?"nodesUnselected":"edgesUnselected"](k)}}function i(a,b,c,d){c?g(a,b,d):h(a,b,!1,d)}function j(a,b){return a[b?"_selectedNodes":"_selectedEdges"].slice()}function k(a,b,c){return a._graph.getElementList(b,c,!0)}var Ogma=$global.Ogma,l={nodeOuterStrokeColor:{default:"red",type:"color",values:["inherit",null]},edgeColor:{default:"red",type:"color",values:["inherit",null]},nodeTextFontStyle:{default:a,values:[a,"none","italic","bold"]},nodeTextFontColor:{default:a,type:"color",values:[a]},nodeTextBackgroundColor:{default:"rgb(220, 220, 220)",type:"color",values:[a,null]},edgeTextFontStyle:{default:a,values:[a,"none","italic","bold"]},edgeTextFontColor:{default:a,type:"color",values:[a]},edgeTextBackgroundColor:{default:"rgb(220, 220, 220)",type:"color",values:[a,null]},outline:{default:!0,type:"boolean"},manual:{default:!0,type:"boolean"},multiSelectionKey:{default:"ctrl",type:"string",values:[null]}};b.settings=l,b.dependencies=["keyboard","camera","mouse","graph","drawing","shapes","hover","texts","captor"],b.prototype.clear=function(a){a?"nodes"===a?f(this,!0):"edges"===a&&f(this,!1):(f(this,!1),f(this,!0))},b.prototype.addNodes=function(a){return this.dropEdges(),this.add(!0,a)},b.prototype.addEdges=function(a){return this.dropNodes(),this.add(!1,a)},b.prototype.dropNodes=function(a){return this.drop(!0,a)},b.prototype.dropEdges=function(a){return this.drop(!1,a)},b.prototype.nodes=function(){return j(this,!0)},b.prototype.edges=function(){return j(this,!1)},b.prototype.nbNodes=function(){return this._selectedNodes.length},b.prototype.nbEdges=function(){return this._selectedEdges.length},b.prototype.add=function(a,b){var c=k(this,a,b);return g(this,c),this},b.prototype.drop=function(b,c){if(c===a)f(this,b);else{var d=k(this,b,c);h(this,d)}return this},b.prototype.addNeighbors=function(){for(var a=this._graph.nodeAttributes,b=this._selectedNodes,c=[],d=0;d<b.length;++d){var e=b[d].__index,f=a.adjacentNodes[e].slice();c.push.apply(c,f)}g(this,c)},b.prototype.setEltsBy=function(a,b){for(var c=this._graph[a?"nodes":"edges"],d=[],e=0;e<c.length;++e){var h=c[e],i=b(h);i&&d.push(h)}return f(this,!0),g(this,d),this},b.prototype.setNodesBy=function(a){return this.setEltsBy(!0,a)},b.prototype.setEdgesBy=function(a){return this.setEltsBy(!1,a)},b.prototype.invertElts=function(a,b){b=b?k(this,a,b):this._graph[a?"nodes":"edges"];for(var c=this._graph.attributes(a),d=c.active,e=c.ref,f=0,g=b.length;f<g;++f){var h=b[f].__index;i(this,e[h],!d[h])}return this},b.prototype.invertNodes=function(a){return this.invertElts(!0,a)},b.prototype.invertEdges=function(a){return this.invertElts(!1,a)},Ogma.modules.selection=b}.call(),function(a){function b(a){this._graph=a.graph,this._drawing=a.drawing,this._renderer=a.render,this._drawing.addNodeSubLayer("nodePieCharts",{level:$C("subLayer","nodePieCharts"),useClipSpace:!0}),this._drawing.addNodeVisualProperty("colors",{arrayItem:{type:"string"},required:!1}),this._drawing.addNodeVisualComponent("pieChartComponent");var b=this;a.events.bind({"drawing.nodes":function(a){return c(b,a)},"settings.pieCharts":function(){return b._drawing.redrawEverything()}})}function c(a,b){for(var c=a._graph.nodeAttributes,e=a._renderer,f=c.colors,g=0,h=b.length;g<h;++g){var i=b[g].__index,j=f[i];if(j&&0!==j.length){var k=c.x[i],l=c.y[i],m=2*c.size[i],n=c.depth[i],o=e.updateComposite(c.pieChartComponent[i],j.length);if(d.reset(),1===j.length)o[0]=e.rectangle(o[0],d[0].setXY(k,l),d[1].setZXY(m/2,m/2),j[0],"nodePieCharts",n);else if(2===j.length)o[0]=e.rectangle(o[0],d[0].setXY(k,l+m/2),d[1].setZXY(m/2,m/2),j[0],"nodePieCharts",n),o[1]=e.rectangle(o[1],d[0].setXY(k,l-m/2),d[1].setZXY(m/2,m/2),j[1],"nodePieCharts",n);else{d.x=k,d.y=l;var p=2*Math.PI/j.length,q=0;d[2].zx=m,d[2].zy=0;for(var r=0;r<j.length;++r){var s=q+p,t=Math.cos(s),u=Math.sin(s);d[1].set(d[2]),d[2].zx=t*m,d[2].zy=u*m,o[r]=e.triangle(o[r],d[0],d[1],d[2],j[r],"nodePieCharts",n),q=s}}c.pieChartComponent[i]=e.composite(c.pieChartComponent[i],o)}else c.pieChartComponent[i]=e.delete(c.pieChartComponent[i])}}var Ogma=$global.Ogma;b.dependencies=["graph","drawing","render","icons","images"];var d=new Ogma.utils.PositionList(3);Ogma.modules.pieCharts=b}.call(),function(a){function b(a){this._graph=a.graph,this._batch=a.batch,this._camera=a.camera,this._screen=a.render.screen,this._drawing=a.drawing,this._drawingSettings=this._drawing._settings,this._graph.addCommonAttributes({visibleOnScreen:Int8Array});var b=this._graph.nodeAttributes,d=this._graph.edgeAttributes,e=this;this._graph.addNodeReadOnlyProperty("onScreen",function(a){return b.visibleOnScreen[a.__index]},!1),this._graph.addEdgeReadOnlyProperty("onScreen",function(a){return d.visibleOnScreen[a.__index]},!1);var f=this._batch.create(function(){c(e,!0),c(e,!1)});a.events.bind({"camera.move":function(a){a&&f()},"graph.addNodes":f,"graph.addEdges":f,"drawing.nodesVisibilityChange":f,"drawing.edgesVisibilityChange":f})}function c(a,b){var c=a._graph._elts.fetch(b),e=c.totalSize,f=c.attributes,g=f.visibleOnScreen,h=f.visible,i=f.x,j=f.y,k=f.exists,l=f.size,m=f.source,n=f.target,o=f.curvature,p=a._camera,q=p.zoom,r=a._drawingSettings.edgeClipping,s=a._drawingSettings.edgeClippingPadding/q,t=p.getAbsolutePosition(0,0),u=p.getAbsolutePosition(0,a._screen.height),v=p.getAbsolutePosition(a._screen.width,0),w=p.getAbsolutePosition(a._screen.width,a._screen.height),x=Math.min(t.x,u.x,v.x,w.x),y=Math.min(t.y,u.y,v.y,w.y),z=Math.max(t.x,u.x,v.x,w.x),A=Math.max(t.y,u.y,v.y,w.y),B=Ogma.geometry.SELF_LOOP_SIZE_MULTIPLIER;if(b)for(var C=0;C<e;++C){var D=C;if(k[D]){var E=h[D];if(E){var F=i[D],G=j[D],H=l[D],I=F-H,J=F+H,K=G-H,L=G+H;E=(x<I&&I<z||x<J&&J<z)&&(y<K&&K<A||y<L&&L<A)}g[D]=E}}else for(i=a._graph.nodeAttributes.x,j=a._graph.nodeAttributes.y,l=a._graph.nodeAttributes.size,r&&(x-=s,y-=s,z+=s,A+=s),C=0;C<e;++C)if(D=C,k[D]){if(E=h[D]){var M=m[D],N=n[D],O=i[M],P=j[M],Q=l[M],R=i[N],S=j[N],T=l[N],U=O-Q,V=O+Q,W=P-Q,X=P+Q,Y=R-T,Z=R+T,$=S-T,_=S+T;if(r)E=(x<U&&U<z||x<V&&V<z)&&(y<W&&W<A||y<X&&X<A)||(x<Y&&Y<z||x<Z&&Z<z)&&(y<$&&$<A||y<_&&_<A);else{var aa=o[D];if(M===N){var ba=B*(Q+aa);I=O-ba,J=O,K=P,L=P+ba,E=!(I>z||J<x||L<y||K>A)}else 0===aa?E=Ogma.geometry.lineIntersectRectangle(O,P,R,S,x,y,z,A):(Ogma.shapes.utils.getCurveControlPoint(O,P,R,S,aa,d),Ogma.geometry.getPointOnQuadraticCurve(.5,O,P,R,S,d.x,d.y,d),E=Ogma.geometry.lineIntersectRectangle(O,P,d.x,d.y,x,y,z,A)||Ogma.geometry.lineIntersectRectangle(d.x,d.y,R,S,x,y,z,A))}}g[D]=E}}var Ogma=$global.Ogma;b.dependencies=["drawing","graph","camera","render","batch"];var d={};Ogma.modules.visibility=b}.call(),function(){function a(a,b){this._timeout=null,this._current=null,this._started=!1,this._scheduled=[],this._priority=0,this._startFunc=null,this._ogma=a}function b(a){a._timeout||(a._timeout=setTimeout(function(){a._startFunc&&(a._startFunc(),a._startFunc=null,a._started=!0),a._scheduled&&a._scheduled(),a._scheduled=null,a._timeout=null},0))}var Ogma=$global.Ogma;a.dependencies=["events"];var c=function(){};a.prototype.create=function(a){if("function"==typeof a)a={onStart:a};else if(!$isObj(a,!0))throw new TypeError("invalid parameters "+a+": not an object");a=a||{};var d=this,e=$or(a.onStart,a.handler),f=$or(a.onProgress,c),g=$or(a.onStop,c),h=$or(a.check,function(){return!0}),i=$or(a.priority,0),j=a.evt,k=null;e=$or(e,c);var l=function(a,c,f,g,j,l,m,n){return!(!h(a,c,f,g,j,l,m,n)||d._current&&!(i>=d._priority))&&(d._current&&d._current.stop(),d._current=k,d._priority=i,d._started=!1,d._scheduled=null,d._startFunc=function(){return e(a,c,f,g,j,l,m,n)},b(d),!0)},m=function(a,b,c,e,f,h,i,j){d._current===k&&(d._started&&g(a,b,c,e,f,h,i,j),d._current=null,d._priority=0,d._started=!1,d._scheduled=null)},n=function(a,c,e,g,h,i,j,l){d._current===k&&(d._scheduled=function(){return f(a,c,e,g,h,i,j,l)},b(d))};return k=function(a,b,c,e,f,g,h,i){l(a,b,c,e,f,g,h,i)&&(d._scheduled=m)},k.start=l,k.stop=m,k.progress=n,j&&("string"==typeof j?this._ogma.on(j,k):Array.isArray(j)&&3===j.length&&(this._ogma.on(j[0],l),this._ogma.on(j[1],n),this._ogma.on(j[2],m))),k},Ogma.modules.exclusives=a}(),function(a){function b(a){this._graph=a.graph,this._topology=a.topology,this._dsl=a.dsl,this._events=a.events.create("partitions.",["update"]),this._partitionLists=$dual(Array),this._counter=Ogma.utils.createCounter(),this._graph.addCommonAttributes({partitionLists:Array});var b=this;this._clear=!1,this._onPartitionListKill=function(a){b._clear||l(b._partitionLists.fetch(a._isNode),a)},a.events.bind({"graph.addNodes":function(a){c(b,!0,a)},"graph.addEdges":function(a){c(b,!1,a)},"graph.removeNodes":function(a){d(b,!0,a)},"graph.removeEdges":function(a){d(b,!1,a)},"topology.change":function(a){e(b,!0,a)},"graph.nodeDataChange":function(a){e(b,!0,a)},"graph.edgeDataChange":function(a){e(b,!1,a)},"graph.clear":function(){b._partitionLists.nodes.forEach(function(a){return h(a)}),b._partitionLists.edges.forEach(function(a){return h(a)})}})}function c(a,b,c){for(var d=a._graph.attributes(b),e=c.length,f=d.partitionLists,g=a._partitionLists.fetch(b),h=g.length,j=0;j<e;++j){var k=c[j],l=k.__index;f[l]={}}for(var m=0;m<h;++m){var n=g[m];i(n,c)}a._events.update()}function d(b,c,d){for(var e=b._graph.attributes(c),f=d.length,g=e.partitionLists,h=b._partitionLists.fetch(c),i=h.length,k=0;k<i;++k){var l=h[k];j(l,d)}for(var m=0;m<f;++m){var n=d[m],o=n.__index;g[o]=a}b._events.update()}function e(a,b,c){for(var d=a._partitionLists.fetch(b),e=d.length,f=0;f<e;++f){var g=d[f];k(g,c)}a._events.update()}function f(a,b,c,d,e){d=d||{};var f=a._dsl.checkExpressionFormat(c);if(f)throw new Error(f);var h=new g(a._counter(),b,a._graph,a._topology,a._dsl,Ogma.utils.deepCopy(c),a._onPartitionListKill,d.onPartitionChange,d.onAdd,d.onRemove,d.onKill,d.onUpdate,e);return a._partitionLists.fetch(b).push(h),a._events.update(),h}function g(a,b,c,d,e,f,g,h,j,k,l,m,n){this._id=a,this._isNode=b,this._att=c.attributes(b),this._graph=c,this._topology=d,this._dsl=e,this._expression=f,this._depth=e.expressionDepth(f),this._triggerOnKill=g,this._ignoreUndefined=n,this._onAdd=j,this._onRemove=k,this._onChange=h,this._onUpdate=m,this._onKill=l,this.partitions=Object.create(null),i(this,this._graph[b?"nodes":"edges"],!0)}function h(a){j(a,a._graph[a._isNode?"nodes":"edges"],!0)}function i(a,b,c){var d=a._onAdd;if(d)for(var e=0,f=b.length;e<f;++e)d(b[e]);k(a,b,c)}function j(b,c,d){for(var e=c.length,f=b._att,g=f.partitionLists,h=b._id,i=b.partitions,j=b._onRemove,k=!1,m=0;m<e;++m){var n=c[m],o=n.__index,p=g[o][h],q=i[p];g[o][h]=a,q&&!d&&(l(q,n),k=!0),j&&j(n,p)}k&&b._onUpdate&&b._onUpdate(b.partitions)}function k(b,c,d){var e=b._att;if(!d&&b._isNode&&b._depth>0){var f=b._graph._elts.nodes.totalSize,g=c.slice(),h=c.length,i={depth:b._depth},j=b._topology,k=Ogma.memory.allocate(Int8Array,f);for(k.fill(0),A=0;A<h;++A){B=c[A],C=B.__index,k[C]=1;for(var m=j.getAdjacentElements(B,i),n=0,o=m.length;n<o;++n){var p=m[n],q=p.__index;k[q]||(g.push(p),k[q]=1)}}Ogma.memory.release(k),c=g}for(var r=c.length,s=b._dsl,t=b._expression,u=e.partitionLists,v=b._id,w=b.partitions,x=b._onChange,y=!1,z=b._ignoreUndefined,A=0;A<r;++A){var B=c[A],C=B.__index,D=""+s.computeExpression(B,t,z),E=u[C][v],F=w[D],G=w[E];F||(F=[],w[D]=F,y=!0),D!==E&&(y=!0,F.push(B),E!==a&&G&&l(G,B),u[C][v]=D,x&&x(B,D,E))}b._onUpdate&&(y||d)&&b._onUpdate(b.partitions)}function l(a,b){var c=a.indexOf(b);a.splice(c,1)}var Ogma=$global.Ogma;b.dependencies=["graph","topology","dsl","events"],b.onClear=function(a){a._clear=!0,a._partitionLists.nodes.forEach(function(a){
return a.kill()}),a._partitionLists.edges.forEach(function(a){return a.kill()}),a._clear=!1,a._partitionLists=$dual(Array)},b.prototype.nodes=function(a,b,c){return f(this,!0,a,b,c)},b.prototype.edges=function(a,b,c){return f(this,!1,a,b,c)},g.prototype.kill=function(){h(this),this._onKill&&this._onKill(),this._triggerOnKill(this)},Ogma.modules.partitions=b}.call(),function(a){function b(a){this._graph=a.graph,this._tasks=a.tasks,this._settings=a.settings.get("generators",!0)}function c(a,b){if(!b)throw new Error(b+" is not a graph");a._graph.clear(),a._graph.init(b.nodes||[],b.edges||[])}var Ogma=$global.Ogma;b.settings={webWorker:{default:!0,type:"boolean"}},b.dependencies=["graph","tasks"],b.prototype.load=function(a,b,d){var e=this,f=Ogma.generators[a],g=this;return new Promise(function(h){if(!f)throw new Error("generator "+Ogma.utils.stringify(a)+" does not exist");if(e._settings.webWorker){var i={configure:f.configure,context:function(a){return a},update:f.generate,onUpdate:function(a){c(g,a)},onEnd:function(){d&&d(),h()}};e._tasks.run(i,b||{},!0)}else{var j=f.configure(b)||b,k=f.generate(j);c(e,k),d&&d(),h()}})},Ogma.modules.generators=b}.call(),function(a){function b(a,b){if(b<0||0===a._animationList.length)return!0;for(var c=[],d=0;d<a._animationList.length;++d){var e=a._animationList[d],f=e.elapsed/e.duration,g=e.startAfter,h=e.easing(f);if(f>=1)e.func(1),e.done=!0,a._animationList.splice(d,1),d-=1,c.push(e.callback);else if(h>=g){var i=1/(1-g);h=(h-g)*i,e.func(h),e.elapsed+=b}else e.elapsed+=b}for(var j=0;j<c.length;++j)c[j](!1);a._renderer.refresh()}var Ogma=$global.Ogma,c={linear:function(a){return a},quadraticIn:function(a){return a*a},quadraticOut:function(a){return a*(2-a)},quadraticInOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)},cubicIn:function(a){return a*a*a},cubicOut:function(a){return--a*a*a+1},cubicInOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)}},d={},e=function(){},f=function(){function a(d){var e=this;_classCallCheck(this,a);this._settings=d.settings.get("animations"),this._renderer=d.render,this._graph=d.graph,this._animationList=[],this._easingFunctions=Ogma.utils.shallowCopy(c),d.events.bind({"render.beforeNewFrame":function(a){return b(e,a)}})}return _createClass(a,[{key:"play",value:function(a,b){b=b||d;var c=null;if(b.duration){if(b.duration<0)throw new TypeError("the `duration` parameter must be a positive number");c={func:a,easing:"function"==typeof b.easing?b.easing:this._easingFunctions[b.easing||"linear"],duration:b.duration,callback:b.callback||e,elapsed:0,startAfter:b.startAfter||0,done:!1},this._animationList.push(c),this._renderer.refresh()}else a(1),b.callback&&b.callback();return c}},{key:"end",value:function(a,b){var c=this._animationList.indexOf(a);c!==-1&&(a.func(1),a.done=!0,this._animationList.splice(c,1),$or(b,!0)&&a.callback(!0))}},{key:"addEasingFunction",value:function(a,b){this._easingFunctions[a]=b}},{key:"getEasingFunction",value:function(a){return this._easingFunctions[a]||null}}]),a}();f.dependencies=["graph","render"],f.onClear=function(a){for(;a._animationList.length>0;)a.end(a._animationList[0])},f.easings=c,Ogma.modules.animations=f}.call(),function(a){function b(a){this._graph=a.graph,this._topology=a.topology}function c(a,b){return Ogma.geometry.distance(a.x,a.y,b.x,b.y)}function d(){return 1}function e(a,b,c,d){for(var e=[d[c]],f=c;f!==b;)f=a[f],e.push(d[f]);return e.reverse(),e}var Ogma=$global.Ogma;b.dependencies=["graph","topology"],b.prototype.astar=function(b,d,f){if(f=f||{},b===d)return[this._graph.getNode(b,!0)];for(var g=f.pathLengthFunction||c,h=f.heuristicLengthFunction||g,i=f.directed===a||!!f.directed,j={direction:i?"out":"both"},k=this._graph.getNode(b,!0),l=this._graph.getNode(d,!0),m=k.__index,n=l.__index,o=this._graph._elts.nodes.totalSize,p=this._graph.nodeAttributes.ref,q=this._graph.createNodeSet(),r=this._graph.createNodeSet(),s=new Int32Array(o),t=new Float32Array(o),u=new Float32Array(o),v=0;v<o;++v)s[v]=-1,t[v]=1/0,u[v]=1/0;for(r.add(k),t[m]=0,u[m]=h(k,l);0!==r._indexSet.size;){var w=r._indexSet.size,x=r._elementAttributes.ref[r._indexSet.array[0]],y=0,z=u[x.__index];for(v=1;v<w;++v){var A=r._elementAttributes.ref[r._indexSet.array[v]],B=u[A.__index];B<z&&(z=B,x=A,y=v)}if(x===l)return e(s,m,n,p);r.removeByIndex(y),q.add(x);var C=this._topology.getAdjacentNodes(x,j);for(v=0;v<C.length;++v){var D=C[v],E=D.__index;if(!q.has(D)){var F=t[x.__index]+g(x,D);!r.add(D)&&F>=t[E]||(s[E]=x.__index,t[E]=F,u[E]=F+h(D,l))}}}return null},b.prototype.dijkstra=function(b,c,e){e=e?Ogma.utils.deepCopy(e):{};var f=e.pathLengthFunction||d,g=e.directed===a||!!e.directed,h=this._graph.getNode(b,!0),i=this._graph.getNode(c,!0),j=this._graph._elts.nodes.attributes.ref,k=this._topology.getAdjacencyTable(!g,!0,!1),l=Ogma.algorithms.dijkstra(k,h.__index,i.__index,null,null,null,function(a,b){return f(j[a],j[b])});return l.path?l.path.map(function(a){return j[a]}):null},Ogma.modules.pathfinding=b}.call(),function(){function a(a){var b=this;this._partitions=a.partitions,this._groups=a.groups,this._dsl=a.dsl,this._topology=a.topology,this._nodePartitionList=null,this._edgePartitionList=null,this._dsl.registerOperator("coalescence.nodePartition",function(a,c){return b._groups.isMetaNode(a)?void 0:c}),this._dsl.registerOperator("coalescence.edgePartition",function(a,c){return b._groups.isMetaEdge(a)||void 0===c?void 0:b._topology.edgeDirection(a)+" "+c})}function b(a,b,c){c=c||{};var d=b?"_nodePartitionList":"_edgePartitionList";a[d]&&(a._killDuration=c.duration,a._killCallback=c.callback,a[d].kill(),a[d]=null)}function c(a,b,c){var f=c.expression,g=c.method,h=c.duration,i=c.callback;b||void 0!==f||(f=function(a){return""});var j=a._dsl.checkExpressionFormat(f);if(j)throw new Error(j);if("function"!=typeof g)throw new Error("invalid group function "+JSON.stringify(g)+": expected function");var k=b?"coalescence.nodePartition":"coalescence.edgePartition",l=b?"_nodePartitionList":"_edgePartitionList";a._noUpdate=!1,a[l]=a._partitions[b?"nodes":"edges"]([".",k,f],{onKill:function(){e(a,b,a._killDuration,a._killCallback)},onUpdate:function(c){a._noUpdate||(a._noUpdate=!0,d(a,b,c,g,h,i),h=void 0,i=void 0,a._noUpdate=!1)}})}function d(a,b,c,d,e,f){a._groups[b?"ungroupNodes":"ungroupEdges"](a._groups[b?"getMetaNodes":"getMetaEdges"]());var g=[];$iter(c,function(a,c){if("undefined"!==c){var e={method:d};e[b?"nodes":"edges"]=a,g.push(e)}}),a._groups[b?"groupMultipleNodes":"groupMultipleEdges"](g,e,f)}function e(a,b,c,d){a._groups[b?"ungroupNodes":"ungroupEdges"](a._groups[b?"getMetaNodes":"getMetaEdges"](),c,d)}var Ogma=$global.Ogma;a.dependencies=["groups","dsl","partitions","topology"],a.prototype.groupNodes=function(a){b(this,!0),c(this,!0,a)},a.prototype.groupEdges=function(a){b(this,!1),c(this,!1,a)},a.prototype.ungroupNodes=function(a){b(this,!0,a)},a.prototype.ungroupEdges=function(a){b(this,!1,a)},a.prototype.reset=function(){b(this,!0),b(this,!1)},Ogma.modules.coalescence=a}(),function(a){function b(a){var b=this;this._enabled=!1,this._renderer=a.render,this._settings=a.settings.get("connectNodes",!0),this._camera=a.camera,this._ogma=a,this._captorSettings=this._ogma.settings.get("captor",!0),this.setCondition(c),a.exclusives.create({priority:$C("interaction","creation"),check:function(){return b._enabled},onStart:this._onStart.bind(this),onProgress:this._onProgress.bind(this),onStop:this._onStop.bind(this),evt:["captor.startDragNode","captor.dragNode","captor.endDragNode"]})}var Ogma=$global.Ogma;b.dependencies=["exclusives","graph","captor"];var c=function(a,b){return!0},d=50;b.settings={strokeColor:{default:"black",type:"color"},strokeWidth:{default:2,type:"positive"},cursorStyle:{default:"cell",type:"string"},continueDrawing:{default:!1,type:"boolean"},createNodes:{default:!0,type:"boolean"}},b.prototype.setEnabled=function(a){return this._enabled=!!a,this},b.prototype.enable=function(){return this.setEnabled(!0)},b.prototype.disable=function(){return this.setEnabled(!1)},b.prototype.setCondition=function(a){if("function"!=typeof a)throw new Error("Connection condition must be a function");if(2!==a.length)throw new Error("Connection condition must take two nodes");return this._connectCondition=a,this},b.prototype._onStart=function(a,b,c){this._startNode=a,this._nodeMargin=this._captorSettings.nodeErrorMargin,this._startPos=this._camera.getPositionOnScreen(a.x,a.y),this._lines=[],this._lineId=-1,this._renderer.setCursorStyle(this._settings.cursorStyle),this._onDrawThrottled=Ogma.utils.throttle(this._onDraw,d,this)},b.prototype._onProgress=function(b,c,d){var e=this._settings,f=this._ogma.drawing.MAX_EDGE_Z+Ogma.constants.EPSILON;this._onDrawThrottled(c,d),this._lineId=Ogma.shapes.edges.dashed.drawStraight(this._renderer,this._lineId,this._startPos.x,this._startPos.y,c,d,e.strokeWidth,0,1,1,e.strokeColor,a,f)},b.prototype._onDraw=function(a,b){var c=this._ogma.shapes.detectNodeShape(a,b,this._nodeMargin),d="hover",e=this._ogma.drawing;c&&c===this._hoveredNode||this._hoveredNode&&(e.removeNodeFromLayer(this._hoveredNode,d),this._hoveredNode=null),c&&c!==this._startNode&&(this._hoveredNode=c,e.putNodeOnLayer(c,d))},b.prototype._onStop=function(a,b,c){var d=this._ogma,e=d.captor.pointedElement(),f=!1;if(this._hoveredNode=null,!e&&this._settings.createNodes){var g=this._camera.getAbsolutePosition(b,c);e=d.graph.addNode({id:d.graph.unusedNodeId(),x:g.x,y:g.y,size:a.size}),f=!0}e&&e.isNode&&(this._connectCondition(this._startNode,e)?d.graph.addEdge({id:d.graph.unusedEdgeId(),source:a.id,target:e.id}):f&&d.graph.removeNode(e.id)),this._renderer.delete(this._lineId),this._lineId=this._startPos=null,this._renderer.removeCursorStyle(this._settings.cursorStyle),this.disable(),this._settings.continueDrawing&&this.enable()},Ogma.modules.connectNodes=b}.call(),function(){function a(a){null===a._settings.cameraFixDuration||a._locate.graphInCamera()||(a._adjusting=!0,a._locate.center({duration:a._settings.cameraFixDuration,callback:function(){a._adjusting=!1}}))}function b(a,b){a._settings[b[0]]&&a._drawing.setNodeDrawing(!1),a._settings[b[1]]&&a._drawing.setEdgeDrawing(!1),a._settings[b[2]]&&a._texts.setNodeTextDrawing(!1),a._settings[b[3]]&&a._texts.setEdgeTextDrawing(!1)}function c(a,b){a._settings[b[0]]&&a._drawing.setNodeDrawing(!0),a._settings[b[1]]&&a._drawing.setEdgeDrawing(!0),a._settings[b[2]]&&a._texts.setNodeTextDrawing(!0),a._settings[b[3]]&&a._texts.setEdgeTextDrawing(!0)}function d(d,e,f,g){var i=d._settings,j=i.zoomModifier||d._camera._settings.defaultZoomModifier,k=i.zoomDuration;e<0&&(j=1/j);var l={refX:f,refY:g,zoomModifier:j,duration:k,callback:function(b){c(d,h),b||a(d)},easing:"quadraticOut"};d._camera.zoomIn(l),b(d,h)}var Ogma=$global.Ogma,e={zoomDuration:{default:150,type:"positive"},zoomModifier:{default:void 0,type:"positive",values:[void 0]},zoomEnabled:{default:!0,type:"boolean"},panningEnabled:{default:!0,type:"boolean"},rotationEnabled:{default:!0,type:"boolean"},zoomOnDoubleClick:{default:!1,type:"boolean"},skipNodeDrawingWhileZooming:{default:!1,type:"boolean"},skipEdgeDrawingWhileZooming:{default:!1,type:"boolean"},skipNodeTextDrawingWhileZooming:{default:!1,type:"boolean"},skipEdgeTextDrawingWhileZooming:{default:!1,type:"boolean"},skipNodeDrawingWhilePanning:{default:!1,type:"boolean"},skipEdgeDrawingWhilePanning:{default:!1,type:"boolean"},skipNodeTextDrawingWhilePanning:{default:!1,type:"boolean"},skipEdgeTextDrawingWhilePanning:{default:!1,type:"boolean"},cameraFixDuration:{default:500,type:"positive",values:[null]},skipNodeDrawingWhileRotating:{default:!1,type:"boolean"},skipEdgeDrawingWhileRotating:{default:!1,type:"boolean"},skipNodeTextDrawingWhileRotating:{default:!1,type:"boolean"},skipEdgeTextDrawingWhileRotating:{default:!1,type:"boolean"},skipNodeDrawingWhileGesture:{default:!1,type:"boolean"},skipEdgeDrawingWhileGesture:{default:!1,type:"boolean"},skipNodeTextDrawingWhileGesture:{default:!1,type:"boolean"},skipEdgeTextDrawingWhileGesture:{default:!1,type:"boolean"}},f=["skipNodeDrawingWhilePanning","skipEdgeDrawingWhilePanning","skipNodeTextDrawingWhilePanning","skipEdgeTextDrawingWhilePanning"],g=["skipNodeDrawingWhileRotating","skipEdgeDrawingWhileRotating","skipNodeTextDrawingWhileRotating","skipEdgeTextDrawingWhileRotating"],h=["skipNodeDrawingWhileZooming","skipEdgeDrawingWhileZooming","skipNodeTextDrawingWhileZooming","skipEdgeTextDrawingWhileZooming"],i=["skipNodeDrawingWhileGesture","skipEdgeDrawingWhileGesture","skipNodeTextDrawingWhileGesture","skipEdgeTextDrawingWhileGesture"],j=function(){function e(h){var j=this;_classCallCheck(this,e);var k=this;this._graph=h.graph,this._mouse=h.mouse,this._render=h.render,this._keyboard=h.keyboard,this._camera=h.camera,this._drawing=h.drawing,this._texts=h.texts,this._locate=h.locate,this._detect=h.detect,this._settings=h.settings.get("cameraInteractions",!0),this._screen=this._render.screen,this._panning=!1,this._rotating=!1,this._adjusting=!1,this._interactionsEnabled=!0,this._panningEnabled=!0,this._rotationEnabled=!0,this._zoomEnabled=!0;var l=0,m=0,n=0,o=0,p=function(a,b){var c=k._screen.width/2,d=k._screen.height/2,e=a-c,f=b-d,g=Math.sqrt(e*e+f*f),h=0;if(e/=g,f/=g,0!==e||0!==f){var i=Math.abs(l*e+m*f)/(Math.sqrt(l*l+m*m)*Math.sqrt(e*e+f*f));h=Math.acos(i),isNaN(h)?h=0:e<0&&l>0||e>0&&m<0?(f>0&&l>e||f<0&&l<e)&&(h*=-1):(e>0&&f>m||e<0&&f<m)&&(h*=-1)}return l=e,m=f,h};this._zoom=h.exclusives.create({priority:$C("interaction","zoom"),check:function(a,b){return k._settings.zoomEnabled&&(!b||k._settings.zoomOnDoubleClick)&&!k._adjusting},handler:function(a){return d(k,a,k._mouse.x,k._mouse.y)}}),this._pan=h.exclusives.create({priority:$C("interaction","panning"),check:function(){return k._settings.panningEnabled&&!k._adjusting},onStart:function(a,c){b(k,f),k._panning=!0,n=a,o=c},onProgress:function(a,b){var c=n-a,d=o-b;n=a,o=b,k._camera.move(c,d,{noEndOfAnimation:!0})},onStop:function(){k._camera.move(0,0),c(k,f),a(k),k._panning=!1}}),this._rotate=h.exclusives.create({priority:$C("interaction","rotation"),check:function(){return k._settings.rotationEnabled&&!k._adjusting},onStart:function(){b(k,g),k._rotating=!0},onProgress:function(a){k._camera.rotate(a,{noEndOfAnimation:!0})},onStop:function(){k._camera.rotate(0),c(k,g),k._rotating=!1}}),this._gesture=h.exclusives.create({priority:$C("interaction","gesture"),check:function(){return k._settings.panningEnabled&&!k._adjusting},onStart:function(){b(k,i)},onProgress:function(a,b,c){h.camera.rotate(-a.rotation,{noEndOfAnimation:!0}),h.camera.zoomIn({zoomModifier:a.scale,refX:b,refY:c,noEndOfAnimation:!0}),h.camera.move(-a.dx,-a.dy,{noEndOfAnimation:!0})},onStop:function(){h.camera.zoomIn({zoomModifier:1}),h.camera.rotate(0),h.camera.move(0,0),c(k,i)}}),h.on({"touch.startGesture":function(){return j._gesture.start()},"touch.endGesture":function(){return j._gesture.stop()},"touch.gesture":function(a,b,c){return j._gesture.progress(a,b,c)},"mouse.wheel":function(a){return j._zoom(a,!1)},"mouse.doubleClick touch.doubleTap":function(){return j._zoom(1,!0)},"mouse.down touch.down":function(a,b,c){l=0,m=0,c&&"left"!==c?"right"===c&&j._rotate.start():j._pan.start(a,b)},"mouse.move touch.move":function(a,b){j._pan.progress(a,b),j._rotate.progress(p(a,b))},"mouse.up touch.up":function(){j._pan.stop(),j._rotate.stop()}})}return _createClass(e,[{key:"isPanning",value:function(){return this._panning}},{key:"isRotating",value:function(){return this._rotating}}]),e}();j.settings=e,j.dependencies=["mouse","touch","render","keyboard","camera","drawing","texts","locate","exclusives"],Ogma.modules.cameraInteractions=j}(),function(){function a(a){return void 0===a||"string"==typeof a}function b(a){return void 0===a||"number"==typeof a&&a>=0}function c(a){return void 0===a||"string"==typeof a&&0!==Ogma.colors.getIndex(a)}var Ogma=$global.Ogma;$global.design.icon={nodeAttributes:["design.icon.content","design.icon.font","design.icon.color","design.icon.scale"],save:function(a,b,c){for(var d=a._graph.attributes(b),e=d["icon.content"],f=d["icon.font"],g=d["icon.color"],h=d["icon.scale"],i=d["design.icon.content"],j=d["design.icon.font"],k=d["design.icon.color"],l=d["design.icon.scale"],m=0,n=c.length;m<n;++m){var o=c[m].__index;i[o]=e[o],j[o]=f[o],k[o]=g[o],l[o]=h[o]}},restore:function(a,b,c){for(var d=a._graph.attributes(b),e=d["icon.content"],f=d["icon.font"],g=d["icon.color"],h=d["icon.scale"],i=d["design.icon.content"],j=d["design.icon.font"],k=d["design.icon.color"],l=d["design.icon.scale"],m=0,n=c.length;m<n;++m){var o=c[m].__index;e[o]=i[o],f[o]=j[o],g[o]=k[o],h[o]=l[o]}},checkParameters:function(d){var e=d.scheme;if(!$isObj(e))throw new TypeError("invalid icon scheme: "+JSON.stringify(e)+" is not an object");for(var f=Object.keys(e),g=0;g<f.length;++g){var h=f[g],i=e[h];if("string"==typeof i);else{if(!$isObj(i))throw new TypeError("in icon scheme for value "+h+": "+JSON.stringify(i)+" is not an object");if("string"!=typeof i.content)throw new TypeError("in icon scheme for value "+h+": icon content "+JSON.stringify(i.content)+" is not a string");if(!b(i.scale))throw new TypeError("in icon scheme for value "+h+": icon scale "+JSON.stringify(i.scale)+" is not a positive number");if(!a(i.font))throw new TypeError("in icon scheme for value "+h+": icon font "+JSON.stringify(i.font)+" is not a string");if(!c(i.color))throw new TypeError("in icon scheme for value "+h+": icon color "+JSON.stringify(i.color)+" is not a color")}}},styleByFunction:function(a,b,c){var d=a._graph.attributes(b);return function(a){for(var b=d["icon.content"],e=d["icon.font"],f=d["icon.color"],g=d["icon.scale"],h=0,i=a.length;h<i;++h){var j=a[h],k=j.__index,l=c(j),m=void 0,n=void 0,o=void 0,p=void 0,q="undefined"==typeof l?"undefined":_typeof(l);"string"===q?m=l:"object"===q&&(m=l.content,p=l.font,n=l.scale,o=l.color),b[k]=m,g[k]=n,f[k]=o,e[k]=p}}},styleByParameters:function(a,b,c){var d={},e=c.variable,f=a._graph.attributes(b),g=$global.selectFromScheme;Ogma.utils.forEach(c.scheme,function(a,b){var c=void 0,e=void 0,f=void 0,g=void 0,h="undefined"==typeof a?"undefined":_typeof(a);"string"===h?c=a:"object"===h&&(c=a.content,g=a.font,e=a.scale,f=a.color),d[b]=[c,e,f,g]});var h=[];return function(a){for(var b=f["icon.content"],c=f["icon.font"],i=f["icon.color"],j=f["icon.scale"],k=0,l=a.length;k<l;++k){var m=a[k],n=m.__index,o=Ogma.utils.strToObjectRef(m,e),p=g(d,o)||h;b[n]=p[0],j[n]=p[1],i[n]=p[2],c[n]=p[3]}}}}}(),function(a){function b(b){return b===a||"number"==typeof b&&b>=0}var Ogma=$global.Ogma;$global.design.size={nodeAttributes:["design.size"],edgeAttributes:["design.size"],save:function(a,b,c){for(var d=a._graph.attributes(b),e=d.size,f=d["design.size"],g=0,h=c.length;g<h;++g){var i=c[g].__index;f[i]=e[i]}},restore:function(a,b,c){var d=a._graph.attributes(b),e=d.size,f=d["design.size"],g=b?"nodeSizeWatcher":"edgeSizeWatcher";a[g]&&(a[g]=a[g].kill());for(var h=0,i=c.length;h<i;++h){var j=c[h].__index;e[j]=f[j]}},checkParameters:function(c){if(c.stops!==a||c.sizes!==a){if(Ogma.utils.checkNumberArray(c.stops,1,"stop value"),Ogma.utils.checkNumberArray(c.sizes,1,"target size",!0),c.sizes.length-c.stops.length!==1)throw new Error("the target sizes should contain exactly one more value than the stops")}else{if(!b(c.min))throw new TypeError("invalid minimum size "+JSON.stringify(c.min)+": expected positive number");if(!b(c.max))throw new TypeError("invalid maximum size "+JSON.stringify(c.max)+": expected positive number");if(!(c.min===a&&c.max===a||c.max>=c.min))throw new Error("invalid bounds "+JSON.stringify(c.min)+" (min) and "+JSON.stringify(c.max)+" (max): expected max >= min");if(!b(c.bins)||0===c.bins)throw new TypeError("invalid number of bins "+JSON.stringify(c.bins)+": expected positive number")}if("undefined"!=typeof c.transformation&&"function"!=typeof c.transformation)throw new TypeError("invalid transformation function "+JSON.stringify(c.transformation))},styleByFunction:function(a,b,c){var d=a._graph.attributes(b);return a._sizeWatcher=null,function(a){for(var b=d.size,e=0,f=a.length;e<f;++e){var g=a[e],h=g.__index,i=c(g);b[h]=+i}}},styleByParameters:function(b,c,d,e){var f=d.variable,g=b._graph.attributes(c),h=c?"nodeSizeWatcher":"edgeSizeWatcher",i=b._watcher.watchProperty(c,f,function(){b[h]=i.kill(),e(b,c,"size",d,!0)});b[h]=i;var j=d.transformation||function(a){return a},k=d.bins||b._settings.defaultSizeBins,l=j(i.min),m=j(i.max);if(l>m){var n=l;l=m,m=n}if(d.stops!==a)var o=d.stops,p=o.length,q=d.sizes;else if(d.min!==a&&d.max!==a)var r=!0,s=d.min,t=d.max,u=t-s,v=Ogma.utils.computeRange(s,t,k),w=m-l;var x=b._settingsModule.get("drawing")[c?"defaultNodeSize":"defaultEdgeSize"];return function(a){for(var b=g.size,c=0,d=a.length;c<d;++c){var e=a[c],h=e.__index,i=+Ogma.utils.strToObjectRef(e,f);if(isNaN(i))b[h]=x;else if(i=j(i),o){for(var k=0;k!==p&&i>o[k];)k+=1;b[h]=q[k]}else if(r){var m=(i-l)/w;b[h]=Ogma.utils.closestValue(v,s+m*u)}else b[h]=i}}}}}.call(),function(){$global.Ogma;$global.design.text={nodeAttributes:["design.text"],edgeAttributes:["design.text"],save:function(a,b,c){for(var d=a._graph.attributes(b),e=d.text,f=d["design.text"],g=0,h=c.length;g<h;++g){var i=c[g].__index;f[i]=e[i]}},restore:function(a,b,c){for(var d=a._graph.attributes(b),e=d.text,f=d["design.text"],g=0,h=c.length;g<h;++g){var i=c[g].__index;e[i]=f[i]}},styleByFunction:function(a,b,c){var d=a._graph.attributes(b);return function(a){for(var b=d.text,e=0,f=a.length;e<f;++e){var g=a[e],h=g.__index,i=c(g);b[h]=i}}}}}(),function(){function a(a){return void 0===a||"string"==typeof a&&0!==Ogma.colors.getIndex(a)}var Ogma=$global.Ogma,b=$isObj;$global.design.color={nodeAttributes:["design.color","design.colors"],edgeAttributes:["design.color"],save:function(a,b,c){for(var d=a._graph.attributes(b),e=d.color,f=d.colors,g=d["design.color"],h=d["design.colors"],i=0,j=c.length;i<j;++i){var k=c[i].__index;g[k]=e[k],b&&(h[k]=f[k])}},restore:function(a,b,c){var d=a._graph.attributes(b),e=d.color,f=d.colors,g=d["design.color"],h=d["design.colors"],i=b?"nodeColorWatcher":"edgeColorWatcher";a[b?"_nodeColorScheme":"_edgeColorScheme"]=null,a[i]&&(a[i]=a[i].kill());for(var j=0,k=c.length;j<k;++j){var l=c[j].__index;e[l]=g[l],b&&(f[l]=h[l])}},checkParameters:function(c,d,e){var f=c.scheme;if(void 0===f&&d[e?"_nodeReserveColors":"_edgeReserveColors"]);else if(f instanceof Array){if(0===f.length)throw new TypeError("empty quantitative color scheme");for(var g=0;g<f.length;++g){var h=f[g];if(!a(h))throw new TypeError("invalid color scheme: "+JSON.stringify(h)+" is not a color")}}else{if(!b(f))throw new TypeError("invalid color scheme: "+JSON.stringify(f)+" is not an object");var i=Object.keys(f);for(g=0;g<i.length;++g){var j=i[g];if(h=f[j],!a(h))throw new TypeError("in color scheme for value "+j+": "+JSON.stringify(h)+" is not a color")}}if(void 0!==c.stops&&(Ogma.utils.checkNumberArray(c.stops,1,"stop value"),c.scheme.length-c.stops.length!==1))throw new Error("the scheme should contain exactly one more value than the stops");if("undefined"!=typeof c.transformation&&"function"!=typeof c.transformation)throw new TypeError("invalid transformation function "+JSON.stringify(c.transformation))},styleByFunction:function(a,b,c){var d=a._graph.attributes(b);return a._colorWatcher=null,function(a){for(var b=d.color,e=d.colors,f=0,g=a.length;f<g;++f){var h=a[f],i=h.__index,j=c(h);j instanceof Array?(e[i]=j,b[i]=void 0):(b[i]=j,e[i]=void 0)}}},styleByParameters:function(a,b,c,d){var e=c.scheme||{},f=!(e instanceof Array),g=c.variable,h=a._graph.attributes(b);if(f){var i=a[b?"_nodeReserveColors":"_edgeReserveColors"],j=Ogma.utils.deepCopy(e),k=0;a[b?"_nodeColorScheme":"_edgeColorScheme"]=j;var l=function(a){if(void 0!==a){var b=j[a];return!b&&i?(b=i[k],j[a]=b,k=(k+1)%i.length):void 0===b&&(b=void 0),b}}}else{var m=b?"nodeColorWatcher":"edgeColorWatcher",n=a._watcher.watchProperty(b,c.variable,function(){a[m]=n.kill(),d(a,b,"color",c,!0)});a[m]=n;var o=c.transformation||function(a){return a},p=e.length,q=o(n.min),r=o(n.max);if(q>r){var s=q;q=r,r=s}if(void 0!==c.stops){var t=c.stops,u=t.length,v=Ogma.utils.deepCopy(c.scheme);c.reverse&&v.reverse()}else{var w=Ogma.utils.computeRange(q,r,p),x=!!c.reverse;j={};for(var y=0;y<w.length;++y){var z=Ogma.utils.findFunctionParameter(o,w[y],n.min,n.max,q/1e3);j[z]=e[x?p-y-1:y]}a[b?"_nodeColorScheme":"_edgeColorScheme"]=j}}return function(a){for(var c=h.color,d=h.colors,i=0,j=a.length;i<j;++i){var k=a[i],m=k.__index,n=Ogma.utils.strToObjectRef(k,g);if(f){if(n instanceof Array){if(b&&!(n.length<2)){for(var q=[],r=0;r<n.length;++r){var s=l(n[r]);s&&q.push(s)}q.length>1?(d[m]=q,c[m]=void 0):(c[m]=q[0],d[m]=void 0);continue}n=n[0]}c[m]=l(n)}else if("number"!=typeof n)c[m]=void 0;else if(n=o(n),t){for(var y=0;y!==u&&n>t[y];)y+=1;c[m]=v[y]}else{var z=Ogma.utils.closestValue(w,n,!0);c[m]=e[x?p-z-1:z]}b&&(d[m]=void 0)}}}}}(),function(){function a(a){return void 0===a||"boolean"==typeof a}function b(a){return void 0===a||"number"==typeof a&&a>=0}var Ogma=$global.Ogma;$global.design.image={nodeAttributes:["design.image.url","design.image.scale","design.image.rescale","design.image.duplicate"],save:function(a,b,c){for(var d=a._graph.attributes(b),e=d["image.url"],f=d["image.rescale"],g=d["image.duplicate"],h=d["image.scale"],i=d["design.image.url"],j=d["design.image.rescale"],k=d["design.image.duplicate"],l=d["design.image.scale"],m=0,n=c.length;m<n;++m){var o=c[m].__index;i[o]=e[o],j[o]=f[o],k[o]=g[o],l[o]=h[o]}},restore:function(a,b,c){for(var d=a._graph.attributes(b),e=d["image.url"],f=d["image.rescale"],g=d["image.duplicate"],h=d["image.scale"],i=d["design.image.url"],j=d["design.image.rescale"],k=d["design.image.duplicate"],l=d["design.image.scale"],m=0,n=c.length;m<n;++m){var o=c[m].__index;e[o]=i[o],f[o]=j[o],g[o]=k[o],h[o]=l[o]}},checkParameters:function(c){var d=c.scheme;if(!$isObj(d))throw new TypeError("invalid image scheme: "+JSON.stringify(d)+" is not an object");for(var e=Object.keys(d),f=0;f<e.length;++f){var g=e[f],h=d[g];if("string"==typeof h);else{if(!$isObj(h))throw new TypeError("in image scheme for value "+g+": "+JSON.stringify(h)+" is not an object");if("string"!=typeof h.url)throw new TypeError("in image scheme for value "+g+": image url "+JSON.stringify(h.url)+" is not a string");if(!b(h.scale))throw new TypeError("in image scheme for value "+g+": image scale "+JSON.stringify(h.scale)+" is not a positive number");if(!a(h.rescale))throw new TypeError("in image scheme for value "+g+": image rescale "+JSON.stringify(h.rescale)+" is not a boolean");if(!a(h.duplicate))throw new TypeError("in image scheme for value "+g+": image duplicate "+JSON.stringify(h.duplicate)+" is not a boolean")}}},styleByFunction:function(a,b,c){var d=a._graph.attributes(b);return function(a){for(var b=d["image.url"],e=d["image.rescale"],f=d["image.duplicate"],g=d["image.scale"],h=0,i=a.length;h<i;++h){var j=a[h],k=j.__index,l=c(j),m=void 0,n=void 0,o=void 0,p=void 0,q="undefined"==typeof l?"undefined":_typeof(l);"string"===q?m=l:"object"===q&&(m=l.url,p=l.rescale,n=l.scale,o=l.duplicate),b[k]=m,g[k]=n,f[k]=o,e[k]=p}}},styleByParameters:function(a,b,c){var d={},e=c.variable,f=a._graph.attributes(b),g=$global.selectFromScheme;Ogma.utils.forEach(c.scheme,function(a,b){var c=void 0,e=void 0,f=void 0,g=void 0,h="undefined"==typeof a?"undefined":_typeof(a);"string"===h?c=a:"object"===h&&(c=a.url,g=a.rescale,e=a.scale,f=a.duplicate),d[b]=[c,e,f,g]});var h=[];return function(a){for(var b=f["image.url"],c=f["image.rescale"],i=f["image.duplicate"],j=f["image.scale"],k=0,l=a.length;k<l;++k){var m=a[k],n=m.__index,o=Ogma.utils.strToObjectRef(m,e),p=g(d,o)||h;b[n]=p[0],j[n]=p[1],i[n]=p[2],c[n]=p[3]}}}}}(),function(){var Ogma=$global.Ogma;$global.design.shape={nodeAttributes:["design.shape"],edgeAttributes:["design.shape"],save:function(a,b,c){for(var d=a._graph.attributes(b),e=d.shape,f=d["design.shape"],g=0,h=c.length;g<h;++g){var i=c[g].__index;f[i]=e[i]}},restore:function(a,b,c){for(var d=a._graph.attributes(b),e=d.shape,f=d["design.shape"],g=0,h=c.length;g<h;++g){var i=c[g].__index;e[i]=f[i]}},checkParameters:function(a,b,c){var d=a.scheme;if(!$isObj(d))throw new TypeError("invalid shape scheme: "+JSON.stringify(d)+" is not an object");for(var e=Object.keys(d),f=Object.keys(Ogma.shapes[c?"nodes":"edges"]),g=0;g<e.length;++g){var h=e[g],i=d[h];if(f.indexOf(i)===-1)throw new TypeError("in shape scheme for value "+h+": "+JSON.stringify(i)+" is not a valid shape (available: "+JSON.stringify(f)+")")}},styleByFunction:function(a,b,c){var d=a._graph.attributes(b);return function(a){for(var b=d.shape,e=0,f=a.length;e<f;++e){var g=a[e],h=g.__index,i=c(g);b[h]=i}}},styleByParameters:function(a,b,c){var d=c.scheme,e=c.variable,f=a._graph.attributes(b),g=$global.selectFromScheme;return function(a){for(var b=f.shape,c=0,h=a.length;c<h;++c){var i=a[c],j=i.__index,k=Ogma.utils.strToObjectRef(i,e);b[j]=g(d,k)}}}}}(),function(a){function b(a){if(this._dagre=Ogma.require("dagre",{variable:"dagre"}),!this._dagre||!this._dagre.graphlib)throw new Error("to use the dagre plugin, please include lib/dagre.min.js");this._graph=a.graph,this._drawing=a.drawing,this._settings=a.settings.get("dagre"),this.running=!1}var Ogma=$global.Ogma;b.settings={defaultDirected:{default:!0,type:"boolean"},defaultMultigraph:{default:!0,type:"boolean"},defaultCompound:{default:!1,type:"boolean"},defaultRankDir:{default:"TB",values:["TB","BT","LR","RL"]},defaultDuration:{default:0,type:"positive"},maxNbEdges:{default:500,type:"positive"},maxNbNodes:{default:500,type:"positive"}},b.isPlugin=!0,b.prototype.start=function(a,b){if(this.running)return!1;var c=this._graph.nodes.length,d=this._graph.edges.length,e=this._settings.maxNbNodes,f=this._settings.maxNbEdges;if(e&&c>e)throw new Error("Unable to run dagre layout: the graph has "+c+" nodes (maximum allowed: "+e+")");if(f&&d>f)throw new Error("Unable to run dagre layout: the graph has "+d+" edges (maximum allowed: "+f+")");a=a||{},b=b||{},a.directed=$or(a.directed,this._settings.defaultDirected),a.multigraph=$or(a.multigraph,this._settings.defaultMultigraph),a.compound=$or(a.compound,this._settings.defaultCompound),a.rankdir=$or(a.rankdir,this._settings.defaultRankDir),this.config=a,this.duration=$or(b.duration||this._settings.defaultDuration),this.callback=b.onEnd,this.running=!0;var g=new this._dagre.graphlib.Graph({directed:a.directed,multigraph:a.multigraph,compound:a.compound});g.setGraph(a);for(var h=this.nodes||this._graph.getNodeList(),i=0;i<h.length;i++)h[i].fixed||g.setNode(h[i].id,{});var j=this._graph.getEdgeList();for(i=0;i<j.length;i++)null!=g.node(j[i].source)&&null!=g.node(j[i].target)&&g.setEdge(j[i].source,j[i].target,{id:j[i].id});return this._dagre.layout(g),this._dg=g,this.stop(),!0},b.prototype.stop=function(){var a=this._dg,b=this;a&&(this.running=!1,this._drawing.animate(function(){var c=b._graph.nodeAttributes,d=c.x,e=c.y;a.nodes().forEach(function(c){var f=b._graph.getNode(c),g=f.__index;d[g]=a.node(c).x,e[g]=a.node(c).y}),b._drawing.redrawEverything()},this.duration,this.callback))},b.prototype.isRunning=function(){return this.running},Ogma.modules.dagre=b}.call(),function(a){function b(a){this._neo4j=Ogma.require("neo4j-driver",{variable:"neo4j"}),this._graph=a.graph,this._connected=!1,this._driver=null}function c(a){if("object"===("undefined"==typeof a?"undefined":_typeof(a))&&null!==a){for(var b=Object.keys(a.properties),c=0;c<b.length;c++){var d=b[c],e=a.properties[d];"object"===("undefined"==typeof e?"undefined":_typeof(e))&&"high"in e&&"low"in e&&(e=e.low)}a.identity=a.identity.low,"start"in a&&"end"in a&&(a.start=a.start.low,a.end=a.end.low)}}function d(a,b){var d={nodes:[],edges:[]},e=new Ogma.utils.Set,f=new Ogma.utils.Set;return b.records.forEach(function(b){b._fields.forEach(function(b){b&&(c(b),"start"in b||"end"in b||"type"in b?a._graph.getEdge(b.identity)||f.has(b.identity)||(d.edges.push({id:b.identity,text:b.identity.toString(),source:b.start,target:b.end,data:{neo4jType:b.type,neo4jProperties:b.properties}}),
f.add(b.identity)):a._graph.getNode(b.identity)||e.has(b.identity)||(d.nodes.push({id:b.identity,text:b.identity.toString(),x:100*Math.random(),y:100*Math.random(),data:{neo4jLabels:b.labels,neo4jProperties:b.properties}}),e.add(b.identity)))})}),d}var Ogma=$global.Ogma;b.dependencies=["graph"],b.isPlugin=!0,b.onStart=function(a,b){b.neo4j&&a.connect(b.neo4j.url,b.neo4j.username,b.neo4j.password)},b.prototype.connect=function(a,b,c){0!==a.indexOf("bolt://")&&(a="bolt://"+a),this._driver=this._neo4j.v1.driver(a,this._neo4j.v1.auth.basic(b,c)),this._connected=!0},b.prototype.query=function(a,b){var c=this;return new Promise(function(e,f){if(!c._connected)throw new Error('please call the "connect" function before');var g=c._driver.session(),h=c;g.run(a).then(function(a){var c=d(h,a);h._graph.addNodes(c.nodes),h._graph.addEdges(c.edges),g.close(),b&&b(a),e(a)}).catch(function(a){f(a)})})},Ogma.modules.neo4j=b}.call(),$global.Ogma}();